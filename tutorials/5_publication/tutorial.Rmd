---
title: "Part III-2: ë…¼ë¬¸ ì¶œíŒ ìˆ˜ì¤€ ê·¸ë˜í”½"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
    css: www/custom.css
    includes:
      in_header: www/header.html
runtime: shiny_prerendered
---

```{r packages, include=FALSE}
# í•„ìš” íŒ¨í‚¤ì§€ ìë™ ì„¤ì¹˜
if(!require("learnr")) install.packages("learnr")
if(!require("ggplot2")) install.packages("ggplot2")
if(!require("dplyr")) install.packages("dplyr")
if(!require("tidyr")) install.packages("tidyr")
if(!require("patchwork")) install.packages("patchwork")
if(!require("ggrepel")) install.packages("ggrepel")
if(!require("viridis")) install.packages("viridis")
if(!require("scales")) install.packages("scales")
if(!require("showtext")) install.packages("showtext")
if(!require("sysfonts")) install.packages("sysfonts")
```

```{r setup, include=FALSE}
library(learnr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(patchwork)
library(ggrepel)
library(viridis)
library(scales)
library(showtext)
library(sysfonts)

# í•œê¸€ í°íŠ¸ ì„¤ì • (Google Fontsì—ì„œ Noto Sans KR ì‚¬ìš©)
font_add_google("Noto Sans KR", "NotoSansKR")
showtext_auto()
theme_set(theme_minimal(base_family = "NotoSansKR"))

# ìƒ˜í”Œ ë°ì´í„° ìƒì„±
set.seed(42)

# 1. ìë™ì°¨ ë°ì´í„° (ë¼ë²¨ë§ìš©)
mtcars_labeled <- mtcars %>%
  tibble::rownames_to_column("model") %>%
  arrange(desc(mpg)) %>%
  slice(1:10)

# 2. ì„ìƒì‹œí—˜ ë°ì´í„°
clinical_data <- data.frame(
  patient_id = 1:100,
  age = rnorm(100, mean = 55, sd = 15),
  treatment = sample(c("Control", "Drug A", "Drug B"), 100, replace = TRUE),
  response = rnorm(100, mean = 50, sd = 20),
  stringsAsFactors = FALSE
)
clinical_data$response <- clinical_data$response +
  ifelse(clinical_data$treatment == "Drug A", 15,
         ifelse(clinical_data$treatment == "Drug B", 10, 0))

# 3. ìœ ì „ì²´ ë°ì´í„° (Volcano Plot)
gene_data <- data.frame(
  gene = paste0("Gene", 1:100),
  log2FC = rnorm(100, mean = 0, sd = 1.5),
  pvalue = runif(100, 0, 0.1),
  stringsAsFactors = FALSE
) %>%
  mutate(
    neg_log10p = -log10(pvalue),
    significant = ifelse(abs(log2FC) > 1 & pvalue < 0.05, "Significant", "NS"),
    label = ifelse(abs(log2FC) > 1.5 & pvalue < 0.01, gene, "")
  )

# 4. ê±´ê°•ê²€ì§„ ë°ì´í„°
health_data <- data.frame(
  age = rnorm(200, mean = 45, sd = 15),
  bmi = rnorm(200, mean = 25, sd = 4),
  sbp = rnorm(200, mean = 130, sd = 20),
  gender = sample(c("M", "F"), 200, replace = TRUE),
  stringsAsFactors = FALSE
)

knitr::opts_chunk$set(echo = FALSE)
```

<div style="text-align: right; padding: 10px;">
  <a href="/shiny/" style="display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 10px 20px; border-radius: 20px; text-decoration: none; font-weight: bold;">í™ˆìœ¼ë¡œ</a>
</div>

## ë…¼ë¬¸ ì¶œíŒ ìˆ˜ì¤€ ê·¸ë˜í”½ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!

### í•™ìŠµ ëª©í‘œ:
- **ggrepel**ë¡œ í…ìŠ¤íŠ¸ ë¼ë²¨ ê²¹ì¹¨ ë°©ì§€
- **patchwork**ë¡œ ë‹¤ì¤‘ íŒ¨ë„ Figure ì¡°í•© (A, B, C ë¼ë²¨ë§)
- **viridis**ë¡œ ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ ì‚¬ìš©
- í•™ìˆ ì§€ ìŠ¤íƒ€ì¼ í…Œë§ˆ ì ìš©
- **ggsave**ë¡œ ê³ í•´ìƒë„ ì €ì¥

### ì´ ê³¼ì •ì„ ë§ˆì¹˜ë©´:
- Nature, Science ë“± í•™ìˆ ì§€ ê¸°ì¤€ì˜ Figure ì œì‘ ê°€ëŠ¥
- ì—¬ëŸ¬ ê·¸ë˜í”„ë¥¼ í•˜ë‚˜ì˜ Figureë¡œ ì¡°í•© ê°€ëŠ¥
- ìƒ‰ë§¹ ì¹œí™”ì ì´ê³  ì „ë¬¸ì ì¸ ì‹œê°í™” êµ¬í˜„

---

## 1ì¥: ggrepel - í…ìŠ¤íŠ¸ ë¼ë²¨ ìµœì í™”

### ë¬¸ì œ: í…ìŠ¤íŠ¸ ê²¹ì¹¨

ì‚°ì ë„ì— ë¼ë²¨ì„ ì¶”ê°€í•  ë•Œ, `geom_text()`ëŠ” ë¼ë²¨ì´ ì„œë¡œ ê²¹ì¹˜ëŠ” ë¬¸ì œê°€ ìˆìŠµë‹ˆë‹¤.

```{r text-overlap-demo, echo=TRUE}
# ë¬¸ì œ ìƒí™©: ë¼ë²¨ì´ ê²¹ì¹¨
ggplot(mtcars_labeled, aes(x = wt, y = mpg, label = model)) +
  geom_point(color = "steelblue", size = 3) +
  geom_text(size = 3, vjust = -0.5) +  # ê²¹ì¹¨ ë°œìƒ!
  labs(
    title = "geom_text() - ë¼ë²¨ ê²¹ì¹¨ ë¬¸ì œ",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ì—°ë¹„ (mpg)"
  ) +
  theme_minimal()
```

### í•´ê²°: ggrepel íŒ¨í‚¤ì§€

**ggrepel**ì€ ë¼ë²¨ì´ ì ê³¼ ì„œë¡œ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ìë™ìœ¼ë¡œ ìœ„ì¹˜ë¥¼ ì¡°ì •í•©ë‹ˆë‹¤.

```{r repel-demo, echo=TRUE}
# í•´ê²°: geom_text_repel() ì‚¬ìš©
ggplot(mtcars_labeled, aes(x = wt, y = mpg, label = model)) +
  geom_point(color = "steelblue", size = 3) +
  geom_text_repel(
    size = 3,
    box.padding = 0.5,       # ë¼ë²¨ ì£¼ë³€ ì—¬ë°±
    point.padding = 0.3,     # ì  ì£¼ë³€ ì—¬ë°±
    segment.color = "grey50" # ì—°ê²°ì„  ìƒ‰ìƒ
  ) +
  labs(
    title = "geom_text_repel() - ê²¹ì¹¨ í•´ê²°!",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ì—°ë¹„ (mpg)"
  ) +
  theme_minimal()
```

### ggrepel ì£¼ìš” ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|--------|
| `box.padding` | ë¼ë²¨ ë°•ìŠ¤ ì£¼ë³€ ì—¬ë°± | 0.25 |
| `point.padding` | ì  ì£¼ë³€ ì—¬ë°± | 0 |
| `segment.color` | ì—°ê²°ì„  ìƒ‰ìƒ | "black" |
| `max.overlaps` | í—ˆìš© ìµœëŒ€ ê²¹ì¹¨ ìˆ˜ | 10 |
| `force` | ë°˜ë°œë ¥ ê°•ë„ | 1 |

### ì—°ìŠµë¬¸ì œ: ggrepel ì‚¬ìš©

ì•„ë˜ ì½”ë“œë¥¼ ì™„ì„±í•˜ì—¬ ë¼ë²¨ ê²¹ì¹¨ ë¬¸ì œë¥¼ í•´ê²°í•˜ì„¸ìš”.

```{r repel-exercise, exercise=TRUE, exercise.lines=18}
# iris ë°ì´í„°ì—ì„œ ìƒìœ„ 10ê°œ ì„ íƒ
iris_top <- iris %>%
  mutate(id = row_number()) %>%
  arrange(desc(Sepal.Length)) %>%
  slice(1:10)

# ggrepelë¡œ ë¼ë²¨ ì¶”ê°€
ggplot(iris_top, aes(x = Sepal.Length, y = Sepal.Width, label = id)) +
  geom_point(aes(color = Species), size = 3) +
  ___(  # geom_text_repel ì‚¬ìš©
    size = 3,
    box.padding = ___,
    segment.color = "grey50"
  ) +
  labs(title = "ë¶“ê½ƒ ë°ì´í„° ìƒìœ„ 10ê°œ") +
  theme_minimal()
```

```{r repel-exercise-hint}
# geom_text_repel() í•¨ìˆ˜ ì‚¬ìš©
# box.padding = 0.5 ì •ë„ê°€ ì ë‹¹í•©ë‹ˆë‹¤
```

```{r repel-exercise-solution}
iris_top <- iris %>%
  mutate(id = row_number()) %>%
  arrange(desc(Sepal.Length)) %>%
  slice(1:10)

ggplot(iris_top, aes(x = Sepal.Length, y = Sepal.Width, label = id)) +
  geom_point(aes(color = Species), size = 3) +
  geom_text_repel(
    size = 3,
    box.padding = 0.5,
    segment.color = "grey50"
  ) +
  labs(title = "ë¶“ê½ƒ ë°ì´í„° ìƒìœ„ 10ê°œ") +
  theme_minimal()
```

### ì‹¤ì „ ì˜ˆì œ: Volcano Plot

ìœ ì „ì²´ ì—°êµ¬ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” Volcano Plotì…ë‹ˆë‹¤.

```{r volcano-plot, echo=TRUE}
ggplot(gene_data, aes(x = log2FC, y = neg_log10p)) +
  geom_point(aes(color = significant), alpha = 0.6, size = 2) +
  geom_hline(yintercept = -log10(0.05), linetype = "dashed", color = "red") +
  geom_vline(xintercept = c(-1, 1), linetype = "dashed", color = "blue") +
  geom_text_repel(
    aes(label = label),
    size = 3,
    max.overlaps = 15,
    box.padding = 0.5
  ) +
  scale_color_manual(values = c("NS" = "gray", "Significant" = "red")) +
  labs(
    title = "Volcano Plot: ìœ ì „ì ë°œí˜„ ì°¨ì´",
    x = "Log2 Fold Change",
    y = "-Log10(P-value)",
    color = "Significance"
  ) +
  theme_classic() +
  theme(legend.position = "top")
```

---

## 2ì¥: patchwork - ë‹¤ì¤‘ í”Œë¡¯ ì¡°í•©

### ì™œ patchworkì¸ê°€?

í•™ìˆ  ë…¼ë¬¸ì—ì„œëŠ” ì—¬ëŸ¬ ê·¸ë˜í”„ë¥¼ **Figure 1A, 1B, 1C**ì²˜ëŸ¼ ì¡°í•©í•´ì•¼ í•©ë‹ˆë‹¤. **patchwork**ëŠ” ì§ê´€ì ì¸ ì—°ì‚°ìë¡œ ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤:

| ì—°ì‚°ì | ê¸°ëŠ¥ | ì˜ˆì‹œ |
|--------|------|------|
| `+` | ìˆœì„œëŒ€ë¡œ ë°°ì¹˜ | `p1 + p2` |
| `\|` | ì˜†ìœ¼ë¡œ ë‚˜ë€íˆ | `p1 \| p2` |
| `/` | ìœ„ì•„ë˜ë¡œ ìŒ“ê¸° | `p1 / p2` |
| `()` | ê·¸ë£¹í™” | `(p1 \| p2) / p3` |

### ê¸°ë³¸ ì‚¬ìš©ë²•

```{r patchwork-basic, echo=TRUE}
# 3ê°œì˜ í”Œë¡¯ ìƒì„±
p1 <- ggplot(mtcars, aes(x = mpg, y = disp)) +
  geom_point(color = "steelblue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "ì—°ë¹„ vs. ë°°ê¸°ëŸ‰") +
  theme_bw()

p2 <- ggplot(mtcars, aes(x = factor(cyl), y = mpg, fill = factor(cyl))) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "ì‹¤ë¦°ë”ë³„ ì—°ë¹„", x = "Cylinders") +
  theme_bw()

p3 <- ggplot(mtcars, aes(x = hp)) +
  geom_histogram(bins = 15, fill = "coral", color = "black") +
  labs(title = "ë§ˆë ¥ ë¶„í¬") +
  theme_bw()

# ì¡°í•©: (p1ê³¼ p2ë¥¼ ë‚˜ë€íˆ) ê·¸ ì•„ë˜ p3
(p1 | p2) / p3
```

### Figure ë¼ë²¨ ì¶”ê°€

```{r patchwork-labels, echo=TRUE}
# plot_annotationìœ¼ë¡œ A, B, C ë¼ë²¨ ì¶”ê°€
(p1 | p2) / p3 +
  plot_annotation(
    title = "ìë™ì°¨ ì„±ëŠ¥ ë¶„ì„ ì¢…í•©",
    tag_levels = "A",  # A, B, C ìë™ ë¼ë²¨
    theme = theme(plot.title = element_text(size = 14, face = "bold"))
  )
```

### ì—°ìŠµë¬¸ì œ: patchwork ì‚¬ìš©

4ê°œì˜ í”Œë¡¯ì„ 2x2 ê·¸ë¦¬ë“œë¡œ ë°°ì¹˜í•˜ì„¸ìš”.

```{r patchwork-exercise, exercise=TRUE, exercise.lines=25}
# 4ê°œì˜ í”Œë¡¯ ìƒì„±
plot_a <- ggplot(health_data, aes(x = age, y = bmi, color = gender)) +
  geom_point(alpha = 0.6) +
  labs(title = "ë‚˜ì´ì™€ BMI") +
  theme_minimal()

plot_b <- ggplot(health_data, aes(x = age, y = sbp, color = gender)) +
  geom_point(alpha = 0.6) +
  labs(title = "ë‚˜ì´ì™€ í˜ˆì••") +
  theme_minimal()

plot_c <- ggplot(health_data, aes(x = bmi, fill = gender)) +
  geom_density(alpha = 0.5) +
  labs(title = "BMI ë¶„í¬") +
  theme_minimal()

plot_d <- ggplot(health_data, aes(x = gender, y = sbp, fill = gender)) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "ì„±ë³„ í˜ˆì••") +
  theme_minimal()

# 2x2 ê·¸ë¦¬ë“œë¡œ ì¡°í•© (A, B ìœ„, C, D ì•„ë˜)
# íŒíŠ¸: (plot_a | plot_b) / (plot_c | plot_d)
___ +
  plot_annotation(tag_levels = "A")
```

```{r patchwork-exercise-hint}
# | ëŠ” ì˜†ìœ¼ë¡œ ë°°ì¹˜
# / ëŠ” ìœ„ì•„ë˜ë¡œ ë°°ì¹˜
# (plot_a | plot_b) / (plot_c | plot_d)
```

```{r patchwork-exercise-solution}
plot_a <- ggplot(health_data, aes(x = age, y = bmi, color = gender)) +
  geom_point(alpha = 0.6) +
  labs(title = "ë‚˜ì´ì™€ BMI") +
  theme_minimal()

plot_b <- ggplot(health_data, aes(x = age, y = sbp, color = gender)) +
  geom_point(alpha = 0.6) +
  labs(title = "ë‚˜ì´ì™€ í˜ˆì••") +
  theme_minimal()

plot_c <- ggplot(health_data, aes(x = bmi, fill = gender)) +
  geom_density(alpha = 0.5) +
  labs(title = "BMI ë¶„í¬") +
  theme_minimal()

plot_d <- ggplot(health_data, aes(x = gender, y = sbp, fill = gender)) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "ì„±ë³„ í˜ˆì••") +
  theme_minimal()

(plot_a | plot_b) / (plot_c | plot_d) +
  plot_annotation(tag_levels = "A")
```

### Quiz: patchwork

```{r quiz-patchwork}
quiz(
  question("patchworkì—ì„œ í”Œë¡¯ì„ ìœ„ì•„ë˜ë¡œ ìŒ“ëŠ” ì—°ì‚°ìëŠ”?",
    answer("/", correct = TRUE),
    answer("|"),
    answer("+"),
    answer("*"),
    allow_retry = TRUE
  ),
  question("plot_annotation(tag_levels = 'A')ì˜ ê²°ê³¼ëŠ”?",
    answer("ê° í”Œë¡¯ì— A, B, C... ë¼ë²¨ì´ ë¶™ìŒ", correct = TRUE),
    answer("ëª¨ë“  í”Œë¡¯ì— 'A'ë§Œ ë¶™ìŒ"),
    answer("í”Œë¡¯ ë°°ê²½ìƒ‰ì´ ë³€ê²½ë¨"),
    answer("ì¶• ë¼ë²¨ì´ Aë¡œ ë³€ê²½ë¨"),
    allow_retry = TRUE
  )
)
```

---

## 3ì¥: ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ

### ì™œ ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒì´ ì¤‘ìš”í•œê°€?

ì „ ì„¸ê³„ **ë‚¨ì„±ì˜ 8%**, **ì—¬ì„±ì˜ 0.5%**ê°€ ìƒ‰ë§¹ì…ë‹ˆë‹¤. í•™ìˆ  ì¶œíŒì—ì„œëŠ” ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

### Viridis íŒ”ë ˆíŠ¸

**viridis**ëŠ” ìƒ‰ë§¹ ì¹œí™”ì ì´ë©°, í‘ë°± ì¸ì‡„ì—ì„œë„ êµ¬ë³„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```{r viridis-demo, echo=TRUE}
# ì—°ì†í˜• ë°ì´í„°
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Petal.Length)) +
  geom_point(size = 3) +
  scale_color_viridis_c(option = "viridis") +
  labs(title = "Viridis ì—°ì†í˜• íŒ”ë ˆíŠ¸", color = "Petal Length") +
  theme_minimal()
```

### Viridis ì˜µì…˜ë“¤

```{r viridis-options, echo=TRUE, fig.width=10, fig.height=6}
base_plot <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Petal.Length)) +
  geom_point(size = 2) +
  theme_minimal() +
  theme(legend.position = "none")

p_viridis <- base_plot + scale_color_viridis_c(option = "viridis") + labs(title = "viridis")
p_magma <- base_plot + scale_color_viridis_c(option = "magma") + labs(title = "magma")
p_plasma <- base_plot + scale_color_viridis_c(option = "plasma") + labs(title = "plasma")
p_cividis <- base_plot + scale_color_viridis_c(option = "cividis") + labs(title = "cividis")

(p_viridis | p_magma) / (p_plasma | p_cividis) +
  plot_annotation(title = "Viridis ìƒ‰ìƒ ì˜µì…˜")
```

### ë²”ì£¼í˜• ë°ì´í„°ìš© Viridis

```{r viridis-discrete, echo=TRUE}
ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point(size = 3) +
  scale_color_viridis_d(option = "plasma", begin = 0.2, end = 0.8) +
  labs(title = "Viridis ë²”ì£¼í˜• íŒ”ë ˆíŠ¸ (viridis_d)") +
  theme_minimal()
```

### ì—°ìŠµë¬¸ì œ: ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì ìš©

mtcars ë°ì´í„°ì— viridis ìƒ‰ìƒì„ ì ìš©í•˜ì„¸ìš”.

```{r viridis-exercise, exercise=TRUE, exercise.lines=15}
# mpgë¥¼ ìƒ‰ìƒìœ¼ë¡œ, cylì„ ëª¨ì–‘ìœ¼ë¡œ
ggplot(mtcars, aes(x = wt, y = hp, color = mpg, shape = factor(cyl))) +
  geom_point(size = 4, alpha = 0.7) +
  scale_color_viridis_c(option = "___") +  # plasma, magma, viridis ì¤‘ ì„ íƒ
  scale_shape_manual(values = c(16, 17, 15)) +
  labs(
    title = "ìë™ì°¨ ë°ì´í„°: Viridis ìƒ‰ìƒ",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ë§ˆë ¥",
    color = "ì—°ë¹„",
    shape = "ì‹¤ë¦°ë”"
  ) +
  theme_minimal()
```

```{r viridis-exercise-hint}
# option = "plasma", "magma", "viridis", "cividis" ì¤‘ í•˜ë‚˜ ì„ íƒ
```

```{r viridis-exercise-solution}
ggplot(mtcars, aes(x = wt, y = hp, color = mpg, shape = factor(cyl))) +
  geom_point(size = 4, alpha = 0.7) +
  scale_color_viridis_c(option = "plasma") +
  scale_shape_manual(values = c(16, 17, 15)) +
  labs(
    title = "ìë™ì°¨ ë°ì´í„°: Viridis ìƒ‰ìƒ",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ë§ˆë ¥",
    color = "ì—°ë¹„",
    shape = "ì‹¤ë¦°ë”"
  ) +
  theme_minimal()
```

### í”¼í•´ì•¼ í•  ìƒ‰ìƒ ì¡°í•©

**ë¹¨ê°•-ì´ˆë¡ ì¡°í•©**ì€ ì ë¡ìƒ‰ë§¹ì—ì„œ êµ¬ë³„ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.

```{r bad-colors, echo=TRUE}
# í”¼í•´ì•¼ í•  ì˜ˆì‹œ
bad_colors <- ggplot(iris, aes(x = Sepal.Length, fill = Species)) +
  geom_histogram(bins = 20, alpha = 0.7, position = "identity") +
  scale_fill_manual(values = c("red", "green", "blue")) +
  labs(title = "í”¼í•´ì•¼ í•  ì¡°í•©: ë¹¨ê°•-ì´ˆë¡") +
  theme_minimal()

# ì¢‹ì€ ì˜ˆì‹œ
good_colors <- ggplot(iris, aes(x = Sepal.Length, fill = Species)) +
  geom_histogram(bins = 20, alpha = 0.7, position = "identity") +
  scale_fill_viridis_d(option = "plasma") +
  labs(title = "ê¶Œì¥: Viridis íŒ”ë ˆíŠ¸") +
  theme_minimal()

bad_colors | good_colors
```

---

## 4ì¥: í•™ìˆ ì§€ í…Œë§ˆì™€ ìŠ¤íƒ€ì¼

### ggplot2 ë‚´ì¥ í…Œë§ˆ

```{r themes-compare, echo=TRUE, fig.width=10, fig.height=6}
base <- ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point(color = "steelblue", size = 2) +
  labs(x = "Weight", y = "MPG")

p_gray <- base + theme_gray() + labs(title = "theme_gray()")
p_bw <- base + theme_bw() + labs(title = "theme_bw()")
p_minimal <- base + theme_minimal() + labs(title = "theme_minimal()")
p_classic <- base + theme_classic() + labs(title = "theme_classic()")

(p_gray | p_bw) / (p_minimal | p_classic) +
  plot_annotation(title = "ggplot2 ë‚´ì¥ í…Œë§ˆ ë¹„êµ")
```

### í•™ìˆ ì§€ë³„ ì¶”ì²œ í…Œë§ˆ

| í•™ìˆ ì§€ | ì¶”ì²œ í…Œë§ˆ | íŠ¹ì§• |
|--------|-----------|------|
| **Nature, Science** | `theme_classic()` | ì¶•ë§Œ í‘œì‹œ, ê²©ì ì—†ìŒ |
| **NEJM, Lancet** | `theme_bw()` | í°ìƒ‰ ë°°ê²½, ê²€ì€ í…Œë‘ë¦¬ |
| **PLOS ONE** | `theme_minimal()` | ìµœì†Œí•œì˜ ìš”ì†Œ |

### í…Œë§ˆ ì»¤ìŠ¤í„°ë§ˆì´ì§•

```{r theme-custom, echo=TRUE}
ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point(color = "steelblue", size = 3) +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(
    title = "ìë™ì°¨ ë¬´ê²Œì™€ ì—°ë¹„ì˜ ê´€ê³„",
    subtitle = "ë¯¸êµ­ ìë™ì°¨ 32ì¢… (1973-74 ëª¨ë¸)",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ì—°ë¹„ (miles per gallon)",
    caption = "ë°ì´í„°: mtcars | ë¶„ì„: ì—°ì„¸ëŒ€ ì‚°ì—…ë³´ê±´ ì—°êµ¬ì†Œ"
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0),
    plot.subtitle = element_text(size = 10, color = "gray40"),
    axis.title = element_text(size = 11, face = "bold"),
    axis.text = element_text(size = 10),
    plot.caption = element_text(size = 8, color = "gray50", hjust = 1)
  )
```

### ì—°ìŠµë¬¸ì œ: í…Œë§ˆ ì ìš©

í•™ìˆ ì§€ ìŠ¤íƒ€ì¼ ê·¸ë˜í”„ë¥¼ ë§Œë“œì„¸ìš”.

```{r theme-exercise, exercise=TRUE, exercise.lines=20}
ggplot(clinical_data, aes(x = treatment, y = response, fill = treatment)) +
  geom_boxplot(alpha = 0.7, outlier.shape = NA) +
  geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(
    title = "ì¹˜ë£Œêµ°ë³„ ë°˜ì‘",
    subtitle = "ì„ìƒì‹œí—˜ ê²°ê³¼ (N=100)",
    x = "ì¹˜ë£Œêµ°",
    y = "ë°˜ì‘ ì ìˆ˜"
  ) +
  theme___(base_size = 12) +  # classic, bw, minimal ì¤‘ ì„ íƒ
  theme(
    legend.position = "___",  # none, top, bottom, right ì¤‘ ì„ íƒ
    plot.title = element_text(face = "bold")
  )
```

```{r theme-exercise-hint}
# theme_classic() ë˜ëŠ” theme_bw() ì‚¬ìš©
# legend.position = "none" ìœ¼ë¡œ ë²”ë¡€ ì œê±°
```

```{r theme-exercise-solution}
ggplot(clinical_data, aes(x = treatment, y = response, fill = treatment)) +
  geom_boxplot(alpha = 0.7, outlier.shape = NA) +
  geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(
    title = "ì¹˜ë£Œêµ°ë³„ ë°˜ì‘",
    subtitle = "ì„ìƒì‹œí—˜ ê²°ê³¼ (N=100)",
    x = "ì¹˜ë£Œêµ°",
    y = "ë°˜ì‘ ì ìˆ˜"
  ) +
  theme_classic(base_size = 12) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold")
  )
```

---

## 5ì¥: ggsave - ê³ í•´ìƒë„ ì €ì¥

### ggsave ê¸°ë³¸ ì‚¬ìš©ë²•

```{r ggsave-demo, echo=TRUE, eval=FALSE}
# í”Œë¡¯ ìƒì„±
p <- ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point() +
  theme_classic()

# PNG ì €ì¥
ggsave(
  filename = "figure1.png",
  plot = p,
  width = 8,           # ë„ˆë¹„ (inch)
  height = 6,          # ë†’ì´ (inch)
  dpi = 300,           # í•´ìƒë„
  units = "in"
)

# PDF ì €ì¥ (ë²¡í„° í˜•ì‹)
ggsave(
  filename = "figure1.pdf",
  plot = p,
  width = 8,
  height = 6,
  device = cairo_pdf
)
```

### í•™ìˆ ì§€ë³„ ê¶Œì¥ ì„¤ì •

| í•™ìˆ ì§€ | í•´ìƒë„ (DPI) | íŒŒì¼ í˜•ì‹ | ê¶Œì¥ ë„ˆë¹„ |
|--------|--------------|-----------|-----------|
| **Nature** | 300-600 | PDF, TIFF | Single: 89 mm |
| **Science** | 300+ | PDF, TIFF | Single: 5.5 cm |
| **NEJM** | 300-600 | TIFF | Double: 6.75 in |
| **PLOS ONE** | 300+ | TIFF | Max: 17.35 cm |

### ë²¡í„° vs ë˜ìŠ¤í„°

| í˜•ì‹ | íŠ¹ì§• | ìš©ë„ |
|------|------|------|
| **PDF** | ë²¡í„°, í™•ëŒ€í•´ë„ ì„ ëª… | ë…¼ë¬¸ ì œì¶œ |
| **TIFF** | ë˜ìŠ¤í„°, ê³ í’ˆì§ˆ | ì¸ì‡„ìš© |
| **PNG** | ë˜ìŠ¤í„°, íˆ¬ëª… ë°°ê²½ | í”„ë ˆì  í…Œì´ì…˜ |

### Quiz: ggsave

```{r quiz-ggsave}
quiz(
  question("í•™ìˆ ì§€ ì œì¶œ ì‹œ ê¶Œì¥ë˜ëŠ” ìµœì†Œ DPIëŠ”?",
    answer("300 DPI", correct = TRUE),
    answer("72 DPI"),
    answer("150 DPI"),
    answer("96 DPI"),
    allow_retry = TRUE
  ),
  question("ë²¡í„° í˜•ì‹ íŒŒì¼ì˜ ì¥ì ì€?",
    answer("í™•ëŒ€í•´ë„ ì„ ëª…í•¨", correct = TRUE),
    answer("íŒŒì¼ í¬ê¸°ê°€ í•­ìƒ ì‘ìŒ"),
    answer("ëª¨ë“  í”„ë¡œê·¸ë¨ì—ì„œ ì—´ ìˆ˜ ìˆìŒ"),
    answer("ì¸í„°ë„· ë¡œë”©ì´ ë¹ ë¦„"),
    allow_retry = TRUE
  )
)
```

---

## 6ì¥: ì¶œíŒ í’ˆì§ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Before & After ë¹„êµ

**Before (ê¸°ë³¸ ggplot2):**

```{r before-plot, echo=TRUE}
# ê¸°ë³¸ í”Œë¡¯
ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +
  geom_point() +
  geom_smooth(method = "lm")
```

**After (ì¶œíŒ í’ˆì§ˆ):**

```{r after-plot, echo=TRUE}
# ì¶œíŒ í’ˆì§ˆ í”Œë¡¯
mtcars_top5 <- mtcars %>%
  tibble::rownames_to_column("model") %>%
  arrange(desc(mpg)) %>%
  slice(1:5)

ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), shape = factor(cyl))) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.8) +
  geom_text_repel(
    data = mtcars_top5,
    aes(label = model),
    size = 3,
    max.overlaps = 10
  ) +
  scale_color_viridis_d(
    option = "plasma",
    name = "Cylinders",
    labels = c("4 cyl", "6 cyl", "8 cyl")
  ) +
  scale_shape_manual(
    values = c(16, 17, 15),
    name = "Cylinders",
    labels = c("4 cyl", "6 cyl", "8 cyl")
  ) +
  labs(
    title = "Relationship Between Vehicle Weight and Fuel Efficiency",
    subtitle = "US automobiles (1973-74 models, n=32)",
    x = "Weight (1000 lbs)",
    y = "Fuel Efficiency (miles per gallon)",
    caption = "Data: Henderson and Velleman (1981) | Linear regression with 95% CI"
  ) +
  theme_classic(base_size = 11) +
  theme(
    plot.title = element_text(size = 13, face = "bold"),
    plot.subtitle = element_text(size = 10, color = "gray40"),
    axis.title = element_text(face = "bold"),
    legend.position = c(0.85, 0.8),
    legend.background = element_rect(fill = "white", color = "black", linewidth = 0.3),
    plot.caption = element_text(size = 8, color = "gray50", hjust = 0)
  )
```

### ì¶œíŒ í’ˆì§ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

**ë°ì´í„° ì •í™•ì„±:**
- [ ] ëª¨ë“  ìˆ˜ì¹˜ê°€ ì˜¬ë°”ë¥¸ê°€?
- [ ] ì—ëŸ¬ë°”ê°€ SEì¸ì§€ CIì¸ì§€ ëª…ì‹œ?
- [ ] N ìˆ˜ê°€ í‘œì‹œë˜ì–´ ìˆëŠ”ê°€?

**ì‹œê°ì  ìš”ì†Œ:**
- [ ] ëª¨ë“  ì¶•ì— ëª…í™•í•œ ë ˆì´ë¸”ê³¼ ë‹¨ìœ„?
- [ ] ê¸€ê¼´ í¬ê¸°ê°€ ì ì ˆí•œê°€? (ìµœì†Œ 7pt)
- [ ] ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ ì‚¬ìš©?
- [ ] ë²”ë¡€ ìœ„ì¹˜ê°€ ì ì ˆí•œê°€?

**í•´ìƒë„ ë° í¬ë§·:**
- [ ] í•´ìƒë„ 300 DPI ì´ìƒ?
- [ ] ì ì ˆí•œ íŒŒì¼ í˜•ì‹? (PDF/TIFF)
- [ ] í¬ê¸°ê°€ í•™ìˆ ì§€ ê·œì • ì¤€ìˆ˜?

---

## 7ì¥: ì¢…í•© ì˜ˆì œ

### ë‹¤ì¤‘ íŒ¨ë„ Figure ì™„ì„±ë³¸

```{r comprehensive-figure, echo=TRUE, fig.width=10, fig.height=8}
# Panel A: ì¹˜ë£Œêµ°ë³„ ë°˜ì‘
p_a <- ggplot(clinical_data, aes(x = treatment, y = response, fill = treatment)) +
  geom_boxplot(alpha = 0.7, outlier.shape = NA) +
  geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(title = "Treatment Response", x = "Group", y = "Response Score") +
  theme_classic() +
  theme(legend.position = "none", plot.title = element_text(face = "bold", size = 11))

# Panel B: ë‚˜ì´ì™€ ë°˜ì‘ì˜ ê´€ê³„
p_b <- ggplot(clinical_data, aes(x = age, y = response, color = treatment)) +
  geom_point(size = 2, alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.8) +
  scale_color_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(title = "Age vs. Response", x = "Age (years)", y = "Response Score") +
  theme_classic() +
  theme(legend.position = c(0.15, 0.85),
        legend.background = element_rect(fill = "white", color = "black", linewidth = 0.3),
        legend.title = element_text(size = 9),
        plot.title = element_text(face = "bold", size = 11))

# Panel C: ë°˜ì‘ ë¶„í¬
p_c <- ggplot(clinical_data, aes(x = response, fill = treatment)) +
  geom_density(alpha = 0.6) +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(title = "Response Distribution", x = "Response Score", y = "Density") +
  theme_classic() +
  theme(legend.position = "top",
        plot.title = element_text(face = "bold", size = 11))

# Panel D: ë‚˜ì´ ë¶„í¬
p_d <- ggplot(clinical_data, aes(x = treatment, y = age, fill = treatment)) +
  geom_violin(alpha = 0.7) +
  geom_boxplot(width = 0.1, fill = "white") +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(title = "Age by Treatment Group", x = "Group", y = "Age (years)") +
  theme_classic() +
  theme(legend.position = "none", plot.title = element_text(face = "bold", size = 11))

# ì¡°í•©
(p_a | p_b) / (p_c | p_d) +
  plot_annotation(
    title = "Phase II Clinical Trial Results",
    subtitle = "Randomized controlled trial (N=100 patients)",
    caption = "Error bars: 95% CI | *p<0.05, **p<0.01",
    tag_levels = "A",
    theme = theme(
      plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
      plot.subtitle = element_text(size = 11, hjust = 0.5, color = "gray40"),
      plot.caption = element_text(size = 9, hjust = 0)
    )
  )
```

---

## ì¢…í•© í€´ì¦ˆ

```{r final-quiz}
quiz(
  question("ggrepel íŒ¨í‚¤ì§€ì˜ ì£¼ìš” ê¸°ëŠ¥ì€?",
    answer("í…ìŠ¤íŠ¸ ë¼ë²¨ ê²¹ì¹¨ ë°©ì§€", correct = TRUE),
    answer("3D ê·¸ë˜í”„ ìƒì„±"),
    answer("ì¸í„°ë™í‹°ë¸Œ ê·¸ë˜í”„ ìƒì„±"),
    answer("ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€"),
    allow_retry = TRUE
  ),
  question("patchworkì—ì„œ ëª¨ë“  í”Œë¡¯ì— ê°™ì€ í…Œë§ˆë¥¼ ì ìš©í•˜ëŠ” ì—°ì‚°ìëŠ”?",
    answer("&", correct = TRUE),
    answer("|"),
    answer("/"),
    answer("+"),
    allow_retry = TRUE
  ),
  question("ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ íŒ”ë ˆíŠ¸ë¡œ ì í•©í•œ ê²ƒì€?",
    answer("viridis", correct = TRUE),
    answer("ë¹¨ê°•-ì´ˆë¡"),
    answer("ë¬´ì§€ê°œìƒ‰"),
    answer("íŒŒë‘-ë³´ë¼"),
    allow_retry = TRUE
  ),
  question("í•™ìˆ ì§€ ì œì¶œìš© ê·¸ë˜í”„ì˜ ê¶Œì¥ DPIëŠ”?",
    answer("300 ì´ìƒ", correct = TRUE),
    answer("72"),
    answer("96"),
    answer("150"),
    allow_retry = TRUE
  ),
  question("plot_annotation(tag_levels = 'a')ì˜ ê²°ê³¼ëŠ”?",
    answer("a, b, c... ì†Œë¬¸ì ë¼ë²¨", correct = TRUE),
    answer("A, B, C... ëŒ€ë¬¸ì ë¼ë²¨"),
    answer("1, 2, 3... ìˆ«ì ë¼ë²¨"),
    answer("I, II, III... ë¡œë§ˆ ìˆ«ì"),
    allow_retry = TRUE
  )
)
```

---

## í•™ìŠµ ì™„ë£Œ!

### ì´ë²ˆ ê³¼ì •ì—ì„œ ë°°ìš´ ë‚´ìš©:

1. **ggrepel**: í…ìŠ¤íŠ¸ ë¼ë²¨ ê²¹ì¹¨ ë°©ì§€
2. **patchwork**: ë‹¤ì¤‘ íŒ¨ë„ Figure ì¡°í•© (A, B, C ë¼ë²¨ë§)
3. **viridis**: ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ íŒ”ë ˆíŠ¸
4. **í…Œë§ˆ ì»¤ìŠ¤í„°ë§ˆì´ì§•**: í•™ìˆ ì§€ ìŠ¤íƒ€ì¼ ì ìš©
5. **ggsave**: ê³ í•´ìƒë„ ì €ì¥ (300+ DPI)
6. **ì¶œíŒ ì²´í¬ë¦¬ìŠ¤íŠ¸**: ì „ë¬¸ì ì¸ Figure ì œì‘

### ë‹¤ìŒ ë‹¨ê³„:

- **Chapter 7**: ì¸í„°ë™í‹°ë¸Œ ì‹œê°í™” (plotly, shiny)
- **ì‹¤ìŠµ í”„ë¡œì íŠ¸**: ì‹¤ì œ ë…¼ë¬¸ìš© Figure ì œì‘

### ì¶”ê°€ í•™ìŠµ ìë£Œ:

- [ggrepel ë¬¸ì„œ](https://ggrepel.slowkow.com/)
- [patchwork ë¬¸ì„œ](https://patchwork.data-imaginist.com/)
- [R Graphics Cookbook](https://r-graphics.org/)
- [Data Visualization by Kieran Healy](https://socviz.co/)

### ì¶œíŒ ê°€ì´ë“œë¼ì¸:

- [Nature Figure Guidelines](https://www.nature.com/nature/for-authors/final-submission)
- [Science Figure Guidelines](https://www.science.org/content/page/instructions-preparing-initial-manuscript)
- [ColorBrewer](https://colorbrewer2.org/) - ìƒ‰ìƒ ì„ íƒ ë„êµ¬

---

## 8ì¥: ì‹¬í™” í€´ì¦ˆ ğŸ§ 

### ì½”ë“œ ê²°ê³¼ ì˜ˆì¸¡ í€´ì¦ˆ

```{r quiz-code-predict}
quiz(
  question("ë‹¤ìŒ ì½”ë“œì˜ ê²°ê³¼ëŠ”?\n\np1 <- ggplot(mtcars, aes(x = mpg)) + geom_histogram()\np2 <- ggplot(mtcars, aes(x = wt)) + geom_histogram()\np1 | p2",
    answer("p1ê³¼ p2ê°€ ì¢Œìš°ë¡œ ë‚˜ë€íˆ ë°°ì¹˜ë¨", correct = TRUE),
    answer("p1ê³¼ p2ê°€ ìœ„ì•„ë˜ë¡œ ìŒ“ì„"),
    answer("p1ë§Œ í‘œì‹œë¨"),
    answer("ì˜¤ë¥˜ ë°œìƒ"),
    correct = "ì •ë‹µ! patchworkì˜ | ì—°ì‚°ìëŠ” í”Œë¡¯ì„ ì¢Œìš°ë¡œ ë‚˜ë€íˆ ë°°ì¹˜í•©ë‹ˆë‹¤."
  ),

  question("ë‹¤ìŒ ì½”ë“œì—ì„œ begin = 0.2, end = 0.8ì˜ ì—­í• ì€?\n\nscale_color_viridis_d(option = 'plasma', begin = 0.2, end = 0.8)",
    answer("íˆ¬ëª…ë„ë¥¼ 0.2~0.8ë¡œ ì„¤ì •"),
    answer("ìƒ‰ìƒ íŒ”ë ˆíŠ¸ì˜ 20%~80% ë²”ìœ„ë§Œ ì‚¬ìš©", correct = TRUE),
    answer("ë°ì´í„°ì˜ 20%~80%ë§Œ í‘œì‹œ"),
    answer("í¬ê¸°ë¥¼ 0.2~0.8ë°°ë¡œ ì¡°ì ˆ"),
    correct = "ì •ë‹µ! beginê³¼ endëŠ” viridis ìƒ‰ìƒ ë²”ìœ„ì˜ ì‹œì‘ì ê³¼ ëì ì„ ì§€ì •í•©ë‹ˆë‹¤."
  )
)
```

### ì˜¤ë¥˜ ì°¾ê¸° í€´ì¦ˆ

```{r quiz-error-find}
quiz(
  question("ë‹¤ìŒ ì½”ë“œì˜ ë¬¸ì œì ì€?\n\nggplot(mtcars, aes(x = wt, y = mpg, label = rownames(mtcars))) +\n  geom_point() +\n  geom_text_repel(aes(label = label))",
    answer("labelì´ ë‘ ë²ˆ ì¤‘ë³µ ì§€ì •ë¨", correct = TRUE),
    answer("geom_point()ì— ìƒ‰ìƒì´ ì—†ìŒ"),
    answer("themeê°€ ì§€ì •ë˜ì§€ ì•ŠìŒ"),
    answer("ì˜¤ë¥˜ê°€ ì—†ìŒ"),
    correct = "ì •ë‹µ! aes()ì—ì„œ labelì´ ì´ë¯¸ ì§€ì •ë˜ì–´ ìˆëŠ”ë°, geom_text_repelì—ì„œ ë‹¤ì‹œ ì§€ì •í•˜ë©´ ì¶©ëŒí•©ë‹ˆë‹¤."
  ),

  question("ë‹¤ìŒ patchwork ì½”ë“œì˜ ë¬¸ì œì ì€?\n\n(p1 + p2) / p3 +\n  plot_annotation(tag_levels = 'A')\n\n# p1, p2, p3ê°€ ëª¨ë‘ ì •ì˜ë˜ì–´ ìˆë‹¤ê³  ê°€ì •",
    answer("+ ì—°ì‚°ì ëŒ€ì‹  | ë¥¼ ì‚¬ìš©í•´ì•¼ í•¨", correct = TRUE),
    answer("plot_annotation ìœ„ì¹˜ê°€ ì˜ëª»ë¨"),
    answer("tag_levelsê°€ ì˜ëª»ë¨"),
    answer("ë¬¸ì œ ì—†ìŒ"),
    correct = "ì •ë‹µ! p1 + p2ëŠ” ìˆœì°¨ ë°°ì¹˜ì´ê³ , p1 | p2ê°€ ë‚˜ë€íˆ ë°°ì¹˜ì…ë‹ˆë‹¤. ì˜ë„ì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ | ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤."
  )
)
```

### ë¹ˆì¹¸ ì±„ìš°ê¸° í€´ì¦ˆ

```{r quiz-fill-blank}
quiz(
  question("ggsave()ì—ì„œ ê³ í•´ìƒë„ ì¶œë ¥ì„ ìœ„í•œ ê¶Œì¥ DPI ì„¤ì •ì€ ìµœì†Œ _____ì´ë‹¤.",
    answer("72"),
    answer("150"),
    answer("300", correct = TRUE),
    answer("96"),
    correct = "ì •ë‹µ! í•™ìˆ ì§€ ì œì¶œìš© ê·¸ë˜í”„ëŠ” ìµœì†Œ 300 DPIë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤."
  ),

  question("patchworkì—ì„œ ëª¨ë“  ì„œë¸Œí”Œë¡¯ì— ë™ì¼í•œ í…Œë§ˆë¥¼ ì ìš©í•˜ë ¤ë©´ _____ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•œë‹¤.",
    answer("+"),
    answer("|"),
    answer("/"),
    answer("&", correct = TRUE),
    correct = "ì •ë‹µ! & ì—°ì‚°ìëŠ” ì¡°í•©ëœ ëª¨ë“  í”Œë¡¯ì— ë™ì¼í•œ ìˆ˜ì •ì„ ì ìš©í•©ë‹ˆë‹¤."
  ),

  question("ìƒ‰ë§¹ í™˜ìì˜ ì•½ _____ê°€ ì ë¡ìƒ‰ë§¹ì´ë‹¤.",
    answer("50%"),
    answer("70%"),
    answer("95%", correct = TRUE),
    answer("30%"),
    correct = "ì •ë‹µ! ìƒ‰ë§¹ì˜ ëŒ€ë¶€ë¶„(ì•½ 95%)ì€ ì ë¡ìƒ‰ë§¹ì…ë‹ˆë‹¤."
  )
)
```

### ê°œë… ì‹¬í™” í€´ì¦ˆ

```{r quiz-concept-advanced}
quiz(
  question("ggrepelì˜ max.overlaps ì˜µì…˜ì˜ ì—­í• ì€?",
    answer("ìµœëŒ€ ë¼ë²¨ ê°œìˆ˜ ì œí•œ"),
    answer("í—ˆìš©ë˜ëŠ” ìµœëŒ€ ê²¹ì¹¨ íšŸìˆ˜", correct = TRUE),
    answer("ìµœëŒ€ ê¸€ì ìˆ˜ ì œí•œ"),
    answer("ìµœëŒ€ ì—°ê²°ì„  ê¸¸ì´"),
    correct = "ì •ë‹µ! max.overlapsëŠ” ê²¹ì¹¨ì´ í—ˆìš©ë˜ëŠ” ìµœëŒ€ íšŸìˆ˜ë¡œ, ì´ˆê³¼ ì‹œ ë¼ë²¨ì´ í‘œì‹œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤."
  ),

  question("ë²¡í„° í˜•ì‹(PDF, SVG)ê³¼ ë˜ìŠ¤í„° í˜•ì‹(PNG, TIFF)ì˜ ê°€ì¥ í° ì°¨ì´ì ì€?",
    answer("íŒŒì¼ í¬ê¸°"),
    answer("ìƒ‰ìƒ í‘œí˜„ ë²”ìœ„"),
    answer("í™•ëŒ€ ì‹œ í™”ì§ˆ ì†ì‹¤ ì—¬ë¶€", correct = TRUE),
    answer("ì €ì¥ ì†ë„"),
    correct = "ì •ë‹µ! ë²¡í„°ëŠ” ìˆ˜í•™ì  ê³¡ì„ ìœ¼ë¡œ ì €ì¥ë˜ì–´ í™•ëŒ€í•´ë„ ì„ ëª…í•˜ì§€ë§Œ, ë˜ìŠ¤í„°ëŠ” í”½ì…€ ê¸°ë°˜ì´ë¼ í™•ëŒ€ ì‹œ í™”ì§ˆì´ ì €í•˜ë©ë‹ˆë‹¤."
  ),

  question("theme_classic()ê³¼ theme_bw()ì˜ ì£¼ìš” ì°¨ì´ì ì€?",
    answer("ë°°ê²½ìƒ‰"),
    answer("theme_classic()ì€ ê²©ìì„ ì´ ì—†ê³  ì¶•ë§Œ í‘œì‹œë¨", correct = TRUE),
    answer("ê¸€ê¼´ í¬ê¸°"),
    answer("ë²”ë¡€ ìœ„ì¹˜"),
    correct = "ì •ë‹µ! theme_classic()ì€ ì¶•ë§Œ í‘œì‹œí•˜ê³  ê²©ìì„ ì´ ì—†ì–´ ê¹”ë”í•œ í•™ìˆ ì§€ ìŠ¤íƒ€ì¼ì— ì í•©í•©ë‹ˆë‹¤."
  ),

  question("Volcano Plotì—ì„œ xì¶•ê³¼ yì¶•ì€ ê°ê° ë¬´ì—‡ì„ ë‚˜íƒ€ë‚´ëŠ”ê°€?",
    answer("ë°œí˜„ëŸ‰, ìƒ˜í”Œ ìˆ˜"),
    answer("Log2 Fold Change, -Log10(P-value)", correct = TRUE),
    answer("í‰ê· , í‘œì¤€í¸ì°¨"),
    answer("ì‹œê°„, ë†ë„"),
    correct = "ì •ë‹µ! Volcano Plotì€ xì¶•ì— íš¨ê³¼ í¬ê¸°(Log2FC), yì¶•ì— í†µê³„ì  ìœ ì˜ì„±(-log10 p-value)ì„ í‘œì‹œí•©ë‹ˆë‹¤."
  ),

  question("í•™ìˆ ì§€ Figureì—ì„œ ë²”ë¡€(legend)ë¥¼ ê·¸ë˜í”„ ë‚´ë¶€ì— ë°°ì¹˜í•˜ëŠ” ì½”ë“œëŠ”?",
    answer("legend.position = 'inside'"),
    answer("legend.position = c(0.8, 0.8)", correct = TRUE),
    answer("legend.position = 'center'"),
    answer("legend.position = 'in'"),
    correct = "ì •ë‹µ! 0~1 ì‚¬ì´ì˜ ì¢Œí‘œë¥¼ ì‚¬ìš©í•˜ì—¬ ê·¸ë˜í”„ ë‚´ë¶€ì˜ ì›í•˜ëŠ” ìœ„ì¹˜ì— ë²”ë¡€ë¥¼ ë°°ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  )
)
```

---

## ğŸ† í•™ìŠµ ê²°ê³¼ í™•ì¸

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 15px; color: white; text-align: center; margin: 20px 0;">

<h3 style="margin: 0 0 20px 0;">ğŸ“Š Part III-2: ë…¼ë¬¸ ì¶œíŒ ìˆ˜ì¤€ ê·¸ë˜í”½</h3>

<div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
  <div style="background: rgba(255,255,255,0.2); padding: 20px 30px; border-radius: 10px;">
    <p style="margin: 0; font-size: 0.9em;">ì •ë‹µ ìˆ˜</p>
    <p style="margin: 5px 0 0 0; font-size: 2em; font-weight: bold;" id="correct-count">0</p>
  </div>
  <div style="background: rgba(255,255,255,0.2); padding: 20px 30px; border-radius: 10px;">
    <p style="margin: 0; font-size: 0.9em;">ì´ í€´ì¦ˆ</p>
    <p style="margin: 5px 0 0 0; font-size: 2em; font-weight: bold;" id="total-count">0</p>
  </div>
  <div style="background: rgba(255,255,255,0.2); padding: 20px 30px; border-radius: 10px;">
    <p style="margin: 0; font-size: 0.9em;">ì ìˆ˜</p>
    <p style="margin: 5px 0 0 0; font-size: 2em; font-weight: bold;" id="score-percent">0%</p>
  </div>
</div>

<hr style="border-color: rgba(255,255,255,0.3); margin: 20px 0;">
<p style="margin: 0; font-size: 0.9em;">â€» í€´ì¦ˆë¥¼ í’€ë©´ ìë™ìœ¼ë¡œ ì ìˆ˜ê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤</p>
<button onclick="updateScore()" style="margin-top: 15px; padding: 10px 20px; border: none; border-radius: 20px; background: white; color: #667eea; font-weight: bold; cursor: pointer;">ğŸ”„ ì ìˆ˜ ìƒˆë¡œê³ ì¹¨</button>
</div>

<script>
function updateScore() {
  var correct = document.querySelectorAll('.correct').length;
  var incorrect = document.querySelectorAll('.incorrect').length;
  var total = correct + incorrect;

  document.getElementById('correct-count').innerText = correct;
  document.getElementById('total-count').innerText = total;

  var percent = total > 0 ? Math.round((correct / total) * 100) : 0;
  document.getElementById('score-percent').innerText = percent + '%';
}

setInterval(updateScore, 3000);
</script>
