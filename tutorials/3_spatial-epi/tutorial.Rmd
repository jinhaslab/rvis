---
title: "Part II-2: ê³µê°„ ì—­í•™ ì‹œê°í™”"
output:
  learnr::tutorial:
    progressive: true
    allow_skip: true
    css: www/custom.css
    includes:
      in_header: www/header.html
runtime: shiny_prerendered
---

```{r packages, include=FALSE}
# í•„ìš” íŒ¨í‚¤ì§€ ìë™ ì„¤ì¹˜
if(!require("learnr")) install.packages("learnr")
if(!require("ggplot2")) install.packages("ggplot2")
if(!require("dplyr")) install.packages("dplyr")
if(!require("tidyr")) install.packages("tidyr")
if(!require("sf")) install.packages("sf")
if(!require("viridis")) install.packages("viridis")
if(!require("scales")) install.packages("scales")
```

```{r setup, include=FALSE}
library(learnr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(sf)
library(viridis)

# í•œêµ­ 17ê°œ ì‹œë„ ë°ì´í„° ìƒì„±
set.seed(123)
regional_disease <- data.frame(
  region = c("ì„œìš¸", "ë¶€ì‚°", "ëŒ€êµ¬", "ì¸ì²œ", "ê´‘ì£¼", "ëŒ€ì „", "ìš¸ì‚°", "ì„¸ì¢…",
             "ê²½ê¸°", "ê°•ì›", "ì¶©ë¶", "ì¶©ë‚¨", "ì „ë¶", "ì „ë‚¨", "ê²½ë¶", "ê²½ë‚¨", "ì œì£¼"),
  population = c(9700000, 3400000, 2400000, 3000000, 1500000, 1500000, 1100000, 360000,
                 13500000, 1500000, 1600000, 2100000, 1800000, 1800000, 2600000, 3300000, 670000),
  cases = c(980, 340, 245, 305, 155, 152, 112, 37,
            1360, 153, 163, 214, 183, 185, 265, 335, 68),
  deaths = c(98, 34, 25, 31, 16, 15, 11, 4,
             136, 15, 16, 21, 18, 19, 27, 34, 7),
  stringsAsFactors = FALSE
)

regional_disease <- regional_disease %>%
  mutate(
    incidence_rate = (cases / population) * 100000,
    case_fatality = (deaths / cases) * 100
  )

# ì‹œë„ë³„ ì¢Œí‘œ (ì¤‘ì‹¬ì )
region_coords <- data.frame(
  region = c("ì„œìš¸", "ë¶€ì‚°", "ëŒ€êµ¬", "ì¸ì²œ", "ê´‘ì£¼", "ëŒ€ì „", "ìš¸ì‚°", "ì„¸ì¢…",
             "ê²½ê¸°", "ê°•ì›", "ì¶©ë¶", "ì¶©ë‚¨", "ì „ë¶", "ì „ë‚¨", "ê²½ë¶", "ê²½ë‚¨", "ì œì£¼"),
  lon = c(126.98, 129.08, 128.60, 126.71, 126.85, 127.38, 129.31, 127.29,
          127.18, 128.21, 127.70, 126.80, 127.15, 126.99, 128.89, 128.25, 126.53),
  lat = c(37.57, 35.18, 35.87, 37.46, 35.16, 36.35, 35.54, 36.48,
          37.41, 37.82, 36.64, 36.52, 35.72, 34.86, 36.25, 35.46, 33.49),
  stringsAsFactors = FALSE
)

# ë°ì´í„° ê²°í•©
map_data <- regional_disease %>%
  left_join(region_coords, by = "region")

# êµ­ê°€ë³„ ì „ì—¼ë³‘ ë°ì´í„°
set.seed(456)
world_disease <- data.frame(
  country = c("Korea", "Japan", "China", "USA", "Germany", "France", "UK", "Italy",
              "Brazil", "India", "Australia", "Canada"),
  population_mil = c(52, 126, 1400, 330, 83, 67, 67, 60, 210, 1400, 26, 38),
  cases = c(5200, 12600, 28000, 33000, 8300, 6700, 6700, 6000, 21000, 42000, 2600, 3800),
  stringsAsFactors = FALSE
) %>%
  mutate(incidence_rate = cases / population_mil)

knitr::opts_chunk$set(echo = FALSE)
```

<div style="text-align: right; padding: 10px;">
  <a href="/shiny/" style="display: inline-block; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 10px 20px; border-radius: 20px; text-decoration: none; font-weight: bold;">í™ˆìœ¼ë¡œ</a>
</div>

## ê³µê°„ ì—­í•™ ì‹œê°í™”ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!

### í•™ìŠµ ëª©í‘œ:
- **ê³µê°„ ë°ì´í„°**ì˜ ê¸°ë³¸ ê°œë… ì´í•´
- **sf íŒ¨í‚¤ì§€**ë¡œ ê³µê°„ ë°ì´í„° ë‹¤ë£¨ê¸°
- **ì½”ë¡œí”Œë ˆìŠ¤ ë§µ (Choropleth Map)** ì œì‘
- **ë°œìƒë¥  (Incidence Rate)** ê³„ì‚° ë° ì‹œê°í™”
- **í‘œì¤€í™” ë°œìƒë¹„ (SIR)** ì´í•´ ë° ì ìš©

### ì´ ê³¼ì •ì„ ë§ˆì¹˜ë©´:
- ì§€ì—­ë³„ ì§ˆë³‘ ë°ì´í„°ë¥¼ ì§€ë„ì— í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ì¸êµ¬ í‘œì¤€í™”ì˜ ì¤‘ìš”ì„±ì„ ì´í•´í•©ë‹ˆë‹¤
- ê³µê°„ íŒ¨í„´ì„ íƒìƒ‰í•˜ê³  í•´ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

---

## 1ì¥: ê³µê°„ ì—­í•™ì˜ ê¸°ì´ˆ

### ê³µê°„ ì—­í•™ (Spatial Epidemiology)ì´ë€?

**ê³µê°„ ì—­í•™**ì€ ì§ˆë³‘ì˜ **ì§€ë¦¬ì  ë¶„í¬**ì™€ **ê³µê°„ì  íŒ¨í„´**ì„ ì—°êµ¬í•˜ëŠ” í•™ë¬¸ì…ë‹ˆë‹¤.

**ì£¼ìš” ì§ˆë¬¸:**
- íŠ¹ì • ì§ˆë³‘ì´ ì–´ëŠ ì§€ì—­ì— ì§‘ì¤‘ë˜ì–´ ìˆëŠ”ê°€?
- í™˜ê²½ì  ìš”ì¸ê³¼ ì§ˆë³‘ ë°œìƒì˜ ê´€ê³„ëŠ”?
- ì§ˆë³‘ í´ëŸ¬ìŠ¤í„°(ì§‘ë‹¨ ë°œìƒ)ê°€ ìˆëŠ”ê°€?

### ì—­ì‚¬ì  ì‚¬ë¡€: ì¡´ ìŠ¤ë…¸ìš°ì˜ ì½œë ˆë¼ ì§€ë„ (1854)

ì¡´ ìŠ¤ë…¸ìš°(John Snow)ëŠ” ëŸ°ë˜ ì½œë ˆë¼ ë°œìƒì„ ì§€ë„ì— í‘œì‹œí•˜ì—¬ **Broad Street íŒí”„**ê°€ ì›ì¸ì„ì„ ë°í˜€ëƒˆìŠµë‹ˆë‹¤. ì´ê²ƒì´ í˜„ëŒ€ ê³µê°„ ì—­í•™ì˜ ì‹œì‘ì…ë‹ˆë‹¤.

```{r snow-example, echo=TRUE}
# ê°€ìƒì˜ ì¡´ ìŠ¤ë…¸ìš° ë°ì´í„°
snow_data <- data.frame(
  x = c(5.1, 5.3, 5.2, 5.0, 5.4, 5.5, 6.0, 6.2, 4.8, 5.1,
        5.2, 5.3, 5.1, 5.4, 5.0, 6.5, 7.0, 4.0, 8.0, 3.5),
  y = c(3.2, 3.1, 3.4, 3.0, 3.3, 3.5, 4.0, 3.8, 3.1, 3.0,
        3.3, 3.2, 3.1, 3.4, 2.9, 5.0, 5.5, 4.0, 5.0, 2.0),
  deaths = c(3, 2, 4, 1, 2, 3, 1, 1, 2, 3,
             2, 1, 2, 3, 1, 0, 0, 0, 0, 0)
)

# íŒí”„ ìœ„ì¹˜
pump <- data.frame(x = 5.2, y = 3.2, label = "Broad St. Pump")

ggplot() +
  geom_point(data = snow_data, aes(x = x, y = y, size = deaths),
             alpha = 0.6, color = "#E74C3C") +
  geom_point(data = pump, aes(x = x, y = y),
             shape = 24, size = 5, fill = "#3498DB", color = "black") +
  geom_text(data = pump, aes(x = x, y = y + 0.4, label = label),
            fontface = "bold", size = 4) +
  scale_size_continuous(name = "ì‚¬ë§ì ìˆ˜", range = c(2, 10)) +
  labs(
    title = "ì¡´ ìŠ¤ë…¸ìš°ì˜ ì½œë ˆë¼ ì§€ë„ (ì‹œë®¬ë ˆì´ì…˜)",
    subtitle = "ì‚¼ê°í˜•: Broad Street íŒí”„, ì›: ì‚¬ë§ ë°œìƒ ì§€ì ",
    x = "ê²½ë„ (ê°€ìƒ)", y = "ìœ„ë„ (ê°€ìƒ)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    legend.position = "right"
  )
```

**í•´ì„:** ì‚¬ë§ìë“¤ì´ Broad Street íŒí”„ ì£¼ë³€ì— ì§‘ì¤‘ë˜ì–´ ìˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤!

### Quiz: ê³µê°„ ì—­í•™ ê¸°ì´ˆ

```{r quiz-spatial-basics}
quiz(
  question("ê³µê°„ ì—­í•™(Spatial Epidemiology)ì˜ ì£¼ìš” ëª©ì ì€?",
    answer("ì§ˆë³‘ì˜ ì§€ë¦¬ì  ë¶„í¬ íŒ¨í„´ íŒŒì•…", correct = TRUE),
    answer("ê°œì¸ì˜ ìœ ì „ì  ìš”ì¸ ë¶„ì„"),
    answer("ì•½ë¬¼ì˜ íš¨ëŠ¥ í‰ê°€"),
    answer("ì„¸í¬ ìˆ˜ì¤€ì˜ ë³‘ë¦¬ ë¶„ì„"),
    allow_retry = TRUE
  ),
  question("ì¡´ ìŠ¤ë…¸ìš°ì˜ ì½œë ˆë¼ ì—°êµ¬ì—ì„œ ë°œê²¬í•œ ê²ƒì€?",
    answer("ì˜¤ì—¼ëœ ë¬¼ íŒí”„ê°€ ì½œë ˆë¼ì˜ ì›ì¸", correct = TRUE),
    answer("ê³µê¸° ì¤‘ ì„¸ê· ì´ ì›ì¸"),
    answer("ìŒì‹ ì˜¤ì—¼ì´ ì›ì¸"),
    answer("ì ‘ì´‰ ì „íŒŒê°€ ì›ì¸"),
    allow_retry = TRUE
  )
)
```

---

## 2ì¥: sf íŒ¨í‚¤ì§€ì™€ ê³µê°„ ë°ì´í„°

### Simple Features (sf) ì†Œê°œ

**sf (Simple Features for R)**ëŠ” Rì—ì„œ ê³µê°„ ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” í˜„ëŒ€ì ì¸ íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤.

**ì£¼ìš” íŠ¹ì§•:**
- tidyverseì™€ ì™„ë²½í•˜ê²Œ í˜¸í™˜
- GDAL/GEOS ê¸°ë°˜ìœ¼ë¡œ ì•ˆì •ì 
- ë°ì´í„°í”„ë ˆì„ì²˜ëŸ¼ ì‰½ê²Œ ë‹¤ë£° ìˆ˜ ìˆìŒ

### ì¢Œí‘œê³„ (CRS)

**ì¢Œí‘œê³„ (Coordinate Reference System)**ëŠ” ì§€êµ¬ í‘œë©´ì„ í‰ë©´ì— í‘œí˜„í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

| ì¢Œí‘œê³„ | EPSG ì½”ë“œ | ìš©ë„ |
|--------|-----------|------|
| **WGS84** | 4326 | GPS, ì „ì„¸ê³„ í‘œì¤€ |
| **UTM-K** | 5179 | í•œêµ­ í‰ë©´ì§ê°ì¢Œí‘œ |
| **Web Mercator** | 3857 | ì›¹ ì§€ë„ (Google, Kakao) |

```{r sf-demo, echo=TRUE}
# sf íŒ¨í‚¤ì§€ë¡œ ì  ë°ì´í„° ìƒì„±
seoul <- st_point(c(126.98, 37.57))  # ì„œìš¸ ì¢Œí‘œ
busan <- st_point(c(129.08, 35.18))  # ë¶€ì‚° ì¢Œí‘œ

# sfc (geometry column) ìƒì„±
cities_geom <- st_sfc(seoul, busan, crs = 4326)

# sf ê°ì²´ë¡œ ë³€í™˜
cities_sf <- st_sf(
  name = c("ì„œìš¸", "ë¶€ì‚°"),
  population = c(9700000, 3400000),
  geometry = cities_geom
)

# êµ¬ì¡° í™•ì¸
print(cities_sf)
```

### ì—°ìŠµë¬¸ì œ: sf ê°ì²´ ìƒì„±

ëŒ€ì „(ìœ„ë„ 36.35, ê²½ë„ 127.38)ê³¼ ê´‘ì£¼(ìœ„ë„ 35.16, ê²½ë„ 126.85)ë¥¼ ì¶”ê°€í•˜ëŠ” ì½”ë“œë¥¼ ì™„ì„±í•˜ì„¸ìš”.

```{r sf-exercise, exercise=TRUE, exercise.lines=15}
# ì  ìƒì„± (ê²½ë„, ìœ„ë„ ìˆœì„œ)
daejeon <- st_point(c(___, ___))  # ëŒ€ì „
gwangju <- st_point(c(___, ___))  # ê´‘ì£¼

# geometry ìƒì„±
more_cities <- st_sfc(daejeon, gwangju, crs = 4326)

# sf ê°ì²´ ìƒì„±
more_cities_sf <- st_sf(
  name = c("ëŒ€ì „", "ê´‘ì£¼"),
  population = c(1500000, 1500000),
  geometry = more_cities
)

print(more_cities_sf)
```

```{r sf-exercise-hint}
# ê²½ë„ê°€ ë¨¼ì €, ìœ„ë„ê°€ ë‚˜ì¤‘ì…ë‹ˆë‹¤!
# ëŒ€ì „: ê²½ë„ 127.38, ìœ„ë„ 36.35
# ê´‘ì£¼: ê²½ë„ 126.85, ìœ„ë„ 35.16
```

```{r sf-exercise-solution}
# ì  ìƒì„± (ê²½ë„, ìœ„ë„ ìˆœì„œ)
daejeon <- st_point(c(127.38, 36.35))  # ëŒ€ì „
gwangju <- st_point(c(126.85, 35.16))  # ê´‘ì£¼

# geometry ìƒì„±
more_cities <- st_sfc(daejeon, gwangju, crs = 4326)

# sf ê°ì²´ ìƒì„±
more_cities_sf <- st_sf(
  name = c("ëŒ€ì „", "ê´‘ì£¼"),
  population = c(1500000, 1500000),
  geometry = more_cities
)

print(more_cities_sf)
```

---

## 3ì¥: ì  ì§€ë„ (Point Map)

### ì  ì§€ë„ë€?

**ì  ì§€ë„**ëŠ” ìœ„ì¹˜ ë°ì´í„°ë¥¼ ì ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ê³µê°„ ì‹œê°í™”ì…ë‹ˆë‹¤.

**í™œìš© ì˜ˆ:**
- ì§ˆë³‘ ë°œìƒ ìœ„ì¹˜
- ë³‘ì›/ë³´ê±´ì†Œ ë¶„í¬
- í™˜ê²½ ì˜¤ì—¼ì› ìœ„ì¹˜

### í•œêµ­ ì‹œë„ë³„ ë°œìƒë¥  ì  ì§€ë„

```{r point-map-demo, echo=TRUE}
# ë°ì´í„° í™•ì¸
head(map_data)
```

```{r point-map-viz, echo=TRUE}
# ì  ì§€ë„ ìƒì„±
ggplot(map_data, aes(x = lon, y = lat)) +
  geom_point(aes(size = incidence_rate, color = incidence_rate), alpha = 0.7) +
  geom_text(aes(label = region), vjust = -1.5, size = 3) +
  scale_size_continuous(name = "ë°œìƒë¥ \n(10ë§Œëª…ë‹¹)", range = c(3, 15)) +
  scale_color_viridis_c(name = "ë°œìƒë¥ \n(10ë§Œëª…ë‹¹)", option = "plasma") +
  coord_fixed(ratio = 1.3) +  # ìœ„ë„/ê²½ë„ ë¹„ìœ¨ ì¡°ì •
  labs(
    title = "í•œêµ­ ì‹œë„ë³„ ì§ˆë³‘ ë°œìƒë¥ ",
    subtitle = "ì›ì˜ í¬ê¸°ì™€ ìƒ‰ìƒ = ì¸êµ¬ 10ë§Œëª…ë‹¹ ë°œìƒë¥ ",
    x = "ê²½ë„", y = "ìœ„ë„"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    legend.position = "right"
  )
```

### ì—°ìŠµë¬¸ì œ: ì  ì§€ë„ ì»¤ìŠ¤í„°ë§ˆì´ì§•

ì¹˜ëª…ë¥ (case_fatality)ì„ ìƒ‰ìƒìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ì  ì§€ë„ë¥¼ ë§Œë“œì„¸ìš”.

```{r point-exercise, exercise=TRUE, exercise.lines=18}
# map_dataì—ëŠ” incidence_rateì™€ case_fatalityê°€ ìˆìŠµë‹ˆë‹¤!

ggplot(map_data, aes(x = lon, y = lat)) +
  geom_point(aes(size = cases, color = ___), alpha = 0.7) +
  geom_text(aes(label = region), vjust = -1.5, size = 3) +
  scale_size_continuous(name = "ë°œìƒ ê±´ìˆ˜", range = c(3, 15)) +
  scale_color_gradient(
    name = "ì¹˜ëª…ë¥  (%)",
    low = "___",
    high = "___"
  ) +
  coord_fixed(ratio = 1.3) +
  labs(
    title = "ì‹œë„ë³„ ì§ˆë³‘ ë°œìƒ ê±´ìˆ˜ì™€ ì¹˜ëª…ë¥ ",
    x = "ê²½ë„", y = "ìœ„ë„"
  ) +
  theme_minimal()
```

```{r point-exercise-hint}
# color = case_fatality ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”
# low = "yellow", high = "red" ê°™ì€ ìƒ‰ìƒì„ ì§€ì •í•˜ì„¸ìš”
```

```{r point-exercise-solution}
ggplot(map_data, aes(x = lon, y = lat)) +
  geom_point(aes(size = cases, color = case_fatality), alpha = 0.7) +
  geom_text(aes(label = region), vjust = -1.5, size = 3) +
  scale_size_continuous(name = "ë°œìƒ ê±´ìˆ˜", range = c(3, 15)) +
  scale_color_gradient(
    name = "ì¹˜ëª…ë¥  (%)",
    low = "yellow",
    high = "red"
  ) +
  coord_fixed(ratio = 1.3) +
  labs(
    title = "ì‹œë„ë³„ ì§ˆë³‘ ë°œìƒ ê±´ìˆ˜ì™€ ì¹˜ëª…ë¥ ",
    x = "ê²½ë„", y = "ìœ„ë„"
  ) +
  theme_minimal()
```

### Quiz: ì  ì§€ë„

```{r quiz-point-map}
quiz(
  question("ì  ì§€ë„ì—ì„œ coord_fixed(ratio = 1.3)ì˜ ì—­í• ì€?",
    answer("ìœ„ë„/ê²½ë„ ë¹„ìœ¨ì„ ì¡°ì •í•˜ì—¬ ì§€ë„ ì™œê³¡ ë°©ì§€", correct = TRUE),
    answer("ì ì˜ í¬ê¸°ë¥¼ 1.3ë°°ë¡œ í™•ëŒ€"),
    answer("xì¶•ê³¼ yì¶• ë²”ìœ„ë¥¼ 1.3ë°°ë¡œ ì„¤ì •"),
    answer("ë ˆì´ì–´ë¥¼ 1.3ê°œë§Œ í‘œì‹œ"),
    allow_retry = TRUE
  ),
  question("viridis ìƒ‰ìƒ íŒ”ë ˆíŠ¸ì˜ ì¥ì ì€?",
    answer("ìƒ‰ë§¹ ì¹œí™”ì ì´ê³  í‘ë°± ì¸ì‡„ ê°€ëŠ¥", correct = TRUE),
    answer("RGB ìƒ‰ìƒë§Œ ì‚¬ìš©"),
    answer("ë‹¨ìƒ‰ë§Œ ì§€ì›"),
    answer("ì¸í„°ë™í‹°ë¸Œ ì§€ë„ ì „ìš©"),
    allow_retry = TRUE
  )
)
```

---

## 4ì¥: ë°œìƒë¥  ê³„ì‚°ê³¼ ì‹œê°í™”

### ë°œìƒë¥  (Incidence Rate)

**ë°œìƒë¥ **ì€ íŠ¹ì • ê¸°ê°„ ë™ì•ˆ ìƒˆë¡œ ë°œìƒí•œ ì§ˆë³‘ ì‚¬ë¡€ë¥¼ ì¸êµ¬ë¡œ ë‚˜ëˆˆ ê°’ì…ë‹ˆë‹¤.

$$\text{ë°œìƒë¥ } = \frac{\text{ì‹ ê·œ ë°œìƒ ê±´ìˆ˜}}{\text{ì¸êµ¬}} \times 100,000$$

**ì¸êµ¬ 10ë§Œëª…ë‹¹**ìœ¼ë¡œ í‘œì¤€í™”í•˜ëŠ” ì´ìœ :
- ì¸êµ¬ê°€ ë‹¤ë¥¸ ì§€ì—­ ê°„ ê³µì •í•œ ë¹„êµ
- ì‘ì€ ìˆ«ìë¥¼ í”¼í•´ í•´ì„ ìš©ì´

### ë°œìƒë¥  ê³„ì‚° ì˜ˆì œ

```{r incidence-demo, echo=TRUE}
# ë°œìƒë¥  ê³„ì‚° (ì´ë¯¸ ë°ì´í„°ì— í¬í•¨ë¨)
regional_disease %>%
  select(region, population, cases, incidence_rate) %>%
  arrange(desc(incidence_rate)) %>%
  head(5)
```

### ì—°ìŠµë¬¸ì œ: ë°œìƒë¥  ê³„ì‚°

ë‹¤ìŒ ë°ì´í„°ë¡œ ë°œìƒë¥ ì„ ì§ì ‘ ê³„ì‚°í•´ë³´ì„¸ìš”.

```{r incidence-exercise, exercise=TRUE, exercise.lines=12}
# ìƒˆë¡œìš´ ë°ì´í„°
new_data <- data.frame(
  city = c("Aì‹œ", "Bì‹œ", "Cì‹œ"),
  population = c(500000, 1000000, 250000),
  cases = c(50, 80, 40)
)

# ë°œìƒë¥  ê³„ì‚° (ì¸êµ¬ 10ë§Œëª…ë‹¹)
new_data <- new_data %>%
  mutate(incidence_rate = ___)

print(new_data)
```

```{r incidence-exercise-hint}
# ë°œìƒë¥  = (cases / population) * 100000
```

```{r incidence-exercise-solution}
new_data <- data.frame(
  city = c("Aì‹œ", "Bì‹œ", "Cì‹œ"),
  population = c(500000, 1000000, 250000),
  cases = c(50, 80, 40)
)

new_data <- new_data %>%
  mutate(incidence_rate = (cases / population) * 100000)

print(new_data)
```

### ë§‰ëŒ€ ê·¸ë˜í”„ë¡œ ë°œìƒë¥  ë¹„êµ

```{r bar-incidence, echo=TRUE}
regional_disease %>%
  arrange(desc(incidence_rate)) %>%
  mutate(region = factor(region, levels = region)) %>%
  ggplot(aes(x = region, y = incidence_rate, fill = incidence_rate)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = round(incidence_rate, 1)),
            vjust = -0.5, size = 3) +
  scale_fill_viridis_c(option = "plasma") +
  labs(
    title = "ì‹œë„ë³„ ì§ˆë³‘ ë°œìƒë¥  ìˆœìœ„",
    subtitle = "ì¸êµ¬ 10ë§Œëª…ë‹¹",
    x = NULL, y = "ë°œìƒë¥ ",
    fill = "ë°œìƒë¥ "
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 14)
  )
```

---

## 5ì¥: í‘œì¤€í™” ë°œìƒë¹„ (SIR)

### SIR (Standardized Incidence Ratio)ë€?

**í‘œì¤€í™” ë°œìƒë¹„**ëŠ” ê´€ì°°ëœ ë°œìƒ ê±´ìˆ˜ë¥¼ ê¸°ëŒ€ ë°œìƒ ê±´ìˆ˜ë¡œ ë‚˜ëˆˆ ê°’ì…ë‹ˆë‹¤.

$$\text{SIR} = \frac{\text{ê´€ì°°ëœ ê±´ìˆ˜ (Observed)}}{\text{ê¸°ëŒ€ ê±´ìˆ˜ (Expected)}} \times 100$$

**í•´ì„:**
- **SIR = 100**: ì „êµ­ í‰ê· ê³¼ ë™ì¼
- **SIR > 100**: ì „êµ­ í‰ê· ë³´ë‹¤ ë†’ìŒ (ì£¼ì˜ í•„ìš”)
- **SIR < 100**: ì „êµ­ í‰ê· ë³´ë‹¤ ë‚®ìŒ

### SIR ê³„ì‚° ê³¼ì •

```{r sir-demo, echo=TRUE}
# 1. ì „êµ­ í‰ê·  ë°œìƒë¥  ê³„ì‚°
national_rate <- sum(regional_disease$cases) / sum(regional_disease$population) * 100000
cat("ì „êµ­ í‰ê·  ë°œìƒë¥ :", round(national_rate, 2), "(ì¸êµ¬ 10ë§Œëª…ë‹¹)\n")

# 2. ê¸°ëŒ€ ë°œìƒ ê±´ìˆ˜ ê³„ì‚°
regional_sir <- regional_disease %>%
  mutate(
    expected_cases = (population / 100000) * national_rate,
    SIR = (cases / expected_cases) * 100
  )

# 3. ê²°ê³¼ í™•ì¸
regional_sir %>%
  select(region, cases, expected_cases, SIR) %>%
  arrange(desc(SIR)) %>%
  head(5)
```

### SIR ì‹œê°í™”

```{r sir-viz, echo=TRUE}
# SIR ì¹´í…Œê³ ë¦¬ ì¶”ê°€
regional_sir <- regional_sir %>%
  mutate(
    SIR_category = case_when(
      SIR < 90 ~ "ë§¤ìš° ë‚®ìŒ",
      SIR < 98 ~ "ë‚®ìŒ",
      SIR < 102 ~ "í‰ê· ",
      SIR < 110 ~ "ë†’ìŒ",
      TRUE ~ "ë§¤ìš° ë†’ìŒ"
    ),
    SIR_category = factor(SIR_category,
                          levels = c("ë§¤ìš° ë‚®ìŒ", "ë‚®ìŒ", "í‰ê· ", "ë†’ìŒ", "ë§¤ìš° ë†’ìŒ"))
  )

# ë§‰ëŒ€ ê·¸ë˜í”„
ggplot(regional_sir, aes(x = reorder(region, SIR), y = SIR, fill = SIR_category)) +
  geom_col(alpha = 0.8) +
  geom_hline(yintercept = 100, linetype = "dashed", color = "red", size = 1) +
  geom_text(aes(label = round(SIR, 1)), hjust = -0.1, size = 3) +
  coord_flip() +
  scale_fill_manual(
    values = c("ë§¤ìš° ë‚®ìŒ" = "#2ECC71", "ë‚®ìŒ" = "#82E0AA",
               "í‰ê· " = "#F4D03F", "ë†’ìŒ" = "#E67E22", "ë§¤ìš° ë†’ìŒ" = "#E74C3C"),
    name = "SIR ì¹´í…Œê³ ë¦¬"
  ) +
  labs(
    title = "ì‹œë„ë³„ í‘œì¤€í™” ë°œìƒë¹„ (SIR)",
    subtitle = "ë¹¨ê°„ ì ì„  = ì „êµ­ í‰ê·  (100)",
    x = NULL, y = "SIR"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    legend.position = "top"
  )
```

### ì—°ìŠµë¬¸ì œ: SIR ê³„ì‚°

ì•„ë˜ ì½”ë“œë¥¼ ì™„ì„±í•˜ì—¬ SIRì„ ê³„ì‚°í•˜ì„¸ìš”.

```{r sir-exercise, exercise=TRUE, exercise.lines=18}
# ë°ì´í„°
practice_data <- data.frame(
  region = c("Xêµ¬", "Yêµ¬", "Zêµ¬"),
  population = c(300000, 500000, 200000),
  cases = c(35, 45, 30)
)

# 1. ì „ì²´ í‰ê·  ë°œìƒë¥  ê³„ì‚°
total_cases <- sum(practice_data$cases)
total_pop <- sum(practice_data$population)
avg_rate <- ___ / ___ * 100000

# 2. SIR ê³„ì‚°
practice_data <- practice_data %>%
  mutate(
    expected_cases = ___,
    SIR = ___
  )

print(practice_data)
```

```{r sir-exercise-hint}
# avg_rate = total_cases / total_pop * 100000
# expected_cases = (population / 100000) * avg_rate
# SIR = (cases / expected_cases) * 100
```

```{r sir-exercise-solution}
practice_data <- data.frame(
  region = c("Xêµ¬", "Yêµ¬", "Zêµ¬"),
  population = c(300000, 500000, 200000),
  cases = c(35, 45, 30)
)

total_cases <- sum(practice_data$cases)
total_pop <- sum(practice_data$population)
avg_rate <- total_cases / total_pop * 100000

practice_data <- practice_data %>%
  mutate(
    expected_cases = (population / 100000) * avg_rate,
    SIR = (cases / expected_cases) * 100
  )

print(practice_data)
```

### Quiz: SIR

```{r quiz-sir}
quiz(
  question("SIR = 120ì€ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ë‚˜ìš”?",
    answer("ê´€ì°°ëœ ë°œìƒì´ ê¸°ëŒ€ë³´ë‹¤ 20% ë†’ìŒ", correct = TRUE),
    answer("ê´€ì°°ëœ ë°œìƒì´ ê¸°ëŒ€ë³´ë‹¤ 20% ë‚®ìŒ"),
    answer("ì¸êµ¬ê°€ 120ë§Œëª…ì„"),
    answer("ì‚¬ë§ë¥ ì´ 120%ì„"),
    allow_retry = TRUE
  ),
  question("SIR ê³„ì‚° ì‹œ 'ê¸°ëŒ€ ë°œìƒ ê±´ìˆ˜'ë€?",
    answer("í•´ë‹¹ ì§€ì—­ ì¸êµ¬ì— ì „êµ­ í‰ê·  ë°œìƒë¥ ì„ ì ìš©í•œ ê°’", correct = TRUE),
    answer("ì‘ë…„ ê°™ì€ ê¸°ê°„ì˜ ë°œìƒ ê±´ìˆ˜"),
    answer("ì „ë¬¸ê°€ê°€ ì˜ˆì¸¡í•œ ê°’"),
    answer("ì¸ì ‘ ì§€ì—­ì˜ í‰ê·  ë°œìƒ ê±´ìˆ˜"),
    allow_retry = TRUE
  )
)
```

---

## 6ì¥: ë°œìƒë¥  vs ì¹˜ëª…ë¥  ë¶„ì„

### ë°œìƒë¥ ê³¼ ì¹˜ëª…ë¥ ì˜ ê´€ê³„

**ë°œìƒë¥  (Incidence Rate)**: ì¸êµ¬ ëŒ€ë¹„ ìƒˆë¡œìš´ ê°ì—¼ ë¹„ìœ¨
**ì¹˜ëª…ë¥  (Case Fatality Rate, CFR)**: ê°ì—¼ì ì¤‘ ì‚¬ë§ì ë¹„ìœ¨

ë‘ ì§€í‘œë¥¼ í•¨ê»˜ ë¶„ì„í•˜ë©´ ì§ˆë³‘ì˜ **ì „íŒŒë ¥**ê³¼ **ì¹˜ëª…ì„±**ì„ ë™ì‹œì— íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r cfr-scatter, echo=TRUE}
ggplot(regional_disease, aes(x = incidence_rate, y = case_fatality)) +
  geom_point(aes(size = population, color = region), alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, color = "red", linetype = "dashed") +
  geom_text(aes(label = region), vjust = -1, size = 3, check_overlap = TRUE) +
  scale_size_continuous(name = "ì¸êµ¬", labels = scales::comma, range = c(3, 12)) +
  labs(
    title = "ë°œìƒë¥  vs ì¹˜ëª…ë¥ ",
    subtitle = "ì› í¬ê¸° = ì¸êµ¬",
    x = "ë°œìƒë¥  (ì¸êµ¬ 10ë§Œëª…ë‹¹)",
    y = "ì¹˜ëª…ë¥  (%)",
    color = "ì‹œë„"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    legend.position = "right"
  ) +
  guides(color = "none")
```

### ì—°ìŠµë¬¸ì œ: ì‚°ì ë„ í•´ì„

ì•„ë˜ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì—¬ ë°œìƒ ê±´ìˆ˜ì™€ ì‚¬ë§ ê±´ìˆ˜ì˜ ê´€ê³„ë¥¼ ì‹œê°í™”í•˜ì„¸ìš”.

```{r scatter-exercise, exercise=TRUE, exercise.lines=16}
# íŒíŠ¸: x = cases, y = deaths

ggplot(regional_disease, aes(x = ___, y = ___)) +
  geom_point(aes(size = population), color = "#3498DB", alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  geom_text(aes(label = region), vjust = -1, size = 3, check_overlap = TRUE) +
  scale_size_continuous(name = "ì¸êµ¬", labels = scales::comma) +
  labs(
    title = "ë°œìƒ ê±´ìˆ˜ vs ì‚¬ë§ ê±´ìˆ˜",
    x = "ë°œìƒ ê±´ìˆ˜",
    y = "ì‚¬ë§ ê±´ìˆ˜"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"))
```

```{r scatter-exercise-solution}
ggplot(regional_disease, aes(x = cases, y = deaths)) +
  geom_point(aes(size = population), color = "#3498DB", alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  geom_text(aes(label = region), vjust = -1, size = 3, check_overlap = TRUE) +
  scale_size_continuous(name = "ì¸êµ¬", labels = scales::comma) +
  labs(
    title = "ë°œìƒ ê±´ìˆ˜ vs ì‚¬ë§ ê±´ìˆ˜",
    x = "ë°œìƒ ê±´ìˆ˜",
    y = "ì‚¬ë§ ê±´ìˆ˜"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold"))
```

---

## 7ì¥: êµ­ê°€ ê°„ ë¹„êµ

### êµ­ê°€ë³„ ë°œìƒë¥  ë¹„êµ

ê³µê°„ ì—­í•™ì€ êµ­ë‚´ë¿ ì•„ë‹ˆë¼ **êµ­ê°€ ê°„ ë¹„êµ**ì—ë„ í™œìš©ë©ë‹ˆë‹¤.

```{r world-bar, echo=TRUE}
# êµ­ê°€ë³„ ë°œìƒë¥  (ì¸êµ¬ ë°±ë§Œëª…ë‹¹)
world_disease %>%
  arrange(desc(incidence_rate)) %>%
  mutate(country = factor(country, levels = country)) %>%
  ggplot(aes(x = country, y = incidence_rate, fill = incidence_rate)) +
  geom_col(alpha = 0.8) +
  geom_text(aes(label = round(incidence_rate, 0)), vjust = -0.5, size = 3) +
  scale_fill_viridis_c(option = "magma", direction = -1) +
  labs(
    title = "êµ­ê°€ë³„ ì§ˆë³‘ ë°œìƒë¥  ë¹„êµ",
    subtitle = "ì¸êµ¬ ë°±ë§Œëª…ë‹¹ ë°œìƒ ê±´ìˆ˜",
    x = NULL, y = "ë°œìƒë¥  (per million)",
    fill = "ë°œìƒë¥ "
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 14)
  )
```

### ì—°ìŠµë¬¸ì œ: êµ­ê°€ ìˆœìœ„

ë°œìƒë¥  ìƒìœ„ 5ê°œêµ­ì„ í•„í„°ë§í•˜ì—¬ ì‹œê°í™”í•˜ì„¸ìš”.

```{r world-exercise, exercise=TRUE, exercise.lines=15}
# ìƒìœ„ 5ê°œêµ­ í•„í„°ë§
top5 <- world_disease %>%
  arrange(desc(incidence_rate)) %>%
  head(___)

# ì‹œê°í™”
ggplot(top5, aes(x = reorder(country, incidence_rate), y = incidence_rate)) +
  geom_col(fill = "#E74C3C", alpha = 0.8) +
  coord_flip() +
  labs(
    title = "ë°œìƒë¥  ìƒìœ„ 5ê°œêµ­",
    x = NULL, y = "ë°œìƒë¥  (per million)"
  ) +
  theme_minimal()
```

```{r world-exercise-solution}
top5 <- world_disease %>%
  arrange(desc(incidence_rate)) %>%
  head(5)

ggplot(top5, aes(x = reorder(country, incidence_rate), y = incidence_rate)) +
  geom_col(fill = "#E74C3C", alpha = 0.8) +
  coord_flip() +
  labs(
    title = "ë°œìƒë¥  ìƒìœ„ 5ê°œêµ­",
    x = NULL, y = "ë°œìƒë¥  (per million)"
  ) +
  theme_minimal()
```

---

## 8ì¥: ì‹¬í™” í€´ì¦ˆ ğŸ§ 

### ì½”ë“œ ê²°ê³¼ ì˜ˆì¸¡ í€´ì¦ˆ

```{r quiz-code-spatial}
quiz(
  question("ë‹¤ìŒ ì½”ë“œì˜ ê²°ê³¼ëŠ”?\n\n`st_point(c(127.0, 37.5))`",
    answer("ê²½ë„ 127, ìœ„ë„ 37.5ì¸ ì  ê°ì²´ ìƒì„±", correct = TRUE),
    answer("127ê°œì˜ ì  ìƒì„±"),
    answer("37.5km ë°˜ê²½ì˜ ì› ìƒì„±"),
    answer("ì—ëŸ¬ ë°œìƒ"),
    correct = "ì •ë‹µ! st_point()ëŠ” ê²½ë„, ìœ„ë„ ìˆœìœ¼ë¡œ ì¢Œí‘œë¥¼ ë°›ì•„ ì  ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤."
  ),

  question("`coord_fixed(ratio = 1.3)`ì˜ íš¨ê³¼ëŠ”?",
    answer("ìœ„ë„/ê²½ë„ ë¹„ìœ¨ì„ ì¡°ì •í•˜ì—¬ ì§€ë„ ì™œê³¡ ë°©ì§€", correct = TRUE),
    answer("ê·¸ë˜í”„ í¬ê¸°ë¥¼ 1.3ë°°ë¡œ"),
    answer("ì  í¬ê¸°ë¥¼ 1.3ë°°ë¡œ"),
    answer("íˆ¬ëª…ë„ë¥¼ 30%ë¡œ"),
    correct = "ì •ë‹µ! í•œêµ­ ì§€ë„ì˜ ê²½ìš° ì•½ 1.3 ë¹„ìœ¨ì´ ì ì ˆí•©ë‹ˆë‹¤."
  ),

  question("`scale_color_gradient2(midpoint = 100)`ì˜ ì˜ë¯¸ëŠ”?",
    answer("100ì„ ê¸°ì¤€ìœ¼ë¡œ ì–‘ë°©í–¥ ìƒ‰ìƒ ê·¸ë¼ë°ì´ì…˜", correct = TRUE),
    answer("100ê°œì˜ ìƒ‰ìƒ ì‚¬ìš©"),
    answer("ìƒ‰ìƒì„ 100% ì±„ë„ë¡œ"),
    answer("ì—ëŸ¬ ë°œìƒ"),
    correct = "ì •ë‹µ! gradient2ëŠ” ì¤‘ê°„ê°’(midpoint)ì„ ê¸°ì¤€ìœ¼ë¡œ ì–‘ë°©í–¥ ìƒ‰ìƒì„ ì ìš©í•©ë‹ˆë‹¤."
  )
)
```

### ì˜¤ë¥˜ ì°¾ê¸° í€´ì¦ˆ

```{r quiz-error-spatial}
quiz(
  question("ë‹¤ìŒ ì½”ë“œì˜ ì˜¤ë¥˜ëŠ”?\n\n`st_sfc(point1, point2, crs = '4326')`",
    answer("crsëŠ” ìˆ«ìì—¬ì•¼ í•¨ (ë”°ì˜´í‘œ ì œê±°)", correct = TRUE),
    answer("point1, point2 ìˆœì„œ ì˜¤ë¥˜"),
    answer("st_sfc í•¨ìˆ˜ ì—†ìŒ"),
    answer("ì˜¤ë¥˜ ì—†ìŒ"),
    correct = "ì •ë‹µ! crs = 4326 (ìˆ«ì)ë¡œ ì§€ì •í•´ì•¼ í•©ë‹ˆë‹¤."
  ),

  question("SIR ê³„ì‚°ì—ì„œ `expected = population * national_rate`ì˜ ë¬¸ì œì ì€?",
    answer("populationì„ 10ë§Œëª… ë‹¨ìœ„ë¡œ ë³€í™˜í•´ì•¼ í•¨", correct = TRUE),
    answer("ê³±ì…ˆ ëŒ€ì‹  ë‚˜ëˆ—ì…ˆ"),
    answer("national_rateê°€ ì˜ëª»ë¨"),
    answer("ë¬¸ì œ ì—†ìŒ"),
    correct = "ì •ë‹µ! expected = (population / 100000) * national_rateê°€ ì˜¬ë°”ë¦…ë‹ˆë‹¤."
  ),

  question("ì  ì§€ë„ì—ì„œ `aes(x = lat, y = lon)`ì˜ ë¬¸ì œì ì€?",
    answer("ìœ„ë„/ê²½ë„ ìˆœì„œê°€ ë°˜ëŒ€ (x = lon, y = lat)", correct = TRUE),
    answer("aes ëŒ€ì‹  mapping ì‚¬ìš©"),
    answer("ë¬¸ì œ ì—†ìŒ"),
    answer("geom_point í•„ìš”"),
    correct = "ì •ë‹µ! xì¶•ì€ ê²½ë„(lon), yì¶•ì€ ìœ„ë„(lat)ì…ë‹ˆë‹¤."
  )
)
```

### ë¹ˆì¹¸ ì±„ìš°ê¸° í€´ì¦ˆ

```{r quiz-fill-spatial}
quiz(
  question("SIR ê³„ì‚°: `SIR = (observed / ______) * 100`",
    answer("expected", correct = TRUE),
    answer("population"),
    answer("cases"),
    answer("rate"),
    correct = "ì •ë‹µ! SIR = (ê´€ì°°ê°’ / ê¸°ëŒ€ê°’) * 100 ì…ë‹ˆë‹¤."
  ),

  question("sf ê°ì²´ ìƒì„±: `st_sf(data, geometry = ______)`",
    answer("st_sfc(...)", correct = TRUE),
    answer("c(lon, lat)"),
    answer("points"),
    answer("coordinates"),
    correct = "ì •ë‹µ! geometry ì—´ì—ëŠ” st_sfc() ê°ì²´ë¥¼ ë„£ìŠµë‹ˆë‹¤."
  ),

  question("ì¢Œí‘œê³„ ë³€í™˜: `st_transform(data, crs = ______)`  (í•œêµ­ ì¢Œí‘œê³„)",
    answer("5179", correct = TRUE),
    answer("4326"),
    answer("3857"),
    answer("2097"),
    correct = "ì •ë‹µ! EPSG:5179ëŠ” í•œêµ­ í‰ë©´ì§ê°ì¢Œí‘œê³„ì…ë‹ˆë‹¤."
  )
)
```

### ê³µê°„ ì—­í•™ ì‹¬í™” í€´ì¦ˆ

```{r quiz-spatial-advanced}
quiz(
  question("ê³µê°„ ìê¸°ìƒê´€(Spatial Autocorrelation)ì´ë€?",
    answer("ê°€ê¹Œìš´ ì§€ì—­ì¼ìˆ˜ë¡ ê°’ì´ ë¹„ìŠ·í•œ ê²½í–¥", correct = TRUE),
    answer("ëª¨ë“  ì§€ì—­ì˜ ê°’ì´ ë™ì¼"),
    answer("ì‹œê°„ì— ë”°ë¥¸ ìƒê´€ê´€ê³„"),
    answer("ë¬´ì‘ìœ„ ë¶„í¬"),
    correct = "ì •ë‹µ! 'ê°€ê¹Œìš´ ê²ƒì´ ë¨¼ ê²ƒë³´ë‹¤ ë” ê´€ë ¨ìˆë‹¤'ëŠ” Toblerì˜ ì œ1ë²•ì¹™ì…ë‹ˆë‹¤."
  ),

  question("Moran's I ê°’ì´ ì–‘ìˆ˜(+)ì´ë©´ ì˜ë¯¸í•˜ëŠ” ê²ƒì€?",
    answer("ë¹„ìŠ·í•œ ê°’ë¼ë¦¬ êµ°ì§‘(clustering)", correct = TRUE),
    answer("ê°’ì´ ë¬´ì‘ìœ„ ë¶„í¬"),
    answer("ë†’ì€ ê°’ê³¼ ë‚®ì€ ê°’ì´ ë²ˆê°ˆì•„ ë¶„í¬"),
    answer("ìƒê´€ê´€ê³„ ì—†ìŒ"),
    correct = "ì •ë‹µ! ì–‘ì˜ ê³µê°„ ìê¸°ìƒê´€ì€ ìœ ì‚¬í•œ ê°’ì˜ êµ°ì§‘ì„ ì˜ë¯¸í•©ë‹ˆë‹¤."
  ),

  question("í•«ìŠ¤íŒŸ(Hotspot) ë¶„ì„ì˜ ëª©ì ì€?",
    answer("í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ê³ ë°œìƒ ì§€ì—­ ì‹ë³„", correct = TRUE),
    answer("ê°€ì¥ ì¸êµ¬ê°€ ë§ì€ ì§€ì—­ ì°¾ê¸°"),
    answer("ì§€ë„ ìƒ‰ìƒ ê²°ì •"),
    answer("ì¢Œí‘œê³„ ë³€í™˜"),
    correct = "ì •ë‹µ! í•«ìŠ¤íŒŸ ë¶„ì„ì€ ìš°ì—°ì´ ì•„ë‹Œ ì‹¤ì œ ê³ ë°œìƒ í´ëŸ¬ìŠ¤í„°ë¥¼ ì°¾ìŠµë‹ˆë‹¤."
  ),

  question("WGS84 ì¢Œí‘œê³„(EPSG:4326)ì˜ íŠ¹ì§•ì€?",
    answer("GPS í‘œì¤€, ê²½ë„/ìœ„ë„ ì‚¬ìš©", correct = TRUE),
    answer("ë¯¸í„° ë‹¨ìœ„ ì‚¬ìš©"),
    answer("í•œêµ­ ì „ìš©"),
    answer("3D ì¢Œí‘œ"),
    correct = "ì •ë‹µ! WGS84ëŠ” ì „ ì„¸ê³„ GPS í‘œì¤€ ì¢Œí‘œê³„ì…ë‹ˆë‹¤."
  )
)
```

---

## ì¢…í•© í€´ì¦ˆ

```{r final-quiz}
quiz(
  question("sf íŒ¨í‚¤ì§€ì—ì„œ ì ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ëŠ”?",
    answer("st_point()", correct = TRUE),
    answer("point()"),
    answer("create_point()"),
    answer("sf_point()"),
    allow_retry = TRUE
  ),
  question("ì¸êµ¬ 10ë§Œëª…ë‹¹ ë°œìƒë¥  ê³„ì‚° ê³µì‹ì€?",
    answer("(cases / population) * 100000", correct = TRUE),
    answer("(cases / population) * 100"),
    answer("cases * population / 100000"),
    answer("(population / cases) * 100000"),
    allow_retry = TRUE
  ),
  question("SIRì´ 80ì´ë©´ ì–´ë–»ê²Œ í•´ì„í•˜ë‚˜ìš”?",
    answer("ì „êµ­ í‰ê· ë³´ë‹¤ 20% ë‚®ì€ ë°œìƒ", correct = TRUE),
    answer("ì „êµ­ í‰ê· ë³´ë‹¤ 80% ë†’ì€ ë°œìƒ"),
    answer("80ëª…ì´ ì‚¬ë§í•¨"),
    answer("ì¸êµ¬ì˜ 80%ê°€ ê°ì—¼ë¨"),
    allow_retry = TRUE
  ),
  question("ì½”ë¡œí”Œë ˆìŠ¤ ë§µ(Choropleth Map)ì´ë€?",
    answer("ì§€ì—­ì„ ìƒ‰ìƒìœ¼ë¡œ ì±„ì›Œ ê°’ì„ í‘œí˜„í•˜ëŠ” ì§€ë„", correct = TRUE),
    answer("ì ìœ¼ë¡œ ìœ„ì¹˜ë¥¼ í‘œì‹œí•˜ëŠ” ì§€ë„"),
    answer("3Dë¡œ ë†’ì´ë¥¼ í‘œí˜„í•˜ëŠ” ì§€ë„"),
    answer("ì‹¤ì‹œê°„ ì´ë™ ê²½ë¡œë¥¼ ë³´ì—¬ì£¼ëŠ” ì§€ë„"),
    allow_retry = TRUE
  )
)
```

---

## í•™ìŠµ ì™„ë£Œ!

### ì´ë²ˆ ê³¼ì •ì—ì„œ ë°°ìš´ ë‚´ìš©:

1. **ê³µê°„ ì—­í•™ì˜ ê¸°ì´ˆ**: ì§ˆë³‘ì˜ ì§€ë¦¬ì  ë¶„í¬ ì—°êµ¬
2. **sf íŒ¨í‚¤ì§€**: Rì—ì„œ ê³µê°„ ë°ì´í„° ë‹¤ë£¨ê¸°
3. **ì  ì§€ë„**: ìœ„ì¹˜ ë°ì´í„° ì‹œê°í™”
4. **ë°œìƒë¥  ê³„ì‚°**: ì¸êµ¬ í‘œì¤€í™”ì˜ ì¤‘ìš”ì„±
5. **SIR (í‘œì¤€í™” ë°œìƒë¹„)**: ê³µì •í•œ ì§€ì—­ ë¹„êµ
6. **ë°œìƒë¥  vs ì¹˜ëª…ë¥ **: ë‹¤ì°¨ì› ë¶„ì„

### ë‹¤ìŒ ë‹¨ê³„:

- **Chapter 5**: ì„ìƒí†µê³„ ì‹œê°í™” (ìƒì¡´ ë¶„ì„, Forest Plot)
- **ì‹¤ìŠµ í”„ë¡œì íŠ¸**: ì‹¤ì œ í•œêµ­ ì§€ë„ ë°ì´í„°ë¡œ ì½”ë¡œí”Œë ˆìŠ¤ ë§µ ì œì‘

### ì¶”ê°€ í•™ìŠµ ìë£Œ:

- [sf íŒ¨í‚¤ì§€ ê³µì‹ ë¬¸ì„œ](https://r-spatial.github.io/sf/)
- [Geocomputation with R](https://geocompr.robinlovelace.net/)
- [êµ­ê°€ê³µê°„ì •ë³´í¬í„¸](http://data.nsdi.go.kr) - í•œêµ­ í–‰ì •êµ¬ì—­ ë°ì´í„°

---

## ğŸ† í•™ìŠµ ê²°ê³¼ í™•ì¸

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 15px; color: white; text-align: center; margin: 20px 0;">

<h3 style="margin: 0 0 20px 0;">ğŸ“Š Part II-2: ê³µê°„ ì—­í•™ ì‹œê°í™”</h3>

<div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
  <div style="background: rgba(255,255,255,0.2); padding: 20px 30px; border-radius: 10px;">
    <p style="margin: 0; font-size: 0.9em;">ì •ë‹µ ìˆ˜</p>
    <p style="margin: 5px 0 0 0; font-size: 2em; font-weight: bold;" id="correct-count">0</p>
  </div>
  <div style="background: rgba(255,255,255,0.2); padding: 20px 30px; border-radius: 10px;">
    <p style="margin: 0; font-size: 0.9em;">ì´ í€´ì¦ˆ</p>
    <p style="margin: 5px 0 0 0; font-size: 2em; font-weight: bold;" id="total-count">0</p>
  </div>
  <div style="background: rgba(255,255,255,0.2); padding: 20px 30px; border-radius: 10px;">
    <p style="margin: 0; font-size: 0.9em;">ì ìˆ˜</p>
    <p style="margin: 5px 0 0 0; font-size: 2em; font-weight: bold;" id="score-percent">0%</p>
  </div>
</div>

<hr style="border-color: rgba(255,255,255,0.3); margin: 20px 0;">
<p style="margin: 0; font-size: 0.9em;">â€» í€´ì¦ˆë¥¼ í’€ë©´ ìë™ìœ¼ë¡œ ì ìˆ˜ê°€ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤</p>
<button onclick="updateScore()" style="margin-top: 15px; padding: 10px 20px; border: none; border-radius: 20px; background: white; color: #667eea; font-weight: bold; cursor: pointer;">ğŸ”„ ì ìˆ˜ ìƒˆë¡œê³ ì¹¨</button>
</div>

<script>
function updateScore() {
  var correct = document.querySelectorAll('.correct').length;
  var incorrect = document.querySelectorAll('.incorrect').length;
  var total = correct + incorrect;

  document.getElementById('correct-count').innerText = correct;
  document.getElementById('total-count').innerText = total;

  var percent = total > 0 ? Math.round((correct / total) * 100) : 0;
  document.getElementById('score-percent').innerText = percent + '%';
}

setInterval(updateScore, 3000);
</script>
