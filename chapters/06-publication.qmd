---
title: "ë…¼ë¬¸ ì¶œíŒ ìˆ˜ì¤€ ì‹œê°í™”"
author: "ì—°ì„¸ëŒ€ ì‚°ì—…ë³´ê±´ ì—°êµ¬ì†Œ"
date: today
---

```{r setup, include=FALSE}
# í•œê¸€ í°íŠ¸ ì„¤ì •
library(showtext)
library(sysfonts)
font_add_google("Noto Sans KR", "noto")
showtext_auto()

library(ggplot2)
theme_set(theme_grey(base_family = "noto"))
showtext_opts(dpi = 96)

knitr::opts_chunk$set(
  fig.showtext = TRUE,
  dev = "png",
  dpi = 96
)
```

# ë…¼ë¬¸ ì¶œíŒ ìˆ˜ì¤€ ì‹œê°í™”

::: {.callout-note}
## ğŸ¯ í•™ìŠµ ëª©í‘œ

ì´ ì±•í„°ë¥¼ ë§ˆì¹˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- **ggrepel**ë¡œ í…ìŠ¤íŠ¸ ë¼ë²¨ ê²¹ì¹¨ ë°©ì§€ ë° ê°€ë…ì„± í–¥ìƒ
- **patchwork**ë¡œ ë‹¤ì¤‘ íŒ¨ë„ Figure ì¡°í•© (A, B, C ë¼ë²¨ë§)
- **ggthemes**ì™€ **ggpubr**ë¡œ í•™ìˆ ì§€ ìŠ¤íƒ€ì¼ ì ìš©
- **ggsave**ë¡œ ê³ í•´ìƒë„ ê·¸ë˜í”„ ì €ì¥ (300+ DPI)
- ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì‚¬ìš©
- Nature, Science, NEJM ë“± ì£¼ìš” í•™ìˆ ì§€ ìš”êµ¬ì‚¬í•­ ì¤€ìˆ˜
- ì¶œíŒ í’ˆì§ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ìµœì¢… ê²€ì¦
:::

::: {.callout-tip}
## ğŸ“š ì´ ì±•í„°ì˜ í•µì‹¬

í•™ìˆ  ë…¼ë¬¸ì´ë‚˜ í•™íšŒ ë°œí‘œë¥¼ ìœ„í•´ì„œëŠ” ë‹¨ìˆœíˆ "ì˜ˆìœ" ê·¸ë˜í”„ê°€ ì•„ë‹Œ, **ì¬í˜„ ê°€ëŠ¥í•˜ê³  ì •í™•í•˜ë©° ì „ë¬¸ì ì¸** ì‹œê°í™”ê°€ í•„ìš”í•©ë‹ˆë‹¤. ì´ ì±•í„°ì—ì„œëŠ” ggplot2ë¥¼ ì¶œíŒ ìˆ˜ì¤€ìœ¼ë¡œ ëŒì–´ì˜¬ë¦¬ëŠ” ê³ ê¸‰ ê¸°ë²•ì„ ë°°ì›ë‹ˆë‹¤.

**í•™ìŠµ ìˆœì„œ:**
1. í…ìŠ¤íŠ¸ ë¼ë²¨ ìµœì í™” (ggrepel)
2. ë‹¤ì¤‘ í”Œë¡¯ ì¡°í•© (patchwork)
3. í•™ìˆ ì§€ ìŠ¤íƒ€ì¼ í…Œë§ˆ (ggthemes, ggpubr)
4. ê³ í•´ìƒë„ ì €ì¥ ë° í¬ë§·
5. ìƒ‰ìƒ ì ‘ê·¼ì„± (colorblind-friendly)
6. ì¶œíŒ ì²´í¬ë¦¬ìŠ¤íŠ¸
:::

## 6.1 í…ìŠ¤íŠ¸ ë¼ë²¨ ìµœì í™”: ggrepel

### 6.1.1 í…ìŠ¤íŠ¸ ë¼ë²¨ ê²¹ì¹¨ ë¬¸ì œ

ë³´ê±´í•™ ì—°êµ¬ì—ì„œ ì‚°ì ë„ë‚˜ volcano plotì— ìœ ì „ì ì´ë¦„, í™˜ì ID, ì§€ì—­ëª… ë“±ì˜ ë¼ë²¨ì„ ì¶”ê°€í•  ë•Œ ê²¹ì¹¨ ë¬¸ì œê°€ ìì£¼ ë°œìƒí•©ë‹ˆë‹¤.

**ë¬¸ì œ ì˜ˆì‹œ: geom_text()ì˜ í•œê³„**

```{r}
#| eval: true
#| echo: true
#| label: fig-text-overlap
#| fig-cap: "geom_text()ì˜ í…ìŠ¤íŠ¸ ê²¹ì¹¨ ë¬¸ì œ"
#| warning: false

library(tidyverse)

# ìƒìœ„ 10ê°œ ì°¨ëŸ‰ë§Œ ë¼ë²¨ë§
mtcars_labeled <- mtcars %>%
  tibble::rownames_to_column("model") %>%
  arrange(desc(mpg)) %>%
  slice(1:10)

# ë¬¸ì œ: ë¼ë²¨ì´ ì„œë¡œ ê²¹ì¹¨
ggplot(mtcars_labeled, aes(x = wt, y = mpg, label = model)) +
  geom_point(color = "steelblue", size = 3) +
  geom_text(size = 3, vjust = -0.5) +  # í…ìŠ¤íŠ¸ê°€ ê²¹ì¹¨!
  labs(
    title = "ì—°ë¹„ ìƒìœ„ 10ê°œ ì°¨ëŸ‰ (geom_text - ê²¹ì¹¨ ë°œìƒ)",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ì—°ë¹„ (mpg)"
  ) +
  theme_minimal(base_size = 12)
```

### 6.1.2 ggrepel íŒ¨í‚¤ì§€ í™œìš©

**ggrepel**ì€ ë¼ë²¨ì´ ì ê³¼ ì„œë¡œ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ìë™ìœ¼ë¡œ ìœ„ì¹˜ë¥¼ ì¡°ì •í•©ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true
#| label: fig-text-repel
#| fig-cap: "ggrepelë¡œ í•´ê²°í•œ í…ìŠ¤íŠ¸ ë°°ì¹˜"
#| warning: false

library(ggrepel)

# í•´ê²°: ë¼ë²¨ì´ ìë™ìœ¼ë¡œ ìœ„ì¹˜ ì¡°ì •
ggplot(mtcars_labeled, aes(x = wt, y = mpg, label = model)) +
  geom_point(color = "steelblue", size = 3) +
  geom_text_repel(
    size = 3,
    box.padding = 0.5,      # ë¼ë²¨ ì£¼ë³€ ì—¬ë°±
    point.padding = 0.3,    # ì  ì£¼ë³€ ì—¬ë°±
    segment.color = "grey50",  # ì—°ê²°ì„  ìƒ‰ìƒ
    max.overlaps = 20       # ìµœëŒ€ ê²¹ì¹¨ í—ˆìš© ìˆ˜
  ) +
  labs(
    title = "ì—°ë¹„ ìƒìœ„ 10ê°œ ì°¨ëŸ‰ (geom_text_repel - ê²¹ì¹¨ ì—†ìŒ)",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ì—°ë¹„ (mpg)"
  ) +
  theme_minimal(base_size = 12)
```

### 6.1.3 ì‹¤ì „ ì˜ˆì œ: Volcano Plot

ì—­í•™ ë° ìœ ì „ì²´ ì—°êµ¬ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” volcano plotì— ìœ ì˜ë¯¸í•œ ìœ ì „ìë§Œ ë¼ë²¨ë§:

```{r}
#| eval: true
#| echo: true
#| label: fig-volcano-plot
#| fig-cap: "Volcano Plot with ggrepel (ìœ ì „ì²´ ì—°êµ¬ ìŠ¤íƒ€ì¼)"
#| warning: false

# ëª¨ì˜ ìœ ì „ì²´ ë°ì´í„° ìƒì„±
set.seed(42)
gene_data <- tibble(
  gene = paste0("Gene", 1:100),
  log2FC = rnorm(100, mean = 0, sd = 1.5),
  pvalue = runif(100, 0, 0.1)
) %>%
  mutate(
    neg_log10p = -log10(pvalue),
    significant = ifelse(abs(log2FC) > 1 & pvalue < 0.05, "Significant", "NS"),
    label = ifelse(abs(log2FC) > 1.5 & pvalue < 0.01, gene, "")
  )

# Volcano plot
ggplot(gene_data, aes(x = log2FC, y = neg_log10p)) +
  geom_point(aes(color = significant), alpha = 0.6, size = 2) +
  geom_hline(yintercept = -log10(0.05), linetype = "dashed", color = "red") +
  geom_vline(xintercept = c(-1, 1), linetype = "dashed", color = "blue") +
  geom_text_repel(
    aes(label = label),
    size = 3,
    max.overlaps = 15,
    box.padding = 0.5
  ) +
  scale_color_manual(values = c("NS" = "gray", "Significant" = "red")) +
  labs(
    title = "Volcano Plot: ìœ ì „ì ë°œí˜„ ì°¨ì´",
    x = "Log2 Fold Change",
    y = "-Log10(P-value)",
    color = "Significance"
  ) +
  theme_classic(base_size = 12) +
  theme(legend.position = "top")
```

::: {.callout-tip}
## ğŸ’¡ ggrepel ì£¼ìš” ì˜µì…˜

| ì˜µì…˜ | ì„¤ëª… | ê¸°ë³¸ê°’ |
|------|------|--------|
| `box.padding` | ë¼ë²¨ ë°•ìŠ¤ ì£¼ë³€ ì—¬ë°± | 0.25 |
| `point.padding` | ì  ì£¼ë³€ ì—¬ë°± | 1e-06 |
| `segment.color` | ì—°ê²°ì„  ìƒ‰ìƒ | "black" |
| `segment.size` | ì—°ê²°ì„  ë‘ê»˜ | 0.5 |
| `max.overlaps` | í—ˆìš© ìµœëŒ€ ê²¹ì¹¨ ìˆ˜ | 10 |
| `min.segment.length` | ìµœì†Œ ì—°ê²°ì„  ê¸¸ì´ | 0.5 |
| `force` | ë°˜ë°œë ¥ ê°•ë„ | 1 |

**ì‹¤ì „ íŒ**: ë¼ë²¨ì´ ë§ì„ ë•ŒëŠ” `max.overlaps`ë¥¼ ëŠ˜ë¦¬ê³ , `force`ë¥¼ ì¡°ì •í•˜ì—¬ ë°°ì¹˜ë¥¼ ìµœì í™”í•˜ì„¸ìš”.
:::

## 6.2 ë‹¤ì¤‘ í”Œë¡¯ ì¡°í•©: patchwork

### 6.2.1 ì™œ patchworkì¸ê°€?

í•™ìˆ  ë…¼ë¬¸ì—ì„œëŠ” ì—¬ëŸ¬ ê·¸ë˜í”„ë¥¼ í•˜ë‚˜ì˜ Figureë¡œ ì¡°í•©í•´ì•¼ í•©ë‹ˆë‹¤ (e.g., Figure 1A, 1B, 1C). **patchwork** íŒ¨í‚¤ì§€ëŠ” ì§ê´€ì ì¸ ì—°ì‚°ìë¡œ ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤:

- `+`: ë‚˜ë€íˆ ë˜ëŠ” ìˆœì„œëŒ€ë¡œ ë°°ì¹˜
- `|`: ì˜†ìœ¼ë¡œ ë‚˜ë€íˆ
- `/`: ìœ„ì•„ë˜ë¡œ ìŒ“ê¸°
- `()`: ê·¸ë£¹í™”

**ê¸°ì¡´ ë°©ë²• (gridExtra, cowplot)ì˜ ë¬¸ì œì :**
- ë³µì¡í•œ ë¬¸ë²•
- ì¶• ì •ë ¬ ì–´ë ¤ì›€
- ë¼ë²¨ë§ ë¶ˆí¸

**patchworkì˜ ì¥ì :**
- ê°„ê²°í•œ ë¬¸ë²• (`|`, `/` ì—°ì‚°ì)
- ìë™ ì¶• ì •ë ¬
- ìë™ Figure ë¼ë²¨ (A, B, C)

### 6.2.2 ê¸°ë³¸ ì‚¬ìš©ë²•

```{r}
#| eval: true
#| echo: true
#| label: fig-patchwork-basic
#| fig-cap: "patchworkë¡œ ì¡°í•©í•œ ë‹¤ì¤‘ íŒ¨ë„ Figure"
#| fig-width: 10
#| fig-height: 4
#| warning: false

library(patchwork)

# 3ê°œì˜ ë…ë¦½ì ì¸ í”Œë¡¯ ìƒì„±
p1 <- ggplot(mtcars, aes(x = mpg, y = disp)) +
  geom_point(color = "steelblue") +
  geom_smooth(method = "lm", se = FALSE, color = "red") +
  labs(title = "ì—°ë¹„ vs. ë°°ê¸°ëŸ‰", x = "MPG", y = "Displacement") +
  theme_bw()

p2 <- ggplot(mtcars, aes(x = factor(cyl), y = mpg, fill = factor(cyl))) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "ì‹¤ë¦°ë”ë³„ ì—°ë¹„", x = "Cylinders", y = "MPG") +
  theme_bw()

p3 <- ggplot(mtcars, aes(x = hp)) +
  geom_histogram(bins = 15, fill = "coral", color = "black") +
  labs(title = "ë§ˆë ¥ ë¶„í¬", x = "Horsepower", y = "Count") +
  theme_bw()

# ì¡°í•©: p1ê³¼ p2ë¥¼ ë‚˜ë€íˆ, ê·¸ ì•„ë˜ p3
(p1 | p2) / p3 +
  plot_annotation(
    title = "ìë™ì°¨ ì„±ëŠ¥ ë¶„ì„ ì¢…í•©",
    tag_levels = "A",  # A, B, C ìë™ ë¼ë²¨
    theme = theme(plot.title = element_text(size = 14, face = "bold"))
  )
```

### 6.2.3 ê³ ê¸‰ ë ˆì´ì•„ì›ƒ

**ì˜ˆì œ 1: ë³µì¡í•œ ë ˆì´ì•„ì›ƒ**

```{r}
#| eval: true
#| echo: true
#| label: fig-patchwork-advanced
#| fig-cap: "ë³µì¡í•œ ë ˆì´ì•„ì›ƒ ì˜ˆì œ"
#| fig-width: 10
#| fig-height: 8
#| warning: false

# ë³´ê±´í•™ ë°ì´í„° ì‹œë®¬ë ˆì´ì…˜
set.seed(123)
health_sim <- tibble(
  age = rnorm(200, mean = 45, sd = 15),
  bmi = rnorm(200, mean = 25, sd = 4),
  sbp = rnorm(200, mean = 130, sd = 20),
  gender = sample(c("M", "F"), 200, replace = TRUE)
)

# 4ê°œ í”Œë¡¯ ìƒì„±
p_age_bmi <- ggplot(health_sim, aes(x = age, y = bmi, color = gender)) +
  geom_point(alpha = 0.6) +
  labs(title = "ë‚˜ì´ì™€ BMI", x = "Age", y = "BMI") +
  theme_minimal()

p_age_sbp <- ggplot(health_sim, aes(x = age, y = sbp, color = gender)) +
  geom_point(alpha = 0.6) +
  labs(title = "ë‚˜ì´ì™€ í˜ˆì••", x = "Age", y = "SBP (mmHg)") +
  theme_minimal()

p_bmi_dist <- ggplot(health_sim, aes(x = bmi, fill = gender)) +
  geom_density(alpha = 0.5) +
  labs(title = "BMI ë¶„í¬", x = "BMI", y = "Density") +
  theme_minimal()

p_sbp_box <- ggplot(health_sim, aes(x = gender, y = sbp, fill = gender)) +
  geom_boxplot(show.legend = FALSE) +
  labs(title = "ì„±ë³„ í˜ˆì••", x = "Gender", y = "SBP (mmHg)") +
  theme_minimal()

# ë ˆì´ì•„ì›ƒ: 2x2 ê·¸ë¦¬ë“œ
(p_age_bmi | p_age_sbp) / (p_bmi_dist | p_sbp_box) +
  plot_annotation(
    title = "ê±´ê°•ê²€ì§„ ë°ì´í„° ì¢…í•© ë¶„ì„",
    tag_levels = "A",
    tag_suffix = ")",
    theme = theme(plot.title = element_text(size = 16, face = "bold", hjust = 0.5))
  )
```

**ì˜ˆì œ 2: ë¶ˆê· ë“± ë°°ì¹˜ (í•œ í”Œë¡¯ì´ 2ì—´ ì°¨ì§€)**

```{r}
#| eval: true
#| echo: true
#| label: fig-patchwork-unequal
#| fig-cap: "ë¶ˆê· ë“± íŒ¨ë„ ë°°ì¹˜"
#| fig-width: 10
#| fig-height: 6
#| warning: false

# í”Œë¡¯ ìƒì„±
p_main <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point(size = 2) +
  labs(title = "ë¶“ê½ƒ ê½ƒë°›ì¹¨ í¬ê¸°", x = "Sepal Length", y = "Sepal Width") +
  theme_bw()

p_hist_x <- ggplot(iris, aes(x = Sepal.Length, fill = Species)) +
  geom_histogram(bins = 20, alpha = 0.7) +
  labs(title = "Sepal Length ë¶„í¬") +
  theme_bw() +
  theme(legend.position = "none")

p_hist_y <- ggplot(iris, aes(x = Sepal.Width, fill = Species)) +
  geom_histogram(bins = 20, alpha = 0.7) +
  labs(title = "Sepal Width ë¶„í¬") +
  theme_bw() +
  theme(legend.position = "none")

# ë ˆì´ì•„ì›ƒ: p_mainì´ ë” í° ê³µê°„ ì°¨ì§€
p_main / (p_hist_x | p_hist_y) +
  plot_layout(heights = c(2, 1)) +  # ë†’ì´ ë¹„ìœ¨ 2:1
  plot_annotation(tag_levels = "A")
```

::: {.callout-tip}
## ğŸ’¡ patchwork ì£¼ìš” í•¨ìˆ˜

| í•¨ìˆ˜ | ê¸°ëŠ¥ | ì˜ˆì‹œ |
|------|------|------|
| `plot_annotation()` | ì „ì²´ ì œëª©, ë¼ë²¨ ì¶”ê°€ | `tag_levels = "A"` |
| `plot_layout()` | ë°°ì¹˜ ì„¤ì • | `ncol = 2, heights = c(2, 1)` |
| `&` | ëª¨ë“  í”Œë¡¯ì— í…Œë§ˆ ì¼ê´„ ì ìš© | `(p1 | p2) & theme_bw()` |
| `*` | ì¤‘ì²© ë°°ì¹˜ | `p1 + inset_element(p2, ...)` |

**tag_levels ì˜µì…˜:**
- `"A"`: A, B, C (ëŒ€ë¬¸ì)
- `"a"`: a, b, c (ì†Œë¬¸ì)
- `"1"`: 1, 2, 3 (ìˆ«ì)
- `"I"`: I, II, III (ë¡œë§ˆ ìˆ«ì)
:::

## 6.3 í•™ìˆ ì§€ ìŠ¤íƒ€ì¼: ggthemes & ggpubr

### 6.3.1 ggplot2 ë‚´ì¥ í…Œë§ˆ

ggplot2ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ 8ê°€ì§€ í…Œë§ˆë¥¼ ì œê³µí•©ë‹ˆë‹¤:

```{r}
#| eval: true
#| echo: true
#| label: fig-builtin-themes
#| fig-cap: "ggplot2 ë‚´ì¥ í…Œë§ˆ ë¹„êµ"
#| fig-width: 10
#| fig-height: 10
#| warning: false

library(patchwork)

# ê¸°ë³¸ í”Œë¡¯
base_plot <- ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point(color = "steelblue", size = 2) +
  labs(title = "í…Œë§ˆë³„ ë¹„êµ", x = "Weight", y = "MPG")

# 8ê°€ì§€ í…Œë§ˆ ì ìš©
p_gray <- base_plot + theme_gray() + labs(subtitle = "theme_gray() [ê¸°ë³¸ê°’]")
p_bw <- base_plot + theme_bw() + labs(subtitle = "theme_bw()")
p_minimal <- base_plot + theme_minimal() + labs(subtitle = "theme_minimal()")
p_classic <- base_plot + theme_classic() + labs(subtitle = "theme_classic()")
p_light <- base_plot + theme_light() + labs(subtitle = "theme_light()")
p_dark <- base_plot + theme_dark() + labs(subtitle = "theme_dark()")
p_void <- base_plot + theme_void() + labs(subtitle = "theme_void()")
p_linedraw <- base_plot + theme_linedraw() + labs(subtitle = "theme_linedraw()")

# ì¡°í•©
(p_gray | p_bw | p_minimal | p_classic) /
(p_light | p_dark | p_void | p_linedraw) +
  plot_annotation(
    title = "ggplot2 ë‚´ì¥ í…Œë§ˆ 8ì¢…",
    theme = theme(plot.title = element_text(size = 16, face = "bold"))
  )
```

**í•™ìˆ ì§€ë³„ ì¶”ì²œ í…Œë§ˆ:**

| í•™ìˆ ì§€ | ì¶”ì²œ í…Œë§ˆ | íŠ¹ì§• |
|--------|-----------|------|
| **Nature, Science** | `theme_classic()` | ì¶•ë§Œ í‘œì‹œ, ê²©ì ì—†ìŒ |
| **NEJM, Lancet** | `theme_bw()` | í°ìƒ‰ ë°°ê²½, ê²€ì€ í…Œë‘ë¦¬ |
| **PLOS ONE** | `theme_minimal()` | ìµœì†Œí•œì˜ ìš”ì†Œ |
| **í”„ë ˆì  í…Œì´ì…˜** | `theme_minimal()` | ê¹”ë”í•˜ê³  ê°€ë…ì„± ë†’ìŒ |

### 6.3.2 ggthemes íŒ¨í‚¤ì§€

**ggthemes**ëŠ” Economist, Wall Street Journal ë“± ìœ ëª… ì¶œíŒë¬¼ì˜ ìŠ¤íƒ€ì¼ì„ ì œê³µí•©ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true
#| label: fig-ggthemes
#| fig-cap: "ggthemes íŒ¨í‚¤ì§€ ìŠ¤íƒ€ì¼"
#| fig-width: 10
#| fig-height: 6
#| warning: false

library(ggthemes)

base_plot <- ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +
  geom_point(size = 3) +
  labs(x = "Weight (1000 lbs)", y = "MPG", color = "Cylinders")

p_economist <- base_plot +
  theme_economist() +
  scale_color_economist() +
  labs(title = "The Economist Style")

p_wsj <- base_plot +
  theme_wsj() +
  scale_color_wsj() +
  labs(title = "Wall Street Journal Style") +
  theme(axis.title = element_text())  # WSJì€ ê¸°ë³¸ì ìœ¼ë¡œ ì¶• ì œëª© ì—†ìŒ

p_fivethirtyeight <- base_plot +
  theme_fivethirtyeight() +
  scale_color_fivethirtyeight() +
  labs(title = "FiveThirtyEight Style")

p_colorblind <- base_plot +
  theme_minimal() +
  scale_color_colorblind() +
  labs(title = "Color-blind Safe Palette")

(p_economist | p_wsj) / (p_fivethirtyeight | p_colorblind) +
  plot_annotation(
    title = "ggthemes ìŠ¤íƒ€ì¼ ì˜ˆì œ",
    theme = theme(plot.title = element_text(size = 16, face = "bold"))
  )
```

### 6.3.3 ggpubr: í†µê³„ì  ë¹„êµ

**ggpubr**ëŠ” p-valueì™€ ìœ ì˜ì„± í‘œì‹œë¥¼ ìë™í™”í•©ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true
#| label: fig-ggpubr-stats
#| fig-cap: "ggpubrë¡œ í†µê³„ ì •ë³´ ì¶”ê°€"
#| fig-width: 8
#| fig-height: 6
#| warning: false

library(ggpubr)

# ToothGrowth ë°ì´í„°: ë¹„íƒ€ë¯¼ C íˆ¬ì—¬ëŸ‰ì— ë”°ë¥¸ ì¹˜ì•„ ì„±ì¥
ggboxplot(
  ToothGrowth,
  x = "dose",
  y = "len",
  fill = "dose",
  palette = "jco",  # Journal of Clinical Oncology ìƒ‰ìƒ
  add = "jitter",   # ê°œë³„ ì  ì¶”ê°€
  add.params = list(size = 0.5, alpha = 0.5)
) +
  stat_compare_means(
    comparisons = list(c("0.5", "1"), c("1", "2"), c("0.5", "2")),
    label = "p.signif",  # *, **, *** í‘œì‹œ
    method = "t.test"
  ) +
  stat_compare_means(label.y = 35, method = "anova") +  # ì „ì²´ ANOVA
  labs(
    title = "ë¹„íƒ€ë¯¼ C íˆ¬ì—¬ëŸ‰ì— ë”°ë¥¸ ì¹˜ì•„ ì„±ì¥",
    subtitle = "Guinea Pigs (N=60)",
    x = "Dose (mg/day)",
    y = "Tooth Length",
    caption = "ë°ì´í„°: ToothGrowth (R ë‚´ì¥)"
  ) +
  theme_pubr()
```

**ggpubrì˜ ì£¼ìš” í•¨ìˆ˜:**

```{r}
#| eval: false
#| echo: true

# ê·¸ë£¹ ê°„ ë¹„êµ
stat_compare_means(
  comparisons = list(c("group1", "group2"), c("group2", "group3")),
  method = "t.test",        # ë˜ëŠ” "wilcox.test", "anova"
  label = "p.signif"        # ë˜ëŠ” "p.format" (ìˆ«ì)
)

# ìƒê´€ê´€ê³„ í‘œì‹œ
stat_cor(
  aes(label = paste(after_stat(rr.label), after_stat(p.label), sep = "~`,`~")),
  method = "pearson"
)
```

## 6.4 ìƒ‰ìƒ ì ‘ê·¼ì„±: ìƒ‰ë§¹ ì¹œí™”ì  íŒ”ë ˆíŠ¸

ì „ ì„¸ê³„ ë‚¨ì„±ì˜ ì•½ **8%**, ì—¬ì„±ì˜ **0.5%**ê°€ ìƒ‰ë§¹ì…ë‹ˆë‹¤. í•™ìˆ  ì¶œíŒì—ì„œëŠ” ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

### 6.4.1 Viridis ìƒ‰ìƒ íŒ”ë ˆíŠ¸

**Viridis**ëŠ” ìƒ‰ë§¹ ì¹œí™”ì ì´ë©°, í‘ë°± ì¸ì‡„ì—ì„œë„ êµ¬ë³„ ê°€ëŠ¥í•©ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true
#| label: fig-viridis
#| fig-cap: "Viridis ìƒ‰ìƒ íŒ”ë ˆíŠ¸ (ìƒ‰ë§¹ ì¹œí™”ì )"
#| fig-width: 10
#| fig-height: 8
#| warning: false

library(viridis)

# ê¸°ë³¸ í”Œë¡¯
base_plot <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Petal.Length)) +
  geom_point(size = 3) +
  labs(x = "Sepal Length", y = "Sepal Width", color = "Petal Length")

# 5ê°€ì§€ Viridis ì˜µì…˜
p_viridis <- base_plot + scale_color_viridis_c(option = "viridis") + labs(title = "viridis (default)")
p_magma <- base_plot + scale_color_viridis_c(option = "magma") + labs(title = "magma")
p_plasma <- base_plot + scale_color_viridis_c(option = "plasma") + labs(title = "plasma")
p_inferno <- base_plot + scale_color_viridis_c(option = "inferno") + labs(title = "inferno")
p_cividis <- base_plot + scale_color_viridis_c(option = "cividis") + labs(title = "cividis (ìµœëŒ€ ì ‘ê·¼ì„±)")
p_rocket <- base_plot + scale_color_viridis_c(option = "rocket") + labs(title = "rocket")

(p_viridis | p_magma | p_plasma) / (p_inferno | p_cividis | p_rocket) +
  plot_annotation(
    title = "Viridis ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ì˜µì…˜",
    subtitle = "ëª¨ë“  ì˜µì…˜ì´ ìƒ‰ë§¹ ì¹œí™”ì ì´ë©° í‘ë°± ì¸ì‡„ ê°€ëŠ¥",
    theme = theme(plot.title = element_text(size = 14, face = "bold"))
  )
```

### 6.4.2 ë²”ì£¼í˜• ë°ì´í„°: ColorBrewer

**ColorBrewer**ëŠ” ì§€ë„í•™ì—ì„œ ê°œë°œëœ ìƒ‰ìƒ íŒ”ë ˆíŠ¸ë¡œ, ìƒ‰ë§¹ ì¹œí™”ì„±ì´ ê²€ì¦ë˜ì—ˆìŠµë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true
#| label: fig-colorbrewer
#| fig-cap: "ColorBrewer íŒ”ë ˆíŠ¸"
#| fig-width: 10
#| fig-height: 6
#| warning: false

library(RColorBrewer)

base_plot <- ggplot(iris, aes(x = Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point(size = 3) +
  labs(x = "Sepal Length", y = "Sepal Width")

p_set1 <- base_plot + scale_color_brewer(palette = "Set1") + labs(title = "Set1")
p_set2 <- base_plot + scale_color_brewer(palette = "Set2") + labs(title = "Set2")
p_dark2 <- base_plot + scale_color_brewer(palette = "Dark2") + labs(title = "Dark2")
p_paired <- base_plot + scale_color_brewer(palette = "Paired") + labs(title = "Paired")

(p_set1 | p_set2) / (p_dark2 | p_paired) +
  plot_annotation(
    title = "ColorBrewer íŒ”ë ˆíŠ¸ (ë²”ì£¼í˜• ë°ì´í„°ìš©)",
    theme = theme(plot.title = element_text(size = 14, face = "bold"))
  )
```

::: {.callout-warning}
## âš ï¸ í”¼í•´ì•¼ í•  ìƒ‰ìƒ ì¡°í•©

**ë¹¨ê°•-ì´ˆë¡ ì¡°í•©**: ê°€ì¥ í”í•œ ìƒ‰ë§¹ ìœ í˜•(ì ë¡ìƒ‰ë§¹)ì—ì„œ êµ¬ë³„ ë¶ˆê°€

```r
# âŒ í”¼í•˜ì„¸ìš”
scale_color_manual(values = c("red", "green"))

# âœ… ëŒ€ì‹  ì‚¬ìš©í•˜ì„¸ìš”
scale_color_viridis_d()
scale_color_brewer(palette = "Set2")
scale_color_colorblind()  # ggthemes
```

**ì˜¨ë¼ì¸ ë„êµ¬**:
- [Color Oracle](https://colororacle.org/): ìƒ‰ë§¹ ì‹œë®¬ë ˆì´í„°
- [ColorBrewer](https://colorbrewer2.org/): íŒ”ë ˆíŠ¸ ì„ íƒ ë„êµ¬
:::

## 6.5 ê³ í•´ìƒë„ ì €ì¥: ggsave

### 6.5.1 ê¸°ë³¸ ì‚¬ìš©ë²•

```{r}
#| eval: false
#| echo: true

# í”Œë¡¯ ìƒì„±
p <- ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point() +
  theme_classic()

# ì €ì¥
ggsave(
  filename = "figure1.png",
  plot = p,
  width = 8,           # ë„ˆë¹„ (inch)
  height = 6,          # ë†’ì´ (inch)
  dpi = 300,           # í•´ìƒë„ (dots per inch)
  units = "in"         # ë‹¨ìœ„: "in", "cm", "mm"
)
```

### 6.5.2 í•™ìˆ ì§€ë³„ ê¶Œì¥ ì„¤ì •

| í•™ìˆ ì§€ | í•´ìƒë„ (DPI) | íŒŒì¼ í˜•ì‹ | ìµœì†Œ ê¸€ê¼´ í¬ê¸° | ê¶Œì¥ ë„ˆë¹„ |
|--------|--------------|-----------|----------------|-----------|
| **Nature** | 300-600 | PDF, EPS, TIFF | 5-7 pt | Single column: 89 mm<br>Double column: 183 mm |
| **Science** | 300+ | PDF, EPS, TIFF | 6-8 pt | Single: 5.5 cm<br>Double: 12 cm |
| **NEJM** | 300-600 | EPS, TIFF | 7-9 pt | Single: 3.25 in<br>Double: 6.75 in |
| **PLOS ONE** | 300+ | TIFF, EPS | 8-12 pt | Max width: 17.35 cm |
| **BMJ** | 300+ | TIFF, EPS, PDF | 7-9 pt | Single: 8 cm<br>Double: 17 cm |

**ì‹¤ì „ ì˜ˆì œ:**

```{r}
#| eval: false
#| echo: true

# Nature ìŠ¤íƒ€ì¼ (single column)
ggsave(
  filename = "nature_figure1.pdf",
  plot = p,
  width = 89,
  height = 89,
  units = "mm",
  dpi = 600,
  device = cairo_pdf  # ë²¡í„° í˜•ì‹, ê³ í’ˆì§ˆ
)

# NEJM ìŠ¤íƒ€ì¼ (double column)
ggsave(
  filename = "nejm_figure1.tiff",
  plot = p,
  width = 6.75,
  height = 5,
  units = "in",
  dpi = 300,
  compression = "lzw"  # TIFF ì••ì¶•
)

# í”„ë ˆì  í…Œì´ì…˜ìš© (ê³ í•´ìƒë„ PNG)
ggsave(
  filename = "presentation_figure1.png",
  plot = p,
  width = 10,
  height = 6,
  units = "in",
  dpi = 300,
  bg = "white"  # ë°°ê²½ í°ìƒ‰
)
```

### 6.5.3 ë²¡í„° vs. ë˜ìŠ¤í„° í˜•ì‹

**ë²¡í„° í˜•ì‹ (í™•ëŒ€í•´ë„ ì„ ëª…)**:
- **PDF**: ë²”ìš©, í¸ì§‘ ê°€ëŠ¥
- **EPS**: PostScript, ì „í†µì  ì¶œíŒ
- **SVG**: ì›¹ìš©, ì¸í„°ë™í‹°ë¸Œ

**ë˜ìŠ¤í„° í˜•ì‹ (í”½ì…€ ê¸°ë°˜)**:
- **PNG**: ì›¹, í”„ë ˆì  í…Œì´ì…˜ (íˆ¬ëª… ë°°ê²½ ì§€ì›)
- **TIFF**: ê³ í’ˆì§ˆ ì¸ì‡„ (ì••ì¶• ì˜µì…˜)
- **JPEG**: ì‚¬ì§„ìš© (ì†ì‹¤ ì••ì¶•)

::: {.callout-tip}
## ğŸ’¡ í¬ë§· ì„ íƒ ê°€ì´ë“œ

**í•™ìˆ  ë…¼ë¬¸ ì œì¶œìš©**:
1. **1ìˆœìœ„**: PDF (ë²¡í„°) - í¸ì§‘ ê°€ëŠ¥, í™•ëŒ€ ì‹œ ì„ ëª…
2. **2ìˆœìœ„**: TIFF (300+ DPI) - ê³ í’ˆì§ˆ ë˜ìŠ¤í„°
3. **3ìˆœìœ„**: EPS (ë²¡í„°) - ë ˆê±°ì‹œ ì‹œìŠ¤í…œ

**í”„ë ˆì  í…Œì´ì…˜ìš©**:
- PNG (300 DPI) - íˆ¬ëª… ë°°ê²½ ì§€ì›, íŒŒì›Œí¬ì¸íŠ¸ í˜¸í™˜

**ì›¹ ê²Œì‹œìš©**:
- PNG (150 DPI) - ë¹ ë¥¸ ë¡œë”©
- SVG - ì¸í„°ë™í‹°ë¸Œ ìš”ì†Œ
:::

## 6.6 íƒ€ì´í¬ê·¸ë˜í”¼ì™€ ê¸€ê¼´

### 6.6.1 ê¸€ê¼´ í¬ê¸° ì„¤ì •

```{r}
#| eval: true
#| echo: true
#| label: fig-typography
#| fig-cap: "íƒ€ì´í¬ê·¸ë˜í”¼ ì˜ˆì œ"
#| fig-width: 8
#| fig-height: 6
#| warning: false

ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point(size = 3, color = "steelblue") +
  labs(
    title = "ìë™ì°¨ ë¬´ê²Œì™€ ì—°ë¹„ì˜ ê´€ê³„",
    subtitle = "ë¯¸êµ­ ìë™ì°¨ 32ì¢… (1973-74 ëª¨ë¸)",
    x = "ë¬´ê²Œ (1000 lbs)",
    y = "ì—°ë¹„ (miles per gallon)",
    caption = "ë°ì´í„°: mtcars | ë¶„ì„: ì—°ì„¸ëŒ€ ì‚°ì—…ë³´ê±´ ì—°êµ¬ì†Œ"
  ) +
  theme_classic(base_size = 14) +  # ê¸°ë³¸ ê¸€ê¼´ í¬ê¸°
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0),
    plot.subtitle = element_text(size = 12, color = "gray40", hjust = 0),
    axis.title = element_text(size = 12, face = "bold"),
    axis.text = element_text(size = 10),
    plot.caption = element_text(size = 9, color = "gray50", hjust = 1)
  )
```

**ê¸€ê¼´ í¬ê¸° ê¶Œì¥ì‚¬í•­:**

| ìš”ì†Œ | ê¶Œì¥ í¬ê¸° | ë¹„ê³  |
|------|-----------|------|
| **ì œëª©** | 14-18 pt | êµµê²Œ (bold) |
| **ë¶€ì œëª©** | 12-14 pt | ë³´í†µ (plain) |
| **ì¶• ì œëª©** | 11-13 pt | êµµê²Œ ë˜ëŠ” ë³´í†µ |
| **ì¶• ëˆˆê¸ˆ** | 9-11 pt | ë³´í†µ |
| **ë²”ë¡€** | 10-12 pt | ë³´í†µ |
| **ìº¡ì…˜** | 8-10 pt | íšŒìƒ‰ |

### 6.6.2 í•œê¸€ í°íŠ¸ ì„¤ì • (showtext)

Windowsì—ì„œ í•œê¸€ì´ ê¹¨ì§ˆ ë•Œ `showtext` íŒ¨í‚¤ì§€ ì‚¬ìš©:

```{r}
#| eval: false
#| echo: true

library(showtext)

# Google Fontsì—ì„œ Noto Sans KR ë‹¤ìš´ë¡œë“œ
font_add_google("Noto Sans KR", "notosanskr")
showtext_auto()

# í•œê¸€ í°íŠ¸ ì ìš©
ggplot(mtcars, aes(x = wt, y = mpg)) +
  geom_point() +
  labs(title = "ìë™ì°¨ ë¬´ê²Œì™€ ì—°ë¹„", x = "ë¬´ê²Œ", y = "ì—°ë¹„") +
  theme_minimal(base_family = "notosanskr", base_size = 14)
```

## 6.7 ì¶œíŒ í’ˆì§ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

::: {.callout-important icon="true"}
## âœ… í•™ìˆ ì§€ ì œì¶œ ì „ í•„ìˆ˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

**1. ë°ì´í„° ì •í™•ì„±**
- [ ] ëª¨ë“  ìˆ˜ì¹˜ê°€ ì˜¬ë°”ë¥¸ê°€?
- [ ] í†µê³„ ê²€ì •ì´ ì •í™•í•˜ê²Œ ìˆ˜í–‰ë˜ì—ˆëŠ”ê°€?
- [ ] ì—ëŸ¬ë°”ê°€ SEì¸ì§€ CIì¸ì§€ ëª…ì‹œí–ˆëŠ”ê°€?
- [ ] N ìˆ˜ë¥¼ ëª…ì‹œí–ˆëŠ”ê°€?

**2. ì‹œê°ì  ìš”ì†Œ**
- [ ] ëª¨ë“  ì¶•ì— **ëª…í™•í•œ ë ˆì´ë¸”ê³¼ ë‹¨ìœ„** í‘œì‹œ
- [ ] ê¸€ê¼´ í¬ê¸° ì ì ˆ (ìµœì†Œ 7pt ì´ìƒ)
- [ ] ìƒ‰ìƒì´ ìƒ‰ë§¹ ì¹œí™”ì ì¸ê°€? (Viridis, ColorBrewer)
- [ ] ë²”ë¡€ê°€ ëª…í™•í•˜ê³  ìœ„ì¹˜ê°€ ì ì ˆí•œê°€?
- [ ] ê·¸ë¦¬ë“œë¼ì¸ì´ ë„ˆë¬´ ë§ì§€ ì•Šì€ê°€?

**3. í•´ìƒë„ ë° í¬ë§·**
- [ ] í•´ìƒë„ **â‰¥ 300 DPI** (í•™ìˆ ì§€ ìš”êµ¬ì‚¬í•­ í™•ì¸)
- [ ] íŒŒì¼ í˜•ì‹: PDF (ë²¡í„°) ë˜ëŠ” TIFF (ë˜ìŠ¤í„°)
- [ ] íŒŒì¼ í¬ê¸° < 10 MB (í•™ìˆ ì§€ ì œí•œ í™•ì¸)
- [ ] ê·¸ë¦¼ í¬ê¸°ê°€ í•™ìˆ ì§€ ê·œì • ì¤€ìˆ˜ (single/double column)

**4. í…ìŠ¤íŠ¸ ë° ë¼ë²¨**
- [ ] ëª¨ë“  í…ìŠ¤íŠ¸ê°€ ì½ê¸° ì‰¬ìš´ê°€?
- [ ] ë¼ë²¨ì´ ê²¹ì¹˜ì§€ ì•ŠëŠ”ê°€? (ggrepel ì‚¬ìš©)
- [ ] Figure ìº¡ì…˜ì´ ì™„ì „í•˜ê³  ìì„¸í•œê°€?
- [ ] í†µê³„ ì •ë³´ ëª…ì‹œ (p-value, CI, SE)

**5. ì¼ê´€ì„±**
- [ ] ê°™ì€ ë…¼ë¬¸ ë‚´ ëª¨ë“  ê·¸ë˜í”„ê°€ ë™ì¼í•œ í…Œë§ˆ ì‚¬ìš©
- [ ] ìƒ‰ìƒ íŒ”ë ˆíŠ¸ê°€ ì¼ê´€ì ì¸ê°€?
- [ ] ê¸€ê¼´ê³¼ í¬ê¸°ê°€ ì¼ê´€ì ì¸ê°€?

**6. ì ‘ê·¼ì„±**
- [ ] ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ ì‚¬ìš©
- [ ] í‘ë°± ì¸ì‡„ ì‹œì—ë„ êµ¬ë³„ ê°€ëŠ¥í•œê°€?
- [ ] ì ì„ , ëª¨ì–‘ ë“±ìœ¼ë¡œ ì¶”ê°€ êµ¬ë³„ ì œê³µ

**7. ìœ¤ë¦¬ ë° íˆ¬ëª…ì„±**
- [ ] ë°ì´í„° ì¶œì²˜ ëª…ì‹œ
- [ ] í†µê³„ ë°©ë²• ëª…ì‹œ
- [ ] ë°ì´í„° ì¡°ì‘ ì—†ìŒ (yì¶• ë²”ìœ„ ì¡°ì‘ ë“±)
:::

## 6.8 ì‹¤ì „ ì˜ˆì œ: ë…¼ë¬¸ìš© Figure ì™„ì„±í•˜ê¸°

### 6.8.1 Before & After ë¹„êµ

**Before (ê¸°ë³¸ ggplot2):**

```{r}
#| eval: true
#| echo: true
#| label: fig-before
#| fig-cap: "ì¶œíŒ ì „ ê¸°ë³¸ ê·¸ë˜í”„"
#| fig-width: 7
#| fig-height: 5
#| warning: false

# ê°„ë‹¨í•œ ì‚°ì ë„ (ê°œì„  ì „)
ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +
  geom_point() +
  geom_smooth(method = "lm")
```

**After (ì¶œíŒ í’ˆì§ˆ):**

```{r}
#| eval: true
#| echo: true
#| label: fig-after
#| fig-cap: "ì¶œíŒ í’ˆì§ˆ ì™„ì„±ë³¸"
#| fig-width: 8
#| fig-height: 6
#| warning: false

library(tidyverse)
library(ggrepel)

# ìƒìœ„ 5ê°œ ì°¨ëŸ‰ë§Œ ë¼ë²¨ë§
mtcars_top <- mtcars %>%
  tibble::rownames_to_column("model") %>%
  arrange(desc(mpg)) %>%
  slice(1:5)

ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl), shape = factor(cyl))) +
  geom_point(size = 3, alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.8) +
  geom_text_repel(
    data = mtcars_top,
    aes(label = model),
    size = 3,
    max.overlaps = 10,
    box.padding = 0.5
  ) +
  scale_color_viridis_d(
    option = "plasma",
    name = "Cylinders",
    labels = c("4 cyl", "6 cyl", "8 cyl")
  ) +
  scale_shape_manual(
    values = c(16, 17, 15),
    name = "Cylinders",
    labels = c("4 cyl", "6 cyl", "8 cyl")
  ) +
  labs(
    title = "Relationship Between Vehicle Weight and Fuel Efficiency",
    subtitle = "US automobiles (1973-74 models, n=32)",
    x = "Weight (1000 lbs)",
    y = "Fuel Efficiency (miles per gallon)",
    caption = "Data: Henderson and Velleman (1981) | Linear regression lines with 95% CI"
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0),
    plot.subtitle = element_text(size = 11, color = "gray40", hjust = 0),
    axis.title = element_text(size = 11, face = "bold"),
    axis.text = element_text(size = 10),
    legend.position = c(0.85, 0.8),
    legend.background = element_rect(fill = "white", color = "black", linewidth = 0.3),
    legend.title = element_text(size = 10, face = "bold"),
    legend.text = element_text(size = 9),
    plot.caption = element_text(size = 8, color = "gray50", hjust = 0),
    panel.grid.major = element_line(color = "gray90", linewidth = 0.3)
  )
```

### 6.8.2 ì¢…í•© ì˜ˆì œ: ë‹¤ì¤‘ íŒ¨ë„ Figure

```{r}
#| eval: true
#| echo: true
#| label: fig-comprehensive
#| fig-cap: "ì¶œíŒ í’ˆì§ˆ ë‹¤ì¤‘ íŒ¨ë„ Figure (Nature ìŠ¤íƒ€ì¼)"
#| fig-width: 12
#| fig-height: 8
#| warning: false

library(tidyverse)
library(patchwork)
library(ggrepel)
library(viridis)
library(ggpubr)

# ë°ì´í„° ì¤€ë¹„
set.seed(42)
clinical_data <- tibble(
  patient_id = 1:100,
  age = rnorm(100, mean = 55, sd = 15),
  treatment = sample(c("Control", "Drug A", "Drug B"), 100, replace = TRUE),
  response = rnorm(100, mean = 50, sd = 20) + ifelse(treatment == "Drug A", 15, ifelse(treatment == "Drug B", 10, 0)),
  adverse_event = sample(c("None", "Mild", "Moderate"), 100, replace = TRUE, prob = c(0.6, 0.3, 0.1))
)

# Panel A: ì¹˜ë£Œêµ°ë³„ ë°˜ì‘
p_a <- ggplot(clinical_data, aes(x = treatment, y = response, fill = treatment)) +
  geom_boxplot(alpha = 0.7, outlier.shape = NA) +
  geom_jitter(width = 0.2, alpha = 0.3, size = 1) +
  stat_compare_means(
    comparisons = list(c("Control", "Drug A"), c("Control", "Drug B"), c("Drug A", "Drug B")),
    label = "p.signif",
    method = "t.test"
  ) +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(
    title = "Treatment Response by Group",
    x = "Treatment Group",
    y = "Response Score (0-100)"
  ) +
  theme_classic(base_size = 11) +
  theme(
    legend.position = "none",
    plot.title = element_text(face = "bold", size = 12)
  )

# Panel B: ë‚˜ì´ì™€ ë°˜ì‘ì˜ ê´€ê³„
p_b <- ggplot(clinical_data, aes(x = age, y = response, color = treatment, shape = treatment)) +
  geom_point(size = 2.5, alpha = 0.7) +
  geom_smooth(method = "lm", se = TRUE, linewidth = 0.8) +
  scale_color_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  scale_shape_manual(values = c(16, 17, 15)) +
  labs(
    title = "Age vs. Response",
    x = "Patient Age (years)",
    y = "Response Score",
    color = "Treatment",
    shape = "Treatment"
  ) +
  theme_classic(base_size = 11) +
  theme(
    legend.position = c(0.15, 0.85),
    legend.background = element_rect(fill = "white", color = "black", linewidth = 0.3),
    legend.title = element_text(face = "bold", size = 10),
    plot.title = element_text(face = "bold", size = 12)
  )

# Panel C: ë¶€ì‘ìš© ë°œìƒë¥ 
adverse_summary <- clinical_data %>%
  count(treatment, adverse_event) %>%
  group_by(treatment) %>%
  mutate(prop = n / sum(n) * 100)

p_c <- ggplot(adverse_summary, aes(x = treatment, y = prop, fill = adverse_event)) +
  geom_col(position = "dodge", alpha = 0.8) +
  geom_text(
    aes(label = sprintf("%.0f%%", prop)),
    position = position_dodge(width = 0.9),
    vjust = -0.5,
    size = 3
  ) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Adverse Event Incidence",
    x = "Treatment Group",
    y = "Percentage of Patients (%)",
    fill = "Severity"
  ) +
  theme_classic(base_size = 11) +
  theme(
    legend.position = "top",
    legend.title = element_text(face = "bold", size = 10),
    plot.title = element_text(face = "bold", size = 12)
  )

# Panel D: ë‚˜ì´ ë¶„í¬
p_d <- ggplot(clinical_data, aes(x = age, fill = treatment)) +
  geom_density(alpha = 0.6) +
  scale_fill_viridis_d(option = "plasma", begin = 0.3, end = 0.9) +
  labs(
    title = "Patient Age Distribution",
    x = "Age (years)",
    y = "Density",
    fill = "Treatment"
  ) +
  theme_classic(base_size = 11) +
  theme(
    legend.position = c(0.85, 0.8),
    legend.background = element_rect(fill = "white", color = "black", linewidth = 0.3),
    legend.title = element_text(face = "bold", size = 10),
    plot.title = element_text(face = "bold", size = 12)
  )

# ì¡°í•©
(p_a | p_b) / (p_c | p_d) +
  plot_annotation(
    title = "Phase II Clinical Trial Results: Novel Drug A vs. Drug B vs. Control",
    subtitle = "Multicenter, randomized controlled trial (N=100 patients)",
    caption = "Error bars: 95% CI | Statistical test: Two-sample t-test | *p<0.05, **p<0.01, ***p<0.001",
    tag_levels = "A",
    tag_suffix = ")",
    theme = theme(
      plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
      plot.subtitle = element_text(size = 12, hjust = 0.5, color = "gray40"),
      plot.caption = element_text(size = 9, hjust = 0, color = "gray50")
    )
  ) &
  theme(
    plot.tag = element_text(size = 14, face = "bold"),
    plot.tag.position = c(0.02, 0.98)
  )
```

## 6.9 ìš”ì•½ ë° ì‹¤ì „ ì›Œí¬í”Œë¡œìš°

### 6.9.1 ì¶œíŒìš© ê·¸ë˜í”„ ì œì‘ ì›Œí¬í”Œë¡œìš°

**1ë‹¨ê³„: ë°ì´í„° ì¤€ë¹„ ë° íƒìƒ‰**
```r
library(tidyverse)
data <- read_csv("data.csv")
summary(data)
```

**2ë‹¨ê³„: ê¸°ë³¸ í”Œë¡¯ ìƒì„±**
```r
p <- ggplot(data, aes(x = var1, y = var2)) +
  geom_point()
```

**3ë‹¨ê³„: ì‹œê°ì  ê°œì„ **
```r
p <- p +
  geom_smooth(method = "lm", se = TRUE) +
  scale_color_viridis_d() +  # ìƒ‰ë§¹ ì¹œí™”ì 
  theme_classic(base_size = 12)
```

**4ë‹¨ê³„: í…ìŠ¤íŠ¸ ë° ë¼ë²¨**
```r
p <- p +
  geom_text_repel(aes(label = label)) +  # ê²¹ì¹¨ ë°©ì§€
  labs(
    title = "ëª…í™•í•œ ì œëª©",
    x = "Xì¶• ë ˆì´ë¸” (ë‹¨ìœ„)",
    y = "Yì¶• ë ˆì´ë¸” (ë‹¨ìœ„)",
    caption = "ë°ì´í„° ì¶œì²˜ ë° í†µê³„ ì •ë³´"
  )
```

**5ë‹¨ê³„: ë‹¤ì¤‘ í”Œë¡¯ ì¡°í•© (í•„ìš” ì‹œ)**
```r
library(patchwork)
(p1 | p2) / p3 +
  plot_annotation(tag_levels = "A")
```

**6ë‹¨ê³„: ê³ í•´ìƒë„ ì €ì¥**
```r
ggsave(
  "figure1.pdf",
  width = 8, height = 6,
  dpi = 300, device = cairo_pdf
)
```

**7ë‹¨ê³„: ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸**
- [ ] ëª¨ë“  í•­ëª© ê²€í† 
- [ ] ë™ë£Œ í”¼ë“œë°± ë°›ê¸°
- [ ] í•™ìˆ ì§€ ê·œì • ì¬í™•ì¸

### 6.9.2 í•µì‹¬ íŒ¨í‚¤ì§€ ìš”ì•½

| íŒ¨í‚¤ì§€ | ê¸°ëŠ¥ | í•„ìˆ˜ë„ |
|--------|------|--------|
| **ggplot2** | ê¸°ë³¸ ì‹œê°í™” | â­â­â­â­â­ |
| **ggrepel** | ë¼ë²¨ ê²¹ì¹¨ ë°©ì§€ | â­â­â­â­â­ |
| **patchwork** | ë‹¤ì¤‘ í”Œë¡¯ ì¡°í•© | â­â­â­â­â­ |
| **ggpubr** | í†µê³„ ë¹„êµ ìë™í™” | â­â­â­â­ |
| **viridis** | ìƒ‰ë§¹ ì¹œí™”ì  ìƒ‰ìƒ | â­â­â­â­ |
| **ggthemes** | í•™ìˆ ì§€ ìŠ¤íƒ€ì¼ | â­â­â­ |
| **showtext** | í•œê¸€ í°íŠ¸ ì§€ì› | â­â­â­ |
| **scales** | ì¶• í¬ë§·íŒ… | â­â­â­ |

### 6.9.3 ë‹¤ìŒ ë‹¨ê³„

::: {.callout-important}
## ğŸ“– Chapter 7 ì˜ˆê³ 

**[Chapter 7: ì¸í„°ë™í‹°ë¸Œ ì‹œê°í™”](07-interactive.qmd)**

ì¶œíŒëœ ë…¼ë¬¸ì„ ë„˜ì–´ì„œ, ì›¹ ê¸°ë°˜ ëŒ€ì‹œë³´ë“œì™€ ì¸í„°ë™í‹°ë¸Œ ì‹œê°í™”ë¥¼ ë°°ì›ë‹ˆë‹¤:

- **plotly**: ggplot2ë¥¼ ì¸í„°ë™í‹°ë¸Œí•˜ê²Œ (`ggplotly()`)
- **shiny**: ì‹¤ì‹œê°„ ë°ì´í„° ëŒ€ì‹œë³´ë“œ êµ¬ì¶•
- **DT**: ì¸í„°ë™í‹°ë¸Œ ë°ì´í„° í…Œì´ë¸”
- **ì‹¤ì „ í”„ë¡œì íŠ¸**: COVID-19 ëŒ€ì‹œë³´ë“œ ë§Œë“¤ê¸°

ì›¹ì—ì„œ í´ë¦­í•˜ê³  í™•ëŒ€í•˜ê³  í•„í„°ë§í•  ìˆ˜ ìˆëŠ” ì°¨ì„¸ëŒ€ ì‹œê°í™”ë¥¼ ê²½í—˜í•´ë³´ì„¸ìš”!
:::

::: {.callout-note}
## ğŸ”— ìœ ìš©í•œ ë¦¬ì†ŒìŠ¤

### ì¶œíŒ ê°€ì´ë“œë¼ì¸
- **Nature**: [Figure Preparation Guide](https://www.nature.com/nature/for-authors/final-submission)
- **Science**: [Figure Guidelines](https://www.science.org/content/page/instructions-preparing-initial-manuscript)
- **NEJM**: [Author Center](https://www.nejm.org/author-center/new-manuscripts)

### ìƒ‰ìƒ ë„êµ¬
- **ColorBrewer**: [https://colorbrewer2.org/](https://colorbrewer2.org/)
- **Color Oracle**: [https://colororacle.org/](https://colororacle.org/) (ìƒ‰ë§¹ ì‹œë®¬ë ˆì´í„°)
- **Viz Palette**: [https://projects.susielu.com/viz-palette](https://projects.susielu.com/viz-palette)

### R íŒ¨í‚¤ì§€ ë¬¸ì„œ
- **ggrepel**: [https://ggrepel.slowkow.com/](https://ggrepel.slowkow.com/)
- **patchwork**: [https://patchwork.data-imaginist.com/](https://patchwork.data-imaginist.com/)
- **ggpubr**: [https://rpkgs.datanovia.com/ggpubr/](https://rpkgs.datanovia.com/ggpubr/)

### í•™ìŠµ ìë£Œ
- **R Graphics Cookbook**: [https://r-graphics.org/](https://r-graphics.org/)
- **Data Visualization**: Kieran Healyì˜ ì±… [https://socviz.co/](https://socviz.co/)
:::

---

**ì¶•í•˜í•©ë‹ˆë‹¤!** Chapter 6ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì´ì œ ì¶œíŒ ìˆ˜ì¤€ì˜ ì „ë¬¸ì ì¸ ì‹œê°í™”ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ‰
