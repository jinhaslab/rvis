---
title: "ì„ìƒ í†µê³„ ì‹œê°í™”"
author: "ì—°ì„¸ëŒ€ ì‚°ì—…ë³´ê±´ ì—°êµ¬ì†Œ"
date: today
---

```{r setup, include=FALSE}
# í•œê¸€ í°íŠ¸ ì„¤ì •
library(showtext)
library(sysfonts)
font_add_google("Noto Sans KR", "noto")
showtext_auto()

library(ggplot2)
theme_set(theme_grey(base_family = "noto"))
showtext_opts(dpi = 96)

knitr::opts_chunk$set(
  fig.showtext = TRUE,
  dev = "png",
  dpi = 96
)
```

# ì„ìƒ í†µê³„ ë° ë¶„ì„ ì—­í•™ ì‹œê°í™”

::: {.callout-note}
## ğŸ¯ í•™ìŠµ ëª©í‘œ

ì´ ì±•í„°ë¥¼ ë§ˆì¹˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- Kaplan-Meier ìƒì¡´ ê³¡ì„ ì„ `ggsurvfit` íŒ¨í‚¤ì§€ë¡œ ì œì‘
- Log-rank ê²€ì •ìœ¼ë¡œ ìƒì¡´ ê³¡ì„  ë¹„êµ
- ë©”íƒ€ë¶„ì„ ê²°ê³¼ë¥¼ Forest Plotìœ¼ë¡œ ì‹œê°í™” (`metafor`)
- ROC ê³¡ì„ ìœ¼ë¡œ ì§„ë‹¨ ê²€ì‚¬ ì„±ëŠ¥ í‰ê°€
- Funnel Plotìœ¼ë¡œ ì¶œíŒ í¸í–¥ íƒì§€
- ì‹ ë¢°êµ¬ê°„ê³¼ í‘œì¤€ì˜¤ì°¨ì˜ ì°¨ì´ ì´í•´
:::

::: {.callout-tip}
## ğŸ“š ì´ ì±•í„°ì˜ ì‹¤ìŠµ ë°ì´í„°

ì´ ì±•í„°ì—ì„œëŠ” **R ë‚´ì¥ ë°ì´í„°ì…‹**ê³¼ **ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

### R ë‚´ì¥ ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°

R íŒ¨í‚¤ì§€ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ **ë°˜ë“œì‹œ íŒ¨í‚¤ì§€ë¥¼ ë¨¼ì € ë¶ˆëŸ¬ì™€ì•¼** í•©ë‹ˆë‹¤:

```r
library(tidyverse)
library(survival)    # âš ï¸ ë¨¼ì € íŒ¨í‚¤ì§€ ë¡œë“œ!
library(ggsurvfit)
library(metafor)

# ìƒì¡´ ë¶„ì„: survival íŒ¨í‚¤ì§€ ë‚´ì¥ ë°ì´í„°
data(lung)           # íì•” í™˜ì ìƒì¡´ ë°ì´í„° (N=228)
data(colon)          # ëŒ€ì¥ì•” ìƒì¡´ ë°ì´í„°

# ë©”íƒ€ë¶„ì„: metafor íŒ¨í‚¤ì§€ ë‚´ì¥ ë°ì´í„°
data(dat.bcg)        # BCG ë°±ì‹  íš¨ê³¼ ë©”íƒ€ë¶„ì„ (13ê°œ ì—°êµ¬)

# ì„ìƒì‹œí—˜ ë°ì´í„° (ì‹œë®¬ë ˆì´ì…˜)
clinical <- read_csv(here("data", "processed", "clinical_trial.csv"))
```

### lung ë°ì´í„°ì…‹ ìƒì„¸ ì •ë³´

**ì¶œì²˜:** North Central Cancer Treatment Group
**í™˜ì ìˆ˜:** 228ëª… (ì§„í–‰ì„± íì•” í™˜ì)
**ì£¼ìš” ë³€ìˆ˜:**

| ë³€ìˆ˜ëª…    | ì„¤ëª…                          | íƒ€ì…      |
|-----------|-------------------------------|-----------|
| `time`    | ìƒì¡´ ì‹œê°„ (ì¼)                | numeric   |
| `status`  | ìƒì¡´ ìƒíƒœ (1=ì‚¬ë§, 2=ìƒì¡´)    | numeric   |
| `age`     | ë‚˜ì´ (ì„¸)                     | numeric   |
| `sex`     | ì„±ë³„ (1=ë‚¨ì„±, 2=ì—¬ì„±)         | numeric   |
| `ph.ecog` | ECOG ìˆ˜í–‰ ì ìˆ˜ (0-3)          | numeric   |
| `ph.karno`| Karnofsky ì ìˆ˜ (ì˜ì‚¬ í‰ê°€)    | numeric   |
| `pat.karno`| Karnofsky ì ìˆ˜ (í™˜ì í‰ê°€)   | numeric   |
| `meal.cal`| ì‹ì‚¬ ì¹¼ë¡œë¦¬                   | numeric   |
| `wt.loss` | ìµœê·¼ 6ê°œì›” ì²´ì¤‘ ê°ì†Œ (íŒŒìš´ë“œ) | numeric   |

**ì‚¬ìš© ì˜ˆì‹œ:** Kaplan-Meier ìƒì¡´ ê³¡ì„ , Cox ë¹„ë¡€ìœ„í—˜ ëª¨ë¸

**ì°¸ê³ :** `?lung` ëª…ë ¹ì–´ë¡œ ìì„¸í•œ ì„¤ëª…ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

## 5.1 ìƒì¡´ ë¶„ì„ (Survival Analysis)

### 5.1.1 ìƒì¡´ ë¶„ì„ì´ë€?

**ìƒì¡´ ë¶„ì„(Survival Analysis)**ì€ ì‚¬ê±´(event)ì´ ë°œìƒí•  ë•Œê¹Œì§€ì˜ ì‹œê°„ì„ ë¶„ì„í•˜ëŠ” í†µê³„ ê¸°ë²•ì…ë‹ˆë‹¤.

**ì£¼ìš” ìš©ì–´:**

- **Event (ì‚¬ê±´)**: ê´€ì‹¬ ìˆëŠ” ê²°ê³¼ (ì‚¬ë§, ì¬ë°œ, íšŒë³µ ë“±)
- **Time (ì‹œê°„)**: ì¶”ì  ì‹œì‘ë¶€í„° ì‚¬ê±´ ë°œìƒê¹Œì§€ì˜ ê¸°ê°„
- **Censoring (ì¤‘ë„ì ˆë‹¨)**: ì¶”ì  ì¢…ë£Œ ì‹œì ê¹Œì§€ ì‚¬ê±´ì´ ë°œìƒí•˜ì§€ ì•ŠìŒ
  - ì˜¤ë¥¸ìª½ ì¤‘ë„ì ˆë‹¨ (Right censoring): ì¶”ì  ì¤‘ íƒˆë½, ì—°êµ¬ ì¢…ë£Œ
  - ì™¼ìª½ ì¤‘ë„ì ˆë‹¨ (Left censoring): ì‚¬ê±´ ë°œìƒ ì‹œì ì„ ì •í™•íˆ ëª¨ë¦„

**ì˜ˆì‹œ:**
```
í™˜ì A: ì§„ë‹¨ â†’ 5ë…„ ì¶”ì  â†’ ì‚¬ë§ (event=1, time=5)
í™˜ì B: ì§„ë‹¨ â†’ 3ë…„ ì¶”ì  â†’ íƒˆë½ (event=0, time=3, censored)
í™˜ì C: ì§„ë‹¨ â†’ 10ë…„ ì¶”ì  â†’ ìƒì¡´ (event=0, time=10, censored)
```

::: {.callout-note}
## ğŸ’¡ ì™œ ì¼ë°˜ íšŒê·€ë¶„ì„ì´ ì•ˆ ë˜ë‚˜ìš”?

ì¤‘ë„ì ˆë‹¨(censoring) ë•Œë¬¸ì…ë‹ˆë‹¤!

**ë¬¸ì œ:**
- í™˜ì BëŠ” 3ë…„ í›„ íƒˆë½í–ˆì§€ë§Œ, ì‹¤ì œë¡œëŠ” 5ë…„ì§¸ ì‚¬ë§í–ˆì„ ìˆ˜ ìˆìŒ
- ì´ë¥¼ ë¬´ì‹œí•˜ê³  "3ë…„ ìƒì¡´"ìœ¼ë¡œ ë¶„ì„í•˜ë©´ ê³¼ì†Œì¶”ì •

**í•´ê²°ì±…:**
- ìƒì¡´ ë¶„ì„ì€ ì¤‘ë„ì ˆë‹¨ì„ **ì •ë³´(information)**ë¡œ í™œìš©
- "ìµœì†Œí•œ 3ë…„ì€ ìƒì¡´í–ˆë‹¤"ëŠ” ì •ë³´ë¥¼ ë°˜ì˜
:::

### 5.1.2 Kaplan-Meier ìƒì¡´ ê³¡ì„ 

**Kaplan-Meier ì¶”ì •ëŸ‰**ì€ ìƒì¡´ í™•ë¥ ì„ ì‹œê°„ì— ë”°ë¼ ê³„ì‚°í•©ë‹ˆë‹¤.

```
S(t) = Î  [1 - (ì‚¬ê±´ ë°œìƒ ìˆ˜ / ìœ„í—˜ ì¸êµ¬)]
```

**R ë‚´ì¥ ë°ì´í„°ë¡œ ì‹¤ìŠµ:**

```{r}
#| eval: true
#| echo: true
#| label: fig-km-basic
#| fig-cap: "Kaplan-Meier ìƒì¡´ ê³¡ì„  (íì•” ë°ì´í„°)"

# âš ï¸ ì¤‘ìš”: survival íŒ¨í‚¤ì§€ë¥¼ ë¨¼ì € ë¡œë“œí•´ì•¼ lung ë°ì´í„° ì‚¬ìš© ê°€ëŠ¥!
library(survival)    # 1ë‹¨ê³„: íŒ¨í‚¤ì§€ ë¡œë“œ
library(ggsurvfit)

# 2ë‹¨ê³„: lung ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
data(lung)           # survival íŒ¨í‚¤ì§€ì˜ ë‚´ì¥ ë°ì´í„°

# ë°ì´í„° êµ¬ì¡° í™•ì¸
head(lung, 3)
```

::: {.callout-note}
## ğŸ’¡ lung ë°ì´í„° ì£¼ìš” ë³€ìˆ˜

- **time**: ìƒì¡´ ì‹œê°„ (ì¼ ë‹¨ìœ„)
- **status**: 1 = ì¤‘ë„ì ˆë‹¨(censored), 2 = ì‚¬ë§(event)
  - âš ï¸ ì£¼ì˜: ì¼ë°˜ì ì¸ ì½”ë”©(0/1)ê³¼ ë°˜ëŒ€!
- **sex**: 1 = ë‚¨ì„±, 2 = ì—¬ì„±
- **age**: ë‚˜ì´ (ì„¸)
- **ph.ecog**: ECOG ìˆ˜í–‰ ìƒíƒœ ì ìˆ˜ (0 = ì •ìƒ, 5 = ì‚¬ë§)

**ì˜ˆì‹œ:**
- í™˜ì 1: time=306ì¼, status=2 â†’ 306ì¼ í›„ ì‚¬ë§
- í™˜ì 2: time=455ì¼, status=1 â†’ 455ì¼ê¹Œì§€ ì¶”ì  í›„ ì¤‘ë„ì ˆë‹¨ (ìƒì¡´)

**TIP:** `library(survival)` í›„ì—ëŠ” `data(lung)` ì—†ì´ ë°”ë¡œ `lung`ì„ ì‚¬ìš©í•´ë„ ë©ë‹ˆë‹¤!
```r
library(survival)
head(lung)  # âœ… data(lung) ì—†ì´ë„ ì‘ë™!
```
:::

```{r}
#| eval: true
#| echo: true

# ìƒì¡´ ê°ì²´ ìƒì„±
# Surv(time, status): time=ìƒì¡´ ì‹œê°„(ì¼), status=1(ì‚¬ë§), 0(censored)
surv_obj <- Surv(lung$time, lung$status)

# ì „ì²´ í™˜ìì˜ ìƒì¡´ ê³¡ì„ 
fit_all <- survfit(surv_obj ~ 1, data = lung)

# ê¸°ë³¸ ìƒì¡´ ê³¡ì„ 
ggsurvfit(fit_all, linewidth = 1) +
  labs(title = "ì „ì²´ íì•” í™˜ì ìƒì¡´ ê³¡ì„ ",
       x = "ì‹œê°„ (ì¼)",
       y = "ìƒì¡´ í™•ë¥ ") +
  theme_minimal()
```

### 5.1.3 ê·¸ë£¹ ê°„ ìƒì¡´ ê³¡ì„  ë¹„êµ

```{r}
#| eval: true
#| echo: true
#| label: fig-km-by-sex
#| fig-cap: "ì„±ë³„ì— ë”°ë¥¸ ìƒì¡´ ê³¡ì„  ë¹„êµ"

# ì„±ë³„(sex)ë¡œ êµ¬ë¶„: 1=ë‚¨ì„±, 2=ì—¬ì„±
fit_sex <- survfit2(Surv(time, status) ~ sex, data = lung)

# ggsurvfitë¡œ ì‹œê°í™”
ggsurvfit(fit_sex, linewidth = 1) +
  add_confidence_interval(alpha = 0.2) +  # 95% CI ì¶”ê°€
  labs(title = "íì•” í™˜ì ìƒì¡´ ê³¡ì„  (ì„±ë³„)",
       x = "ì‹œê°„ (ì¼)",
       y = "ìƒì¡´ í™•ë¥ ",
       color = "ì„±ë³„") +
  scale_color_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                     labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  scale_fill_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                    labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  theme_minimal()
```

### 5.1.4 ìœ„í—˜ í…Œì´ë¸” (Risk Table) ì¶”ê°€

```{r}
#| eval: true
#| echo: true
#| label: fig-km-risk-table
#| fig-cap: "ìƒì¡´ ê³¡ì„  + ìœ„í—˜ í…Œì´ë¸”"

ggsurvfit(fit_sex, linewidth = 1) +
  add_confidence_interval(alpha = 0.2) +
  add_risktable(
    risktable_stats = c("n.risk", "cum.event"),  # ìœ„í—˜ ì¸êµ¬, ëˆ„ì  ì‚¬ê±´
    size = 3.5
  ) +
  labs(title = "íì•” í™˜ì ìƒì¡´ ê³¡ì„  (ìœ„í—˜ í…Œì´ë¸” í¬í•¨)",
       x = "ì‹œê°„ (ì¼)",
       y = "ìƒì¡´ í™•ë¥ ") +
  scale_color_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                     labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  scale_fill_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                    labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  scale_ggsurvfit() +  # ì¶• ìŠ¤ì¼€ì¼ ì¡°ì •
  theme_minimal()
```

### 5.1.5 Log-rank ê²€ì •

ë‘ ìƒì¡´ ê³¡ì„ ì´ í†µê³„ì ìœ¼ë¡œ ë‹¤ë¥¸ì§€ ê²€ì •í•©ë‹ˆë‹¤.

**ê°€ì„¤:**
- H0: ë‘ ê·¸ë£¹ì˜ ìƒì¡´ ê³¡ì„ ì´ ë™ì¼í•˜ë‹¤
- H1: ë‘ ê·¸ë£¹ì˜ ìƒì¡´ ê³¡ì„ ì´ ë‹¤ë¥´ë‹¤

```{r}
#| eval: true
#| echo: true

# Log-rank ê²€ì •
survdiff(Surv(time, status) ~ sex, data = lung)
```

**ê²°ê³¼ í•´ì„:**
- **p-value < 0.05**: ë‘ ê·¸ë£¹ì˜ ìƒì¡´ì— ìœ ì˜í•œ ì°¨ì´ê°€ ìˆìŒ
- **p-value â‰¥ 0.05**: ë‘ ê·¸ë£¹ ê°„ ì°¨ì´ê°€ ì—†ìŒ

```{r}
#| eval: true
#| echo: true
#| label: fig-km-pvalue
#| fig-cap: "Log-rank ê²€ì • p-value í‘œì‹œ"

# p-valueë¥¼ ê·¸ë˜í”„ì— ì¶”ê°€
ggsurvfit(fit_sex, linewidth = 1) +
  add_confidence_interval(alpha = 0.2) +
  add_pvalue(location = "annotation", size = 5) +  # p-value ì¶”ê°€
  labs(title = "íì•” í™˜ì ìƒì¡´ ê³¡ì„  (Log-rank p-value í¬í•¨)",
       x = "ì‹œê°„ (ì¼)",
       y = "ìƒì¡´ í™•ë¥ ") +
  scale_color_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                     labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  scale_fill_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                    labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  theme_minimal()
```

### 5.1.6 ì¤‘ì•™ ìƒì¡´ ê¸°ê°„ (Median Survival Time)

ìƒì¡´ í™•ë¥ ì´ 50%ê°€ ë˜ëŠ” ì‹œì ì…ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true

# ì¤‘ì•™ ìƒì¡´ ê¸°ê°„ ì¶”ì¶œ
summary(fit_sex)$table
```

```{r}
#| eval: true
#| echo: true
#| label: fig-km-median
#| fig-cap: "ì¤‘ì•™ ìƒì¡´ ê¸°ê°„ í‘œì‹œ"

ggsurvfit(fit_sex, linewidth = 1) +
  add_confidence_interval(alpha = 0.2) +
  add_quantile(y_value = 0.5, linewidth = 0.8, linetype = "dashed") +  # 50% ë¼ì¸
  labs(title = "íì•” í™˜ì ìƒì¡´ ê³¡ì„  (ì¤‘ì•™ ìƒì¡´ ê¸°ê°„)",
       x = "ì‹œê°„ (ì¼)",
       y = "ìƒì¡´ í™•ë¥ ") +
  scale_color_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                     labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  scale_fill_manual(values = c("1" = "#2196F3", "2" = "#E91E63"),
                    labels = c("1" = "ë‚¨ì„±", "2" = "ì—¬ì„±")) +
  theme_minimal()
```

### 5.1.7 Cox ë¹„ë¡€ìœ„í—˜ ëª¨ë¸ (Cox Proportional Hazards Model)

ë‹¤ë³€ëŸ‰ ë¶„ì„ìœ¼ë¡œ ìœ„í—˜ë¹„(Hazard Ratio)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true

# Cox ëª¨ë¸: ì„±ë³„, ë‚˜ì´, ECOG ìˆ˜í–‰ ìƒíƒœ ë³´ì •
cox_model <- coxph(Surv(time, status) ~ sex + age + ph.ecog, data = lung)

summary(cox_model)
```

**Hazard Ratio (HR) í•´ì„:**
- HR = 1: ìœ„í—˜ ë™ì¼
- HR > 1: ìœ„í—˜ ì¦ê°€ (ë‚˜ìœ ì˜ˆí›„)
- HR < 1: ìœ„í—˜ ê°ì†Œ (ì¢‹ì€ ì˜ˆí›„)

**ì˜ˆì‹œ:**
- `sex` HR = 0.59: ì—¬ì„±ì´ ë‚¨ì„±ë³´ë‹¤ ì‚¬ë§ ìœ„í—˜ 41% ë‚®ìŒ
- `age` HR = 1.02: ë‚˜ì´ 1ì„¸ ì¦ê°€ë§ˆë‹¤ ì‚¬ë§ ìœ„í—˜ 2% ì¦ê°€

## 5.2 ë©”íƒ€ë¶„ì„ (Meta-Analysis)

### 5.2.1 ë©”íƒ€ë¶„ì„ì´ë€?

**ë©”íƒ€ë¶„ì„(Meta-Analysis)**ì€ ì—¬ëŸ¬ ì—°êµ¬ ê²°ê³¼ë¥¼ í†µí•©í•˜ì—¬ í•˜ë‚˜ì˜ ì¶”ì •ê°’ì„ ë„ì¶œí•˜ëŠ” í†µê³„ ê¸°ë²•ì…ë‹ˆë‹¤.

**ëª©ì :**
1. **ê²€ì •ë ¥ ì¦ê°€**: ê°œë³„ ì—°êµ¬ë³´ë‹¤ í° í‘œë³¸ í¬ê¸°
2. **ì •ë°€ë„ í–¥ìƒ**: ë” ì¢ì€ ì‹ ë¢°êµ¬ê°„
3. **ì¼ê´€ì„± í‰ê°€**: ì—°êµ¬ ê°„ ì´ì§ˆì„±(heterogeneity) íƒìƒ‰
4. **ê·¼ê±° ì¢…í•©**: ì˜ì‚¬ê²°ì •ì„ ìœ„í•œ ìµœì„ ì˜ ì¶”ì •

**ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?**
- ì—¬ëŸ¬ RCT ê²°ê³¼ í†µí•©
- ì²´ê³„ì  ë¬¸í—Œê³ ì°° (Systematic Review)
- ì„ìƒ ì§„ë£Œ ê°€ì´ë“œë¼ì¸ ê°œë°œ
- ì •ì±… ì˜ì‚¬ê²°ì •

::: {.callout-note}
## ğŸ’¡ ê³ ì • íš¨ê³¼ vs. ëœë¤ íš¨ê³¼ ëª¨ë¸

**ê³ ì • íš¨ê³¼ ëª¨ë¸ (Fixed-Effect Model)**
- ê°€ì •: ëª¨ë“  ì—°êµ¬ê°€ ë™ì¼í•œ ì°¸ê°’(true effect)ì„ ì¶”ì •
- ì‚¬ìš©: ì—°êµ¬ ê°„ ì´ì§ˆì„±ì´ ë‚®ì„ ë•Œ
- ê°€ì¤‘ì¹˜: í° ì—°êµ¬ì— ë” ë§ì€ weight

**ëœë¤ íš¨ê³¼ ëª¨ë¸ (Random-Effects Model)**
- ê°€ì •: ê° ì—°êµ¬ì˜ ì°¸ê°’ì´ ì •ê·œë¶„í¬ë¥¼ ë”°ë¦„
- ì‚¬ìš©: ì—°êµ¬ ê°„ ì´ì§ˆì„±ì´ ìˆì„ ë•Œ
- ê°€ì¤‘ì¹˜: ì‘ì€ ì—°êµ¬ì—ë„ ë” ë§ì€ weight

**ê¶Œì¥**: ëŒ€ë¶€ë¶„ì˜ ê²½ìš° **ëœë¤ íš¨ê³¼ ëª¨ë¸** ì‚¬ìš©
:::

### 5.2.2 Forest Plot (í¬ë ˆìŠ¤íŠ¸ í”Œë¡¯)

ë©”íƒ€ë¶„ì„ ê²°ê³¼ë¥¼ ì‹œê°í™”í•˜ëŠ” í‘œì¤€ ë°©ë²•ì…ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true
#| label: fig-forest-plot
#| fig-cap: "BCG ë°±ì‹  íš¨ê³¼ ë©”íƒ€ë¶„ì„ Forest Plot"

library(metafor)

# BCG ë°±ì‹  ë©”íƒ€ë¶„ì„ ë°ì´í„°
data(dat.bcg)

# íš¨ê³¼ í¬ê¸° ê³„ì‚° (Risk Ratio)
dat <- escalc(measure = "RR",
              ai = tpos, bi = tneg,  # ì¹˜ë£Œêµ°
              ci = cpos, di = cneg,  # ëŒ€ì¡°êµ°
              data = dat.bcg,
              slab = paste(author, year, sep = ", "))

# ëœë¤ íš¨ê³¼ ëª¨ë¸
res <- rma(yi, vi, data = dat)

# Forest plot
forest(res,
       atransf = exp,  # log RR â†’ RRë¡œ ë³€í™˜
       at = log(c(0.05, 0.25, 1, 4)),
       xlim = c(-16, 6),
       header = "Author(s) and Year",
       xlab = "Risk Ratio (95% CI)",
       mlab = "Random-Effects Model",
       refline = 1)  # RR=1 ê¸°ì¤€ì„ 
```

**Forest Plot ì½ëŠ” ë²•:**

1. **ê° í–‰**: ê°œë³„ ì—°êµ¬ ê²°ê³¼
   - **ì‚¬ê°í˜•**: íš¨ê³¼ í¬ê¸° (í¬ê¸° = ê°€ì¤‘ì¹˜)
   - **ìˆ˜í‰ì„ **: 95% ì‹ ë¢°êµ¬ê°„
2. **ë‹¤ì´ì•„ëª¬ë“œ**: í†µí•© íš¨ê³¼ í¬ê¸°
   - ì¤‘ì‹¬: í†µí•© ì¶”ì •ê°’
   - ë„ˆë¹„: 95% ì‹ ë¢°êµ¬ê°„
3. **ìˆ˜ì§ ì ì„ **: ë¬´íš¨ê³¼ (RR=1 ë˜ëŠ” OR=1)

### 5.2.3 ì´ì§ˆì„± í‰ê°€ (Heterogeneity)

ì—°êµ¬ ê°„ ì°¨ì´ê°€ ì–¼ë§ˆë‚˜ í°ì§€ í‰ê°€í•©ë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true

# ì´ì§ˆì„± í†µê³„ëŸ‰
print(res)
```

**ì£¼ìš” ì§€í‘œ:**

| ì§€í‘œ | ì˜ë¯¸ | í•´ì„ |
|------|------|------|
| **Q í†µê³„ëŸ‰** | ì—°êµ¬ ê°„ ë³€ë™ | p < 0.05: ì´ì§ˆì„± ì¡´ì¬ |
| **IÂ²** | ì „ì²´ ë³€ë™ ì¤‘ ì´ì§ˆì„± ë¹„ìœ¨ | <25%: ë‚®ìŒ, 25-75%: ì¤‘ê°„, >75%: ë†’ìŒ |
| **Ï„Â²** | ì—°êµ¬ ê°„ ë¶„ì‚° | í´ìˆ˜ë¡ ì´ì§ˆì„± í¼ |

**ì˜ˆì‹œ í•´ì„:**
```
IÂ² = 85% â†’ ì „ì²´ ë³€ë™ì˜ 85%ê°€ ì´ì§ˆì„± ë•Œë¬¸
â†’ ì—°êµ¬ ê°„ ì°¨ì´ê°€ í¼ â†’ í•˜ìœ„ê·¸ë£¹ ë¶„ì„ í•„ìš”
```

### 5.2.4 ì¶œíŒ í¸í–¥ (Publication Bias)

**ì¶œíŒ í¸í–¥**: í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•œ ê²°ê³¼ë§Œ ì¶œíŒë˜ì–´ ë©”íƒ€ë¶„ì„ì´ ì™œê³¡ë˜ëŠ” í˜„ìƒ

**íƒì§€ ë°©ë²•: Funnel Plot**

```{r}
#| eval: true
#| echo: true
#| label: fig-funnel-plot
#| fig-cap: "Funnel Plot (ì¶œíŒ í¸í–¥ íƒì§€)"

# Funnel plot
funnel(res,
       xlab = "Log Risk Ratio",
       ylab = "Standard Error",
       main = "Funnel Plot (BCG ë°±ì‹  ë©”íƒ€ë¶„ì„)")
```

**Funnel Plot í•´ì„:**

- **ëŒ€ì¹­**: ì¶œíŒ í¸í–¥ ì—†ìŒ
- **ë¹„ëŒ€ì¹­**: ì¶œíŒ í¸í–¥ ì˜ì‹¬
  - ì‘ì€ ì—°êµ¬ê°€ í•œìª½ìœ¼ë¡œ ì¹˜ìš°ì¹¨
  - ìŒì„± ê²°ê³¼ ì—°êµ¬ê°€ ëˆ„ë½ë˜ì—ˆì„ ê°€ëŠ¥ì„±

**Egger's Test:**

```{r}
#| eval: true
#| echo: true

# Egger's regression test
regtest(res)
```

- **p < 0.05**: ì¶œíŒ í¸í–¥ ì˜ì‹¬
- **p â‰¥ 0.05**: ì¶œíŒ í¸í–¥ ì—†ìŒ

### 5.2.5 ggplot2ë¡œ Forest Plot ì»¤ìŠ¤í„°ë§ˆì´ì§•

metaforì˜ ê¸°ë³¸ forest plotì€ base R ê·¸ë˜í”½ì…ë‹ˆë‹¤. ggplot2ë¡œ ë” ì˜ˆì˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| eval: true
#| echo: true
#| label: fig-ggplot-forest
#| fig-cap: "ggplot2ë¡œ ë§Œë“  Forest Plot"

library(tidyverse)

# ë©”íƒ€ë¶„ì„ ê²°ê³¼ ë°ì´í„°í”„ë ˆì„ ë³€í™˜
forest_data <- tibble(
  study = dat$slab,
  estimate = exp(dat$yi),  # RR
  lower_ci = exp(dat$yi - 1.96 * sqrt(dat$vi)),
  upper_ci = exp(dat$yi + 1.96 * sqrt(dat$vi)),
  weight = weights(res)
)

# í†µí•© ì¶”ì •ê°’ ì¶”ê°€
pooled_estimate <- tibble(
  study = "Pooled (Random-Effects)",
  estimate = exp(res$beta[1]),
  lower_ci = exp(res$ci.lb),
  upper_ci = exp(res$ci.ub),
  weight = 100
)

forest_data <- bind_rows(forest_data, pooled_estimate)

# ggplot2 Forest Plot
ggplot(forest_data, aes(y = reorder(study, estimate), x = estimate,
                        xmin = lower_ci, xmax = upper_ci)) +
  geom_pointrange(aes(size = weight)) +
  geom_vline(xintercept = 1, linetype = "dashed", color = "red") +
  scale_x_log10(breaks = c(0.1, 0.25, 0.5, 1, 2, 4)) +
  labs(title = "BCG ë°±ì‹  íš¨ê³¼ ë©”íƒ€ë¶„ì„",
       subtitle = "Risk Ratio (95% CI)",
       x = "Risk Ratio (log scale)",
       y = "Study") +
  theme_minimal() +
  theme(legend.position = "none")
```

## 5.3 ROC ê³¡ì„  (Receiver Operating Characteristic Curve)

### 5.3.1 ROC ê³¡ì„ ì´ë€?

**ROC ê³¡ì„ **ì€ ì§„ë‹¨ ê²€ì‚¬ì˜ ì„±ëŠ¥ì„ í‰ê°€í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.

**ì£¼ìš” ê°œë…:**

| ìš©ì–´ | ì •ì˜ | ì˜ˆì‹œ |
|------|------|------|
| **True Positive (TP)** | ì§ˆë³‘ O, ê²€ì‚¬ ì–‘ì„± | ì•” í™˜ìë¥¼ ì–‘ì„±ìœ¼ë¡œ ì§„ë‹¨ |
| **False Positive (FP)** | ì§ˆë³‘ X, ê²€ì‚¬ ì–‘ì„± | ì •ìƒì¸ì„ ì–‘ì„±ìœ¼ë¡œ ì˜¤ì§„ |
| **True Negative (TN)** | ì§ˆë³‘ X, ê²€ì‚¬ ìŒì„± | ì •ìƒì¸ì„ ìŒì„±ìœ¼ë¡œ ì§„ë‹¨ |
| **False Negative (FN)** | ì§ˆë³‘ O, ê²€ì‚¬ ìŒì„± | ì•” í™˜ìë¥¼ ìŒì„±ìœ¼ë¡œ ì˜¤ì§„ |

**ì„±ëŠ¥ ì§€í‘œ:**
```
ë¯¼ê°ë„ (Sensitivity) = TP / (TP + FN)  # ì‹¤ì œ ì–‘ì„± ì¤‘ ì–‘ì„±ìœ¼ë¡œ ì§„ë‹¨
íŠ¹ì´ë„ (Specificity) = TN / (TN + FP)  # ì‹¤ì œ ìŒì„± ì¤‘ ìŒì„±ìœ¼ë¡œ ì§„ë‹¨
```

**ROC ê³¡ì„ :**
- xì¶•: 1 - íŠ¹ì´ë„ (False Positive Rate)
- yì¶•: ë¯¼ê°ë„ (True Positive Rate)
- ëª¨ë“  ì„ê³„ê°’(threshold)ì—ì„œì˜ ì„±ëŠ¥ì„ ì‹œê°í™”

### 5.3.2 AUC (Area Under the Curve)

**AUC**: ROC ê³¡ì„  ì•„ë˜ ë©´ì 

| AUC ê°’ | í•´ì„ |
|--------|------|
| 1.0 | ì™„ë²½í•œ ì§„ë‹¨ |
| 0.9 - 1.0 | ìš°ìˆ˜ (Excellent) |
| 0.8 - 0.9 | ì¢‹ìŒ (Good) |
| 0.7 - 0.8 | ë³´í†µ (Fair) |
| 0.5 - 0.7 | ë‚˜ì¨ (Poor) |
| 0.5 | ë¬´ì‘ìœ„ ì¶”ì¸¡ |

### 5.3.3 ROC ê³¡ì„  ê·¸ë¦¬ê¸°

```{r}
#| eval: true
#| echo: true
#| label: fig-roc-curve
#| fig-cap: "ROC ê³¡ì„  (ì§„ë‹¨ ê²€ì‚¬ ì„±ëŠ¥ í‰ê°€)"

library(pROC)
library(tidyverse)

# ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„° ìƒì„±
set.seed(123)
n <- 200
disease_status <- rbinom(n, 1, 0.3)  # 30% ìœ ë³‘ë¥ 
test_score <- ifelse(disease_status == 1,
                     rnorm(n, mean = 70, sd = 15),  # í™˜ìêµ°
                     rnorm(n, mean = 50, sd = 15))  # ì •ìƒêµ°

# ROC ê°ì²´ ìƒì„±
roc_obj <- roc(disease_status, test_score)

# ROC ê³¡ì„ 
ggroc(roc_obj, linewidth = 1.5) +
  geom_abline(intercept = 1, slope = 1,
              linetype = "dashed", color = "gray") +  # ë¬´ì‘ìœ„ ì¶”ì¸¡ì„ 
  annotate("text", x = 0.3, y = 0.3,
           label = paste0("AUC = ", round(auc(roc_obj), 3)),
           size = 5, color = "darkblue") +
  labs(title = "ROC ê³¡ì„  (ì§„ë‹¨ ê²€ì‚¬ ì„±ëŠ¥)",
       x = "1 - íŠ¹ì´ë„ (False Positive Rate)",
       y = "ë¯¼ê°ë„ (True Positive Rate)") +
  theme_minimal()
```

### 5.3.4 ìµœì  ì„ê³„ê°’ ì°¾ê¸°

```{r}
#| eval: true
#| echo: true

# Youden Indexë¡œ ìµœì  ì„ê³„ê°’ ì°¾ê¸°
best_coords <- coords(roc_obj, "best", ret = c("threshold", "sensitivity", "specificity"),
                      best.method = "youden")

cat("ìµœì  ì„ê³„ê°’:", best_coords$threshold, "\n")
cat("ë¯¼ê°ë„:", round(best_coords$sensitivity, 3), "\n")
cat("íŠ¹ì´ë„:", round(best_coords$specificity, 3), "\n")
```

## 5.4 ì‹ ë¢°êµ¬ê°„ vs. í‘œì¤€ì˜¤ì°¨

### 5.4.1 ì°¨ì´ì  ì´í•´í•˜ê¸°

| í†µê³„ëŸ‰ | ì˜ë¯¸ | í•´ì„ | ì‹œê°í™” ìš©ë„ |
|--------|------|------|-------------|
| **SE (Standard Error)** | í‰ê· ì˜ ì •ë°€ë„ | í‘œë³¸ í‰ê· ì´ ëª¨í‰ê· ê³¼ ì–¼ë§ˆë‚˜ ê°€ê¹Œìš´ì§€ | í‰ê· ì˜ ë¶ˆí™•ì‹¤ì„± |
| **95% CI** | ëª¨í‰ê· ì— ëŒ€í•œ ì‹ ë¢° | 95% í™•ë¥ ë¡œ ëª¨í‰ê· ì´ ì´ êµ¬ê°„ì— í¬í•¨ | í†µê³„ì  ìœ ì˜ì„± ê²€ì • |
| **SD (Standard Deviation)** | ë°ì´í„°ì˜ ì‚°í¬ | ê°œë³„ ê´€ì¸¡ê°’ì´ í‰ê· ì—ì„œ ì–¼ë§ˆë‚˜ í¼ì ¸ìˆëŠ”ì§€ | ë°ì´í„° ë¶„í¬ |

::: {.callout-warning}
## âš ï¸ í”í•œ ì‹¤ìˆ˜

**ë¬¸ì œ**: SEë¥¼ CIë¡œ ì°©ê°í•˜ê±°ë‚˜ SDë¥¼ SEë¡œ í˜¼ë™

**ì˜¬ë°”ë¥¸ ì‚¬ìš©:**
- **ë°ì´í„° ë¶„í¬ í‘œí˜„**: SD ì‚¬ìš©
- **í‰ê·  ë¹„êµ**: 95% CI ì‚¬ìš©
- **í‰ê· ì˜ ì •ë°€ë„**: SE ì‚¬ìš©

**ì„ìƒì‹œí—˜/ë©”íƒ€ë¶„ì„**: ê±°ì˜ í•­ìƒ **95% CI** ì‚¬ìš©!
:::

### 5.4.2 ì‹œê°ì  ë¹„êµ

```{r}
#| eval: true
#| echo: true
#| label: fig-se-vs-ci
#| fig-cap: "SE vs CI vs SD ë¹„êµ"

library(tidyverse)

# ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°
set.seed(456)
treatment_data <- tibble(
  group = rep(c("A", "B", "C"), each = 30),
  value = c(rnorm(30, 70, 15),
            rnorm(30, 80, 15),
            rnorm(30, 75, 15))
)

# ìš”ì•½ í†µê³„
summary_stats <- treatment_data %>%
  group_by(group) %>%
  summarize(
    n = n(),
    mean = mean(value),
    sd = sd(value),
    se = sd / sqrt(n),
    ci_lower = mean - 1.96 * se,
    ci_upper = mean + 1.96 * se
  )

# ì‹œê°í™”
p1 <- ggplot(summary_stats, aes(x = group, y = mean)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.2) +
  labs(title = "í‰ê·  Â± SE", y = "ê°’") +
  theme_minimal()

p2 <- ggplot(summary_stats, aes(x = group, y = mean)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
  labs(title = "í‰ê·  Â± 95% CI", y = "ê°’") +
  theme_minimal()

p3 <- ggplot(summary_stats, aes(x = group, y = mean)) +
  geom_point(size = 3) +
  geom_errorbar(aes(ymin = mean - sd, ymax = mean + sd), width = 0.2) +
  labs(title = "í‰ê·  Â± SD", y = "ê°’") +
  theme_minimal()

library(patchwork)
p1 + p2 + p3 +
  plot_annotation(title = "SE vs CI vs SD ë¹„êµ")
```

**ê´€ì°°:**
- **SE**: ê°€ì¥ ì¢ìŒ (í‰ê· ì˜ ì •ë°€ë„)
- **95% CI**: SEì˜ 1.96ë°°
- **SD**: ê°€ì¥ ë„“ìŒ (ë°ì´í„° ë¶„í¬)

## 5.5 ì‹¤ì „ ì—°ìŠµë¬¸ì œ

::: {.callout-tip icon="false"}
## âœï¸ Exercise 5.1: ìƒì¡´ ê³¡ì„  ê·¸ë¦¬ê¸°

`survival::colon` ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬:

1. ì¹˜ë£Œêµ°(`rx`)ë³„ ìƒì¡´ ê³¡ì„  ê·¸ë¦¬ê¸°
2. 95% ì‹ ë¢°êµ¬ê°„ ì¶”ê°€
3. ìœ„í—˜ í…Œì´ë¸” í¬í•¨
4. Log-rank ê²€ì • p-value í‘œì‹œ

**íŒíŠ¸**: `rx` ë³€ìˆ˜ëŠ” ì¹˜ë£Œë²• (Obs, Lev, Lev+5FU)

```{r}
#| eval: false
#| code-fold: true
#| code-summary: "ğŸ’¡ ì •ë‹µ ë³´ê¸°"

library(survival)
library(ggsurvfit)

data(colon)

# ìƒì¡´ ë°ì´í„°ë§Œ (event=1: ì‚¬ë§, etype=2: ì¬ë°œ ì œì™¸)
colon_death <- colon %>%
  filter(etype == 2)  # death

fit_rx <- survfit2(Surv(time, status) ~ rx, data = colon_death)

ggsurvfit(fit_rx, linewidth = 1) +
  add_confidence_interval(alpha = 0.2) +
  add_risktable() +
  add_pvalue(location = "annotation") +
  labs(title = "ëŒ€ì¥ì•” ìƒì¡´ ê³¡ì„  (ì¹˜ë£Œë²•ë³„)",
       x = "ì‹œê°„ (ì¼)",
       y = "ìƒì¡´ í™•ë¥ ",
       color = "ì¹˜ë£Œë²•") +
  scale_ggsurvfit() +
  theme_minimal()
```
:::

::: {.callout-tip icon="false"}
## âœï¸ Exercise 5.2: Forest Plot ë§Œë“¤ê¸°

ë‹¤ìŒ ë©”íƒ€ë¶„ì„ ê²°ê³¼ë¥¼ Forest Plotìœ¼ë¡œ ì‹œê°í™”í•˜ì„¸ìš”:

```r
meta_data <- tribble(
  ~study, ~or, ~lower_ci, ~upper_ci,
  "Study 1", 0.8, 0.6, 1.0,
  "Study 2", 0.7, 0.5, 0.9,
  "Study 3", 0.9, 0.7, 1.1,
  "Study 4", 0.6, 0.4, 0.8,
  "Pooled", 0.75, 0.65, 0.85
)
```

**ìš”êµ¬ì‚¬í•­:**
- ggplot2 ì‚¬ìš©
- OR=1 ê¸°ì¤€ì„  í‘œì‹œ
- í†µí•© ì¶”ì •ê°’ì€ ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ

```{r}
#| eval: false
#| code-fold: true
#| code-summary: "ğŸ’¡ ì •ë‹µ ë³´ê¸°"

library(tidyverse)

meta_data <- tribble(
  ~study, ~or, ~lower_ci, ~upper_ci,
  "Study 1", 0.8, 0.6, 1.0,
  "Study 2", 0.7, 0.5, 0.9,
  "Study 3", 0.9, 0.7, 1.1,
  "Study 4", 0.6, 0.4, 0.8,
  "Pooled", 0.75, 0.65, 0.85
) %>%
  mutate(type = if_else(study == "Pooled", "Pooled", "Individual"))

ggplot(meta_data, aes(y = reorder(study, or), x = or,
                      xmin = lower_ci, xmax = upper_ci,
                      color = type)) +
  geom_pointrange(size = 0.8) +
  geom_vline(xintercept = 1, linetype = "dashed", color = "red") +
  scale_color_manual(values = c("Individual" = "darkblue", "Pooled" = "red")) +
  labs(title = "ë©”íƒ€ë¶„ì„ Forest Plot",
       x = "Odds Ratio (95% CI)",
       y = "Study") +
  theme_minimal() +
  theme(legend.position = "none")
```
:::

::: {.callout-tip icon="false"}
## âœï¸ Exercise 5.3: ROC ê³¡ì„  ë¹„êµ (ë„ì „!)

ë‘ ê°€ì§€ ì§„ë‹¨ ê²€ì‚¬ì˜ ROC ê³¡ì„ ì„ í•˜ë‚˜ì˜ ê·¸ë˜í”„ì— ê·¸ë¦¬ê³  AUCë¥¼ ë¹„êµí•˜ì„¸ìš”.

```r
# ì‹œë®¬ë ˆì´ì…˜ ë°ì´í„°
set.seed(789)
n <- 150
disease <- rbinom(n, 1, 0.4)
test1 <- ifelse(disease == 1, rnorm(n, 75, 12), rnorm(n, 50, 12))
test2 <- ifelse(disease == 1, rnorm(n, 80, 15), rnorm(n, 55, 15))
```

**ìš”êµ¬ì‚¬í•­:**
- ë‘ ROC ê³¡ì„ ì„ ë‹¤ë¥¸ ìƒ‰ìœ¼ë¡œ
- ê° AUC ê°’ì„ ë²”ë¡€ì— í‘œì‹œ

```{r}
#| eval: false
#| code-fold: true
#| code-summary: "ğŸ’¡ ì •ë‹µ ë³´ê¸°"

library(pROC)
library(tidyverse)

set.seed(789)
n <- 150
disease <- rbinom(n, 1, 0.4)
test1 <- ifelse(disease == 1, rnorm(n, 75, 12), rnorm(n, 50, 12))
test2 <- ifelse(disease == 1, rnorm(n, 80, 15), rnorm(n, 55, 15))

roc1 <- roc(disease, test1)
roc2 <- roc(disease, test2)

# ggplotìœ¼ë¡œ ë‘ ROC ê³¡ì„ 
ggroc(list(Test1 = roc1, Test2 = roc2), linewidth = 1.5) +
  geom_abline(intercept = 1, slope = 1, linetype = "dashed", color = "gray") +
  labs(title = "ROC ê³¡ì„  ë¹„êµ",
       subtitle = paste0("AUC: Test1=", round(auc(roc1), 3),
                         ", Test2=", round(auc(roc2), 3)),
       x = "1 - íŠ¹ì´ë„",
       y = "ë¯¼ê°ë„",
       color = "ê²€ì‚¬") +
  theme_minimal()
```
:::

## 5.6 ìš”ì•½ ë° ë‹¤ìŒ ë‹¨ê³„

### 5.6.1 ì´ ì±•í„°ì—ì„œ ë°°ìš´ ë‚´ìš©

âœ… **ìƒì¡´ ë¶„ì„**
- Kaplan-Meier ìƒì¡´ ê³¡ì„ 
- ìœ„í—˜ í…Œì´ë¸” (Risk Table)
- Log-rank ê²€ì •
- ì¤‘ì•™ ìƒì¡´ ê¸°ê°„
- Cox ë¹„ë¡€ìœ„í—˜ ëª¨ë¸

âœ… **ë©”íƒ€ë¶„ì„**
- ê³ ì • íš¨ê³¼ vs. ëœë¤ íš¨ê³¼
- Forest Plot ì‹œê°í™”
- ì´ì§ˆì„± í‰ê°€ (IÂ², Ï„Â²)
- Funnel Plot (ì¶œíŒ í¸í–¥)
- ggplot2 ì»¤ìŠ¤í„°ë§ˆì´ì§•

âœ… **ROC ê³¡ì„ **
- ë¯¼ê°ë„ vs. íŠ¹ì´ë„
- AUC í•´ì„
- ìµœì  ì„ê³„ê°’

âœ… **í†µê³„ ì§€í‘œ**
- SE vs. CI vs. SD ì°¨ì´
- ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²•

### 5.6.2 í•µì‹¬ ì½”ë“œ í…œí”Œë¦¿

**ìƒì¡´ ê³¡ì„ :**
```r
fit <- survfit2(Surv(time, status) ~ group, data)
ggsurvfit(fit) +
  add_confidence_interval() +
  add_risktable() +
  add_pvalue()
```

**Forest Plot:**
```r
res <- rma(yi, vi, data)
forest(res, atransf = exp, xlab = "Odds Ratio")
```

**ROC ê³¡ì„ :**
```r
roc_obj <- roc(disease, test_score)
ggroc(roc_obj) +
  annotate("text", label = paste0("AUC = ", round(auc(roc_obj), 3)))
```

::: {.callout-important}
## ğŸ“– ë‹¤ìŒ ì±•í„°

**[Chapter 6: ì¶œíŒ í’ˆì§ˆ ê·¸ë˜í”„ ì œì‘](06-publication.qmd)**

Chapter 6ì—ì„œëŠ” í•™ìˆ ì§€ ì¶œíŒì„ ìœ„í•œ ì „ë¬¸ì ì¸ ê·¸ë˜í”„ ì œì‘ ê¸°ë²•ì„ ë°°ì›ë‹ˆë‹¤:

1. **ë‹¤ì¤‘ ê·¸ë˜í”„ ì¡°í•©**: patchwork íŒ¨í‚¤ì§€
2. **ìƒ‰ìƒ ì„ íƒ**: ìƒ‰ë§¹ ì¹œí™”ì  íŒ”ë ˆíŠ¸
3. **í°íŠ¸ ë° í•´ìƒë„**: ì¶œíŒ í‘œì¤€ (300 dpi)
4. **í…Œë§ˆ ì»¤ìŠ¤í„°ë§ˆì´ì§•**: theme() ì™„ì „ ì •ë³µ
5. **ì €ì¥ ë° ë‚´ë³´ë‚´ê¸°**: ggsave() ìµœì  ì„¤ì •

Nature, Science, NEJM ìˆ˜ì¤€ì˜ ê·¸ë˜í”„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
:::

::: {.callout-note}
## ğŸ”— ì¶”ê°€ í•™ìŠµ ìë£Œ

### ìƒì¡´ ë¶„ì„
- **ggsurvfit**: [ê³µì‹ ë¬¸ì„œ](https://www.danieldsjoberg.com/ggsurvfit/)
- **survival**: [CRAN](https://cran.r-project.org/web/packages/survival/)
- **survminer**: [ëŒ€ì•ˆ íŒ¨í‚¤ì§€](https://rpkgs.datanovia.com/survminer/)

### ë©”íƒ€ë¶„ì„
- **metafor**: [ê³µì‹ ë¬¸ì„œ](https://www.metafor-project.org/)
- **Cochrane Handbook**: [ë©”íƒ€ë¶„ì„ ê°€ì´ë“œ](https://training.cochrane.org/handbook)
- **meta**: [ëŒ€ì•ˆ íŒ¨í‚¤ì§€](https://cran.r-project.org/web/packages/meta/)

### ROC ê³¡ì„ 
- **pROC**: [ê³µì‹ ë¬¸ì„œ](https://web.expasy.org/pROC/)
- **ROCR**: [ëŒ€ì•ˆ íŒ¨í‚¤ì§€](https://cran.r-project.org/web/packages/ROCR/)

### ì„ìƒí†µê³„ ì „ë°˜
- **Clinical Trials**: [ClinicalTrials.gov](https://clinicaltrials.gov/)
- **CONSORT**: [RCT ë³´ê³  ì§€ì¹¨](http://www.consort-statement.org/)
:::
